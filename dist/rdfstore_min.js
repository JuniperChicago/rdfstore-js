!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.rdfstore=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'");}var f=n[o]={exports:{}};
t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){},{}],2:[function(_dereq_,module,exports){var base64=_dereq_("base64-js");var ieee754=_dereq_("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=Buffer;exports.INSPECT_MAX_BYTES=50;Buffer.poolSize=8192;Buffer._useTypedArrays=function(){try{var buf=new ArrayBuffer(0);
var arr=new Uint8Array(buf);arr.foo=function(){return 42};return 42===arr.foo()&&typeof arr.subarray==="function"}catch(e){return false}}();function Buffer(subject,encoding,noZero){if(!(this instanceof Buffer))return new Buffer(subject,encoding,noZero);var type=typeof subject;if(encoding==="base64"&&type==="string"){subject=stringtrim(subject);while(subject.length%4!==0)subject=subject+"="}var length;if(type==="number")length=coerce(subject);else if(type==="string")length=Buffer.byteLength(subject,
encoding);else if(type==="object")length=coerce(subject.length);else throw new Error("First argument needs to be a number, array or string.");var buf;if(Buffer._useTypedArrays)buf=Buffer._augment(new Uint8Array(length));else{buf=this;buf.length=length;buf._isBuffer=true}var i;if(Buffer._useTypedArrays&&typeof subject.byteLength==="number")buf._set(subject);else if(isArrayish(subject))for(i=0;i<length;i++)if(Buffer.isBuffer(subject))buf[i]=subject.readUInt8(i);else buf[i]=subject[i];else if(type===
"string")buf.write(subject,0,encoding);else if(type==="number"&&!Buffer._useTypedArrays&&!noZero)for(i=0;i<length;i++)buf[i]=0;return buf}Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "raw":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return true;default:return false}};Buffer.isBuffer=function(b){return!!(b!==null&&b!==undefined&&b._isBuffer)};Buffer.byteLength=function(str,encoding){var ret;
str=str+"";switch(encoding||"utf8"){case "hex":ret=str.length/2;break;case "utf8":case "utf-8":ret=utf8ToBytes(str).length;break;case "ascii":case "binary":case "raw":ret=str.length;break;case "base64":ret=base64ToBytes(str).length;break;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ret=str.length*2;break;default:throw new Error("Unknown encoding");}return ret};Buffer.concat=function(list,totalLength){assert(isArray(list),"Usage: Buffer.concat(list, [totalLength])\n"+"list should be an Array.");
if(list.length===0)return new Buffer(0);else if(list.length===1)return list[0];var i;if(typeof totalLength!=="number"){totalLength=0;for(i=0;i<list.length;i++)totalLength+=list[i].length}var buf=new Buffer(totalLength);var pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos);pos+=item.length}return buf};function _hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length)length=remaining;else{length=Number(length);if(length>remaining)length=
remaining}var strLen=string.length;assert(strLen%2===0,"Invalid hex string");if(length>strLen/2)length=strLen/2;for(var i=0;i<length;i++){var byte=parseInt(string.substr(i*2,2),16);assert(!isNaN(byte),"Invalid hex string");buf[offset+i]=byte}Buffer._charsWritten=i*2;return i}function _utf8Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf8ToBytes(string),buf,offset,length);return charsWritten}function _asciiWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=
blitBuffer(asciiToBytes(string),buf,offset,length);return charsWritten}function _binaryWrite(buf,string,offset,length){return _asciiWrite(buf,string,offset,length)}function _base64Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(base64ToBytes(string),buf,offset,length);return charsWritten}function _utf16leWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf16leToBytes(string),buf,offset,length);return charsWritten}Buffer.prototype.write=
function(string,offset,length,encoding){if(isFinite(offset)){if(!isFinite(length)){encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length;length=swap}offset=Number(offset)||0;var remaining=this.length-offset;if(!length)length=remaining;else{length=Number(length);if(length>remaining)length=remaining}encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case "hex":ret=_hexWrite(this,string,offset,length);break;case "utf8":case "utf-8":ret=_utf8Write(this,
string,offset,length);break;case "ascii":ret=_asciiWrite(this,string,offset,length);break;case "binary":ret=_binaryWrite(this,string,offset,length);break;case "base64":ret=_base64Write(this,string,offset,length);break;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ret=_utf16leWrite(this,string,offset,length);break;default:throw new Error("Unknown encoding");}return ret};Buffer.prototype.toString=function(encoding,start,end){var self=this;encoding=String(encoding||"utf8").toLowerCase();start=
Number(start)||0;end=end!==undefined?Number(end):end=self.length;if(end===start)return"";var ret;switch(encoding){case "hex":ret=_hexSlice(self,start,end);break;case "utf8":case "utf-8":ret=_utf8Slice(self,start,end);break;case "ascii":ret=_asciiSlice(self,start,end);break;case "binary":ret=_binarySlice(self,start,end);break;case "base64":ret=_base64Slice(self,start,end);break;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ret=_utf16leSlice(self,start,end);break;default:throw new Error("Unknown encoding");
}return ret};Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};Buffer.prototype.copy=function(target,target_start,start,end){var source=this;if(!start)start=0;if(!end&&end!==0)end=this.length;if(!target_start)target_start=0;if(end===start)return;if(target.length===0||source.length===0)return;assert(end>=start,"sourceEnd < sourceStart");assert(target_start>=0&&target_start<target.length,"targetStart out of bounds");assert(start>=0&&start<source.length,
"sourceStart out of bounds");assert(end>=0&&end<=source.length,"sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-target_start<end-start)end=target.length-target_start+start;var len=end-start;if(len<100||!Buffer._useTypedArrays)for(var i=0;i<len;i++)target[i+target_start]=this[i+start];else target._set(this.subarray(start,start+len),target_start)};function _base64Slice(buf,start,end){if(start===0&&end===buf.length)return base64.fromByteArray(buf);else return base64.fromByteArray(buf.slice(start,
end))}function _utf8Slice(buf,start,end){var res="";var tmp="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)if(buf[i]<=127){res+=decodeUtf8Char(tmp)+String.fromCharCode(buf[i]);tmp=""}else tmp+="%"+buf[i].toString(16);return res+decodeUtf8Char(tmp)}function _asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)ret+=String.fromCharCode(buf[i]);return ret}function _binarySlice(buf,start,end){return _asciiSlice(buf,start,end)}function _hexSlice(buf,start,
end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;i++)out+=toHex(buf[i]);return out}function _utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+bytes[i+1]*256);return res}Buffer.prototype.slice=function(start,end){var len=this.length;start=clamp(start,len,0);end=clamp(end,len,len);if(Buffer._useTypedArrays)return Buffer._augment(this.subarray(start,
end));else{var sliceLen=end-start;var newBuf=new Buffer(sliceLen,undefined,true);for(var i=0;i<sliceLen;i++)newBuf[i]=this[i+start];return newBuf}};Buffer.prototype.get=function(offset){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(offset)};Buffer.prototype.set=function(v,offset){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(v,offset)};Buffer.prototype.readUInt8=function(offset,noAssert){if(!noAssert){assert(offset!==
undefined&&offset!==null,"missing offset");assert(offset<this.length,"Trying to read beyond buffer length")}if(offset>=this.length)return;return this[offset]};function _readUInt16(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val;if(littleEndian){val=buf[offset];
if(offset+1<len)val|=buf[offset+1]<<8}else{val=buf[offset]<<8;if(offset+1<len)val|=buf[offset+1]}return val}Buffer.prototype.readUInt16LE=function(offset,noAssert){return _readUInt16(this,offset,true,noAssert)};Buffer.prototype.readUInt16BE=function(offset,noAssert){return _readUInt16(this,offset,false,noAssert)};function _readUInt32(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");
assert(offset+3<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val;if(littleEndian){if(offset+2<len)val=buf[offset+2]<<16;if(offset+1<len)val|=buf[offset+1]<<8;val|=buf[offset];if(offset+3<len)val=val+(buf[offset+3]<<24>>>0)}else{if(offset+1<len)val=buf[offset+1]<<16;if(offset+2<len)val|=buf[offset+2]<<8;if(offset+3<len)val|=buf[offset+3];val=val+(buf[offset]<<24>>>0)}return val}Buffer.prototype.readUInt32LE=function(offset,noAssert){return _readUInt32(this,
offset,true,noAssert)};Buffer.prototype.readUInt32BE=function(offset,noAssert){return _readUInt32(this,offset,false,noAssert)};Buffer.prototype.readInt8=function(offset,noAssert){if(!noAssert){assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"Trying to read beyond buffer length")}if(offset>=this.length)return;var neg=this[offset]&128;if(neg)return(255-this[offset]+1)*-1;else return this[offset]};function _readInt16(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian===
"boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val=_readUInt16(buf,offset,littleEndian,true);var neg=val&32768;if(neg)return(65535-val+1)*-1;else return val}Buffer.prototype.readInt16LE=function(offset,noAssert){return _readInt16(this,offset,true,noAssert)};Buffer.prototype.readInt16BE=function(offset,noAssert){return _readInt16(this,offset,
false,noAssert)};function _readInt32(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val=_readUInt32(buf,offset,littleEndian,true);var neg=val&2147483648;if(neg)return(4294967295-val+1)*-1;else return val}Buffer.prototype.readInt32LE=function(offset,noAssert){return _readInt32(this,
offset,true,noAssert)};Buffer.prototype.readInt32BE=function(offset,noAssert){return _readInt32(this,offset,false,noAssert)};function _readFloat(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset+3<buf.length,"Trying to read beyond buffer length")}return ieee754.read(buf,offset,littleEndian,23,4)}Buffer.prototype.readFloatLE=function(offset,noAssert){return _readFloat(this,offset,true,noAssert)};Buffer.prototype.readFloatBE=
function(offset,noAssert){return _readFloat(this,offset,false,noAssert)};function _readDouble(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset+7<buf.length,"Trying to read beyond buffer length")}return ieee754.read(buf,offset,littleEndian,52,8)}Buffer.prototype.readDoubleLE=function(offset,noAssert){return _readDouble(this,offset,true,noAssert)};Buffer.prototype.readDoubleBE=function(offset,noAssert){return _readDouble(this,
offset,false,noAssert)};Buffer.prototype.writeUInt8=function(value,offset,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"trying to write beyond buffer length");verifuint(value,255)}if(offset>=this.length)return;this[offset]=value};function _writeUInt16(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian===
"boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"trying to write beyond buffer length");verifuint(value,65535)}var len=buf.length;if(offset>=len)return;for(var i=0,j=Math.min(len-offset,2);i<j;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>(littleEndian?i:1-i)*8}Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){_writeUInt16(this,value,offset,true,noAssert)};Buffer.prototype.writeUInt16BE=function(value,
offset,noAssert){_writeUInt16(this,value,offset,false,noAssert)};function _writeUInt32(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"trying to write beyond buffer length");verifuint(value,4294967295)}var len=buf.length;if(offset>=len)return;for(var i=0,j=Math.min(len-offset,4);i<j;i++)buf[offset+
i]=value>>>(littleEndian?i:3-i)*8&255}Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){_writeUInt32(this,value,offset,true,noAssert)};Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){_writeUInt32(this,value,offset,false,noAssert)};Buffer.prototype.writeInt8=function(value,offset,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"Trying to write beyond buffer length");
verifsint(value,127,-128)}if(offset>=this.length)return;if(value>=0)this.writeUInt8(value,offset,noAssert);else this.writeUInt8(255+value+1,offset,noAssert)};function _writeInt16(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"Trying to write beyond buffer length");verifsint(value,32767,
-32768)}var len=buf.length;if(offset>=len)return;if(value>=0)_writeUInt16(buf,value,offset,littleEndian,noAssert);else _writeUInt16(buf,65535+value+1,offset,littleEndian,noAssert)}Buffer.prototype.writeInt16LE=function(value,offset,noAssert){_writeInt16(this,value,offset,true,noAssert)};Buffer.prototype.writeInt16BE=function(value,offset,noAssert){_writeInt16(this,value,offset,false,noAssert)};function _writeInt32(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==
null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to write beyond buffer length");verifsint(value,2147483647,-2147483648)}var len=buf.length;if(offset>=len)return;if(value>=0)_writeUInt32(buf,value,offset,littleEndian,noAssert);else _writeUInt32(buf,4294967295+value+1,offset,littleEndian,noAssert)}Buffer.prototype.writeInt32LE=function(value,offset,noAssert){_writeInt32(this,
value,offset,true,noAssert)};Buffer.prototype.writeInt32BE=function(value,offset,noAssert){_writeInt32(this,value,offset,false,noAssert)};function _writeFloat(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to write beyond buffer length");verifIEEE754(value,3.4028234663852886E38,
-3.4028234663852886E38)}var len=buf.length;if(offset>=len)return;ieee754.write(buf,value,offset,littleEndian,23,4)}Buffer.prototype.writeFloatLE=function(value,offset,noAssert){_writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function(value,offset,noAssert){_writeFloat(this,value,offset,false,noAssert)};function _writeDouble(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean",
"missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+7<buf.length,"Trying to write beyond buffer length");verifIEEE754(value,1.7976931348623157E308,-1.7976931348623157E308)}var len=buf.length;if(offset>=len)return;ieee754.write(buf,value,offset,littleEndian,52,8)}Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){_writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){_writeDouble(this,
value,offset,false,noAssert)};Buffer.prototype.fill=function(value,start,end){if(!value)value=0;if(!start)start=0;if(!end)end=this.length;if(typeof value==="string")value=value.charCodeAt(0);assert(typeof value==="number"&&!isNaN(value),"value is not a number");assert(end>=start,"end < start");if(end===start)return;if(this.length===0)return;assert(start>=0&&start<this.length,"start out of bounds");assert(end>=0&&end<=this.length,"end out of bounds");for(var i=start;i<end;i++)this[i]=value};Buffer.prototype.inspect=
function(){var out=[];var len=this.length;for(var i=0;i<len;i++){out[i]=toHex(this[i]);if(i===exports.INSPECT_MAX_BYTES){out[i+1]="...";break}}return"<Buffer "+out.join(" ")+">"};Buffer.prototype.toArrayBuffer=function(){if(typeof Uint8Array!=="undefined")if(Buffer._useTypedArrays)return(new Buffer(this)).buffer;else{var buf=new Uint8Array(this.length);for(var i=0,len=buf.length;i<len;i+=1)buf[i]=this[i];return buf.buffer}else throw new Error("Buffer.toArrayBuffer not supported in this browser");
};function stringtrim(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")}var BP=Buffer.prototype;Buffer._augment=function(arr){arr._isBuffer=true;arr._get=arr.get;arr._set=arr.set;arr.get=BP.get;arr.set=BP.set;arr.write=BP.write;arr.toString=BP.toString;arr.toLocaleString=BP.toString;arr.toJSON=BP.toJSON;arr.copy=BP.copy;arr.slice=BP.slice;arr.readUInt8=BP.readUInt8;arr.readUInt16LE=BP.readUInt16LE;arr.readUInt16BE=BP.readUInt16BE;arr.readUInt32LE=BP.readUInt32LE;arr.readUInt32BE=
BP.readUInt32BE;arr.readInt8=BP.readInt8;arr.readInt16LE=BP.readInt16LE;arr.readInt16BE=BP.readInt16BE;arr.readInt32LE=BP.readInt32LE;arr.readInt32BE=BP.readInt32BE;arr.readFloatLE=BP.readFloatLE;arr.readFloatBE=BP.readFloatBE;arr.readDoubleLE=BP.readDoubleLE;arr.readDoubleBE=BP.readDoubleBE;arr.writeUInt8=BP.writeUInt8;arr.writeUInt16LE=BP.writeUInt16LE;arr.writeUInt16BE=BP.writeUInt16BE;arr.writeUInt32LE=BP.writeUInt32LE;arr.writeUInt32BE=BP.writeUInt32BE;arr.writeInt8=BP.writeInt8;arr.writeInt16LE=
BP.writeInt16LE;arr.writeInt16BE=BP.writeInt16BE;arr.writeInt32LE=BP.writeInt32LE;arr.writeInt32BE=BP.writeInt32BE;arr.writeFloatLE=BP.writeFloatLE;arr.writeFloatBE=BP.writeFloatBE;arr.writeDoubleLE=BP.writeDoubleLE;arr.writeDoubleBE=BP.writeDoubleBE;arr.fill=BP.fill;arr.inspect=BP.inspect;arr.toArrayBuffer=BP.toArrayBuffer;return arr};function clamp(index,len,defaultValue){if(typeof index!=="number")return defaultValue;index=~~index;if(index>=len)return len;if(index>=0)return index;index+=len;if(index>=
0)return index;return 0}function coerce(length){length=~~Math.ceil(+length);return length<0?0:length}function isArray(subject){return(Array.isArray||function(subject){return Object.prototype.toString.call(subject)==="[object Array]"})(subject)}function isArrayish(subject){return isArray(subject)||Buffer.isBuffer(subject)||subject&&typeof subject==="object"&&typeof subject.length==="number"}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(str){var byteArray=
[];for(var i=0;i<str.length;i++){var b=str.charCodeAt(i);if(b<=127)byteArray.push(str.charCodeAt(i));else{var start=i;if(b>=55296&&b<=57343)i++;var h=encodeURIComponent(str.slice(start,i+1)).substr(1).split("%");for(var j=0;j<h.length;j++)byteArray.push(parseInt(h[j],16))}}return byteArray}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++)byteArray.push(str.charCodeAt(i)&255);return byteArray}function utf16leToBytes(str){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;i++){c=
str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(str)}function blitBuffer(src,dst,offset,length){var pos;for(var i=0;i<length;i++){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}function verifuint(value,max){assert(typeof value==="number","cannot write a non-number as a number");
assert(value>=0,"specified a negative value for writing an unsigned value");assert(value<=max,"value is larger than maximum value for type");assert(Math.floor(value)===value,"value has a fractional component")}function verifsint(value,max,min){assert(typeof value==="number","cannot write a non-number as a number");assert(value<=max,"value larger than maximum allowed value");assert(value>=min,"value smaller than minimum allowed value");assert(Math.floor(value)===value,"value has a fractional component")}
function verifIEEE754(value,max,min){assert(typeof value==="number","cannot write a non-number as a number");assert(value<=max,"value larger than maximum allowed value");assert(value>=min,"value smaller than minimum allowed value")}function assert(test,message){if(!test)throw new Error(message||"Failed assertion");}},{"base64-js":3,"ieee754":4}],3:[function(_dereq_,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(exports){var Arr=typeof Uint8Array!==
"undefined"?Uint8Array:Array;var PLUS="+".charCodeAt(0);var SLASH="/".charCodeAt(0);var NUMBER="0".charCodeAt(0);var LOWER="a".charCodeAt(0);var UPPER="A".charCodeAt(0);var PLUS_URL_SAFE="-".charCodeAt(0);var SLASH_URL_SAFE="_".charCodeAt(0);function decode(elt){var code=elt.charCodeAt(0);if(code===PLUS||code===PLUS_URL_SAFE)return 62;if(code===SLASH||code===SLASH_URL_SAFE)return 63;if(code<NUMBER)return-1;if(code<NUMBER+10)return code-NUMBER+26+26;if(code<UPPER+26)return code-UPPER;if(code<LOWER+
26)return code-LOWER+26}function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0;arr=new Arr(b64.length*3/4-placeHolders);l=placeHolders>0?b64.length-4:b64.length;var L=0;function push(v){arr[L++]=v}for(i=0,j=0;i<l;i+=4,j+=3){tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+
3));push((tmp&16711680)>>16);push((tmp&65280)>>8);push(tmp&255)}if(placeHolders===2){tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4;push(tmp&255)}else if(placeHolders===1){tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2;push(tmp>>8&255);push(tmp&255)}return arr}function uint8ToBase64(uint8){var i,extraBytes=uint8.length%3,output="",temp,length;function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>
12&63)+encode(num>>6&63)+encode(num&63)}for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output+=tripletToBase64(temp)}switch(extraBytes){case 1:temp=uint8[uint8.length-1];output+=encode(temp>>2);output+=encode(temp<<4&63);output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1];output+=encode(temp>>10);output+=encode(temp>>4&63);output+=encode(temp<<2&63);output+="=";break}return output}exports.toByteArray=b64ToByteArray;
exports.fromByteArray=uint8ToBase64})(typeof exports==="undefined"?this.base64js={}:exports)},{}],4:[function(_dereq_,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8);m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+
i],i+=d,nBits-=8);if(e===0)e=1-eBias;else if(e===eMax)return m?NaN:(s?-1:1)*Infinity;else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=
Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1)value+=rt/c;else value+=rt*Math.pow(2,1-eBias);if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8);e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=s*128}},{}],5:[function(_dereq_,module,
exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,
handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error")if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error)throw er;throw TypeError('Uncaught, unspecified "error" event.');}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);
break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events=
{};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners))m=this._maxListeners;else m=EventEmitter.defaultMaxListeners;if(m&&m>0&&this._events[type].length>m){this._events[type].warned=
true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function")console.trace()}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=
true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",
type,listener)}else if(isObject(list)){for(i=length;i-- >0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else list.splice(position,1);if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===
0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners))this.removeListener(type,listeners);else while(listeners.length)this.removeListener(type,listeners[listeners.length-1]);delete this._events[type];return this};EventEmitter.prototype.listeners=
function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])ret=0;else if(isFunction(emitter._events[type]))ret=1;else ret=emitter._events[type].length;return ret};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg===
"object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],6:[function(_dereq_,module,exports){var http=module.exports;var EventEmitter=_dereq_("events").EventEmitter;var Request=_dereq_("./lib/request");var url=_dereq_("url");http.request=function(params,cb){if(typeof params==="string")params=url.parse(params);if(!params)params={};if(!params.host&&!params.port)params.port=parseInt(window.location.port,10);if(!params.host&&params.hostname)params.host=params.hostname;if(!params.scheme)params.scheme=
window.location.protocol.split(":")[0];if(!params.host)params.host=window.location.hostname||window.location.host;if(/:/.test(params.host)){if(!params.port)params.port=params.host.split(":")[1];params.host=params.host.split(":")[0]}if(!params.port)params.port=params.scheme=="https"?443:80;var req=new Request(new xhrHttp,params);if(cb)req.on("response",cb);return req};http.get=function(params,cb){params.method="GET";var req=http.request(params,cb);req.end();return req};http.Agent=function(){};http.Agent.defaultMaxSockets=
4;var xhrHttp=function(){if(typeof window==="undefined")throw new Error("no window object present");else if(window.XMLHttpRequest)return window.XMLHttpRequest;else if(window.ActiveXObject){var axs=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];for(var i=0;i<axs.length;i++)try{var ax=new window.ActiveXObject(axs[i]);return function(){if(ax){var ax_=ax;ax=null;return ax_}else return new window.ActiveXObject(axs[i])}}catch(e){}throw new Error("ajax not supported in this browser");}else throw new Error("ajax not supported in this browser");
}();http.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",
407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",
500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":7,"events":5,"url":28}],7:[function(_dereq_,module,exports){var Stream=_dereq_("stream");var Response=_dereq_("./response");var Base64=_dereq_("Base64");var inherits=_dereq_("inherits");var Request=
module.exports=function(xhr,params){var self=this;self.writable=true;self.xhr=xhr;self.body=[];self.uri=(params.scheme||"http")+"://"+params.host+(params.port?":"+params.port:"")+(params.path||"/");if(typeof params.withCredentials==="undefined")params.withCredentials=true;try{xhr.withCredentials=params.withCredentials}catch(e){}xhr.open(params.method||"GET",self.uri,true);self._headers={};if(params.headers){var keys=objectKeys(params.headers);for(var i=0;i<keys.length;i++){var key=keys[i];if(!self.isSafeRequestHeader(key))continue;
var value=params.headers[key];self.setHeader(key,value)}}if(params.auth)this.setHeader("Authorization","Basic "+Base64.btoa(params.auth));var res=new Response;res.on("close",function(){self.emit("close")});res.on("ready",function(){self.emit("response",res)});xhr.onreadystatechange=function(){if(xhr.__aborted)return;res.handle(xhr)}};inherits(Request,Stream);Request.prototype.setHeader=function(key,value){this._headers[key.toLowerCase()]=value};Request.prototype.getHeader=function(key){return this._headers[key.toLowerCase()]};
Request.prototype.removeHeader=function(key){delete this._headers[key.toLowerCase()]};Request.prototype.write=function(s){this.body.push(s)};Request.prototype.destroy=function(s){this.xhr.__aborted=true;this.xhr.abort();this.emit("close")};Request.prototype.end=function(s){if(s!==undefined)this.body.push(s);var keys=objectKeys(this._headers);for(var i=0;i<keys.length;i++){var key=keys[i];var value=this._headers[key];if(isArray(value))for(var j=0;j<value.length;j++)this.xhr.setRequestHeader(key,value[j]);
else this.xhr.setRequestHeader(key,value)}if(this.body.length===0)this.xhr.send("");else if(typeof this.body[0]==="string")this.xhr.send(this.body.join(""));else if(isArray(this.body[0])){var body=[];for(var i=0;i<this.body.length;i++)body.push.apply(body,this.body[i]);this.xhr.send(body)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){var len=0;for(var i=0;i<this.body.length;i++)len+=this.body[i].length;var body=new this.body[0].constructor(len);var k=0;for(var i=0;i<this.body.length;i++){var b=
this.body[i];for(var j=0;j<b.length;j++)body[k++]=b[j]}this.xhr.send(body)}else{var body="";for(var i=0;i<this.body.length;i++)body+=this.body[i].toString();this.xhr.send(body)}};Request.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];Request.prototype.isSafeRequestHeader=
function(headerName){if(!headerName)return false;return indexOf(Request.unsafeHeaders,headerName.toLowerCase())===-1};var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};var indexOf=function(xs,x){if(xs.indexOf)return xs.indexOf(x);for(var i=0;i<xs.length;i++)if(xs[i]===x)return i;return-1}},{"./response":8,"Base64":9,"inherits":11,"stream":19}],8:[function(_dereq_,
module,exports){var Stream=_dereq_("stream");var util=_dereq_("util");var Response=module.exports=function(res){this.offset=0;this.readable=true};util.inherits(Response,Stream);var capable={streaming:true,status2:true};function parseHeaders(res){var lines=res.getAllResponseHeaders().split(/\r?\n/);var headers={};for(var i=0;i<lines.length;i++){var line=lines[i];if(line==="")continue;var m=line.match(/^([^:]+):\s*(.*)/);if(m){var key=m[1].toLowerCase(),value=m[2];if(headers[key]!==undefined)if(isArray(headers[key]))headers[key].push(value);
else headers[key]=[headers[key],value];else headers[key]=value}else headers[line]=true}return headers}Response.prototype.getResponse=function(xhr){var respType=String(xhr.responseType).toLowerCase();if(respType==="blob")return xhr.responseBlob||xhr.response;if(respType==="arraybuffer")return xhr.response;return xhr.responseText};Response.prototype.getHeader=function(key){return this.headers[key.toLowerCase()]};Response.prototype.handle=function(res){if(res.readyState===2&&capable.status2){try{this.statusCode=
res.status;this.headers=parseHeaders(res)}catch(err){capable.status2=false}if(capable.status2)this.emit("ready")}else if(capable.streaming&&res.readyState===3){try{if(!this.statusCode){this.statusCode=res.status;this.headers=parseHeaders(res);this.emit("ready")}}catch(err){}try{this._emitData(res)}catch(err){capable.streaming=false}}else if(res.readyState===4){if(!this.statusCode){this.statusCode=res.status;this.emit("ready")}this._emitData(res);if(res.error)this.emit("error",this.getResponse(res));
else this.emit("end");this.emit("close")}};Response.prototype._emitData=function(res){var respBody=this.getResponse(res);if(respBody.toString().match(/ArrayBuffer/)){this.emit("data",new Uint8Array(respBody,this.offset));this.offset=respBody.byteLength;return}if(respBody.length>this.offset){this.emit("data",respBody.slice(this.offset));this.offset=respBody.length}};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{"stream":19,"util":30}],9:[function(_dereq_,
module,exports){(function(){var object=typeof exports!="undefined"?exports:this;var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function InvalidCharacterError(message){this.message=message}InvalidCharacterError.prototype=new Error;InvalidCharacterError.prototype.name="InvalidCharacterError";object.btoa||(object.btoa=function(input){for(var block,charCode,idx=0,map=chars,output="";input.charAt(idx|0)||(map="=",idx%1);output+=map.charAt(63&block>>8-idx%1*8)){charCode=input.charCodeAt(idx+=
3/4);if(charCode>255)throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");block=block<<8|charCode}return output});object.atob||(object.atob=function(input){input=input.replace(/=+$/,"");if(input.length%4==1)throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.");for(var bc=0,bs,buffer,idx=0,output="";buffer=input.charAt(idx++);~buffer&&(bs=bc%4?bs*64+buffer:buffer,bc++%4)?output+=String.fromCharCode(255&
bs>>(-2*bc&6)):0)buffer=chars.indexOf(buffer);return output})})()},{}],10:[function(_dereq_,module,exports){var http=_dereq_("http");var https=module.exports;for(var key in http)if(http.hasOwnProperty(key))https[key]=http[key];https.request=function(params,cb){if(!params)params={};params.scheme="https";return http.request.call(this,params,cb)}},{"http":6}],11:[function(_dereq_,module,exports){if(typeof Object.create==="function")module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;
ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})};else module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}},{}],12:[function(_dereq_,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last===
".")parts.splice(i,1);else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!==
"string")throw new TypeError("Arguments to path.resolve must be strings");else if(!path)continue;resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter(path.split("/"),function(p){return!!p}),
!isAbsolute).join("/");if(!path&&!isAbsolute)path=".";if(path&&trailingSlash)path+="/";return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if(typeof p!=="string")throw new TypeError("Arguments to path.join must be strings");return p}).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);
function trim(arr){var start=0;for(;start<arr.length;start++)if(arr[start]!=="")break;var end=arr.length-1;for(;end>=0;end--)if(arr[end]!=="")break;if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");
outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];if(!root&&!dir)return".";if(dir)dir=dir.substr(0,dir.length-1);return root+dir};exports.basename=function(path,ext){var f=splitPath(path)[2];if(ext&&f.substr(-1*ext.length)===ext)f=f.substr(0,f.length-ext.length);return f};exports.extname=function(path){return splitPath(path)[3]};function filter(xs,
f){if(xs.filter)return xs.filter(f);var res=[];for(var i=0;i<xs.length;i++)if(f(xs[i],i,xs))res.push(xs[i]);return res}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len)}:function(str,start,len){if(start<0)start=str.length+start;return str.substr(start,len)}}).call(this,_dereq_("VCmEsw"))},{"VCmEsw":13}],13:[function(_dereq_,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;
var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];window.addEventListener("message",function(ev){var source=ev.source;if((source===window||source===null)&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,
0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported");};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported");}},{}],14:[function(_dereq_,module,exports){(function(global){(function(root){var freeExports=
typeof exports=="object"&&exports;var freeModule=typeof module=="object"&&module&&module.exports==freeExports&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal)root=freeGlobal;var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^ -~]/,regexSeparators=/\x2E|\u3002|\uFF0E|\uFF61/g,errors={"overflow":"Overflow: input needs wider integers to process",
"not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,key;function error(type){throw RangeError(errors[type]);}function map(array,fn){var length=array.length;while(length--)array[length]=fn(array[length]);return array}function mapDomain(string,fn){return map(string.split(regexSeparators),fn).join(".")}function ucs2decode(string){var output=[],counter=0,length=string.length,value,
extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320)output.push(((value&1023)<<10)+(extra&1023)+65536);else{output.push(value);counter--}}else output.push(value)}return output}function ucs2encode(array){return map(array,function(value){var output="";if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value);
return output}).join("")}function basicToDigit(codePoint){if(codePoint-48<10)return codePoint-22;if(codePoint-65<26)return codePoint-65;if(codePoint-97<26)return codePoint-97;return base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5)}function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base)delta=floor(delta/baseMinusTMin);return floor(k+(baseMinusTMin+1)*delta/
(delta+skew))}function decode(input){var output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,baseMinusT;basic=input.lastIndexOf(delimiter);if(basic<0)basic=0;for(j=0;j<basic;++j){if(input.charCodeAt(j)>=128)error("not-basic");output.push(input.charCodeAt(j))}for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;;k+=base){if(index>=inputLength)error("invalid-input");digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>
floor((maxInt-i)/w))error("overflow");i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t)break;baseMinusT=base-t;if(w>floor(maxInt/baseMinusT))error("overflow");w*=baseMinusT}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n)error("overflow");n+=floor(i/out);i%=out;output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],inputLength,handledCPCountPlusOne,baseMinusT,qMinusT;
input=ucs2decode(input);inputLength=input.length;n=initialN;delta=0;bias=initialBias;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<128)output.push(stringFromCharCode(currentValue))}handledCPCount=basicLength=output.length;if(basicLength)output.push(delimiter);while(handledCPCount<inputLength){for(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m)m=currentValue}handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne))error("overflow");
delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt)error("overflow");if(currentValue==n){for(q=delta,k=base;;k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t)break;qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}++delta;
++n}return output.join("")}function toUnicode(domain){return mapDomain(domain,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(domain){return mapDomain(domain,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}punycode={"version":"1.2.4","ucs2":{"decode":ucs2decode,"encode":ucs2encode},"decode":decode,"encode":encode,"toASCII":toASCII,"toUnicode":toUnicode};if(typeof define=="function"&&typeof define.amd==
"object"&&define.amd)define("punycode",function(){return punycode});else if(freeExports&&!freeExports.nodeType)if(freeModule)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode})(this)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],15:[function(_dereq_,module,exports){function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=
function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1E3;if(options&&typeof options.maxKeys==="number")maxKeys=options.maxKeys;var len=qs.length;if(maxKeys>0&&len>maxKeys)len=maxKeys;for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);
if(!hasOwnProperty(obj,k))obj[k]=v;else if(isArray(obj[k]))obj[k].push(v);else obj[k]=[obj[k],v]}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],16:[function(_dereq_,module,exports){var stringifyPrimitive=function(v){switch(typeof v){case "string":return v;case "boolean":return v?"true":"false";case "number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null)obj=
undefined;if(typeof obj==="object")return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k]))return obj[k].map(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep);else return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep);if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)===
"[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key);return res}},{}],17:[function(_dereq_,module,exports){exports.decode=exports.parse=_dereq_("./decode");exports.encode=exports.stringify=_dereq_("./encode")},{"./decode":15,"./encode":16}],18:[function(_dereq_,module,exports){module.exports=
Duplex;var inherits=_dereq_("inherits");var setImmediate=_dereq_("process/browser.js").nextTick;var Readable=_dereq_("./readable.js");var Writable=_dereq_("./writable.js");inherits(Duplex,Readable);Duplex.prototype.write=Writable.prototype.write;Duplex.prototype.end=Writable.prototype.end;Duplex.prototype._write=Writable.prototype._write;function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options);Writable.call(this,options);if(options&&options.readable===
false)this.readable=false;if(options&&options.writable===false)this.writable=false;this.allowHalfOpen=true;if(options&&options.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",onend)}function onend(){if(this.allowHalfOpen||this._writableState.ended)return;var self=this;setImmediate(function(){self.end()})}},{"./readable.js":22,"./writable.js":24,"inherits":11,"process/browser.js":20}],19:[function(_dereq_,module,exports){module.exports=Stream;var EE=_dereq_("events").EventEmitter;var inherits=
_dereq_("inherits");inherits(Stream,EE);Stream.Readable=_dereq_("./readable.js");Stream.Writable=_dereq_("./writable.js");Stream.Duplex=_dereq_("./duplex.js");Stream.Transform=_dereq_("./transform.js");Stream.PassThrough=_dereq_("./passthrough.js");Stream.Stream=Stream;function Stream(){EE.call(this)}Stream.prototype.pipe=function(dest,options){var source=this;function ondata(chunk){if(dest.writable)if(false===dest.write(chunk)&&source.pause)source.pause()}source.on("data",ondata);function ondrain(){if(source.readable&&
source.resume)source.resume()}dest.on("drain",ondrain);if(!dest._isStdio&&(!options||options.end!==false)){source.on("end",onend);source.on("close",onclose)}var didOnEnd=false;function onend(){if(didOnEnd)return;didOnEnd=true;dest.end()}function onclose(){if(didOnEnd)return;didOnEnd=true;if(typeof dest.destroy==="function")dest.destroy()}function onerror(er){cleanup();if(EE.listenerCount(this,"error")===0)throw er;}source.on("error",onerror);dest.on("error",onerror);function cleanup(){source.removeListener("data",
ondata);dest.removeListener("drain",ondrain);source.removeListener("end",onend);source.removeListener("close",onclose);source.removeListener("error",onerror);dest.removeListener("error",onerror);source.removeListener("end",cleanup);source.removeListener("close",cleanup);dest.removeListener("close",cleanup)}source.on("end",cleanup);source.on("close",cleanup);dest.on("close",cleanup);dest.emit("pipe",source);return dest}},{"./duplex.js":18,"./passthrough.js":21,"./readable.js":22,"./transform.js":23,
"./writable.js":24,"events":5,"inherits":11}],20:[function(_dereq_,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];window.addEventListener("message",function(ev){var source=ev.source;if((source===window||source===null)&&ev.data===
"process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];process.binding=function(name){throw new Error("process.binding is not supported");};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported");}},
{}],21:[function(_dereq_,module,exports){module.exports=PassThrough;var Transform=_dereq_("./transform.js");var inherits=_dereq_("inherits");inherits(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./transform.js":23,"inherits":11}],22:[function(_dereq_,module,exports){(function(process){module.exports=Readable;Readable.ReadableState=
ReadableState;var EE=_dereq_("events").EventEmitter;var Stream=_dereq_("./index.js");var Buffer=_dereq_("buffer").Buffer;var setImmediate=_dereq_("process/browser.js").nextTick;var StringDecoder;var inherits=_dereq_("inherits");inherits(Readable,Stream);function ReadableState(options,stream){options=options||{};var hwm=options.highWaterMark;this.highWaterMark=hwm||hwm===0?hwm:16*1024;this.highWaterMark=~~this.highWaterMark;this.buffer=[];this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=
false;this.ended=false;this.endEmitted=false;this.reading=false;this.calledRead=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.objectMode=!!options.objectMode;this.defaultEncoding=options.defaultEncoding||"utf8";this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)StringDecoder=_dereq_("string_decoder").StringDecoder;this.decoder=new StringDecoder(options.encoding);
this.encoding=options.encoding}}function Readable(options){if(!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this);this.readable=true;Stream.call(this)}Readable.prototype.push=function(chunk,encoding){var state=this._readableState;if(typeof chunk==="string"&&!state.objectMode){encoding=encoding||state.defaultEncoding;if(encoding!==state.encoding){chunk=new Buffer(chunk,encoding);encoding=""}}return readableAddChunk(this,state,chunk,encoding,
false)};Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,"",true)};function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er)stream.emit("error",er);else if(chunk===null||chunk===undefined){state.reading=false;if(!state.ended)onEofChunk(stream,state)}else if(state.objectMode||chunk&&chunk.length>0)if(state.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",
e)}else if(state.endEmitted&&addToFront){var e=new Error("stream.unshift() after end event");stream.emit("error",e)}else{if(state.decoder&&!addToFront&&!encoding)chunk=state.decoder.write(chunk);state.length+=state.objectMode?1:chunk.length;if(addToFront)state.buffer.unshift(chunk);else{state.reading=false;state.buffer.push(chunk)}if(state.needReadable)emitReadable(stream);maybeReadMore(stream,state)}else if(!addToFront)state.reading=false;return needMoreData(state)}function needMoreData(state){return!state.ended&&
(state.needReadable||state.length<state.highWaterMark||state.length===0)}Readable.prototype.setEncoding=function(enc){if(!StringDecoder)StringDecoder=_dereq_("string_decoder").StringDecoder;this._readableState.decoder=new StringDecoder(enc);this._readableState.encoding=enc};var MAX_HWM=8388608;function roundUpToNextPowerOf2(n){if(n>=MAX_HWM)n=MAX_HWM;else{n--;for(var p=1;p<32;p<<=1)n|=n>>p;n++}return n}function howMuchToRead(n,state){if(state.length===0&&state.ended)return 0;if(state.objectMode)return n===
0?0:1;if(isNaN(n)||n===null)if(state.flowing&&state.buffer.length)return state.buffer[0].length;else return state.length;if(n<=0)return 0;if(n>state.highWaterMark)state.highWaterMark=roundUpToNextPowerOf2(n);if(n>state.length)if(!state.ended){state.needReadable=true;return 0}else return state.length;return n}Readable.prototype.read=function(n){var state=this._readableState;state.calledRead=true;var nOrig=n;if(typeof n!=="number"||n>0)state.emittedReadable=false;if(n===0&&state.needReadable&&(state.length>=
state.highWaterMark||state.ended)){emitReadable(this);return null}n=howMuchToRead(n,state);if(n===0&&state.ended){if(state.length===0)endReadable(this);return null}var doRead=state.needReadable;if(state.length-n<=state.highWaterMark)doRead=true;if(state.ended||state.reading)doRead=false;if(doRead){state.reading=true;state.sync=true;if(state.length===0)state.needReadable=true;this._read(state.highWaterMark);state.sync=false}if(doRead&&!state.reading)n=howMuchToRead(nOrig,state);var ret;if(n>0)ret=
fromList(n,state);else ret=null;if(ret===null){state.needReadable=true;n=0}state.length-=n;if(state.length===0&&!state.ended)state.needReadable=true;if(state.ended&&!state.endEmitted&&state.length===0)endReadable(this);return ret};function chunkInvalid(state,chunk){var er=null;if(!Buffer.isBuffer(chunk)&&"string"!==typeof chunk&&chunk!==null&&chunk!==undefined&&!state.objectMode&&!er)er=new TypeError("Invalid non-string/buffer chunk");return er}function onEofChunk(stream,state){if(state.decoder&&
!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length){state.buffer.push(chunk);state.length+=state.objectMode?1:chunk.length}}state.ended=true;if(state.length>0)emitReadable(stream);else endReadable(stream)}function emitReadable(stream){var state=stream._readableState;state.needReadable=false;if(state.emittedReadable)return;state.emittedReadable=true;if(state.sync)setImmediate(function(){emitReadable_(stream)});else emitReadable_(stream)}function emitReadable_(stream){stream.emit("readable")}
function maybeReadMore(stream,state){if(!state.readingMore){state.readingMore=true;setImmediate(function(){maybeReadMore_(stream,state)})}}function maybeReadMore_(stream,state){var len=state.length;while(!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark){stream.read(0);if(len===state.length)break;else len=state.length}state.readingMore=false}Readable.prototype._read=function(n){this.emit("error",new Error("not implemented"))};Readable.prototype.pipe=function(dest,pipeOpts){var src=
this;var state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest);break}state.pipesCount+=1;var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:cleanup;if(state.endEmitted)setImmediate(endFn);else src.once("end",endFn);dest.on("unpipe",onunpipe);function onunpipe(readable){if(readable!==src)return;cleanup()}function onend(){dest.end()}var ondrain=
pipeOnDrain(src);dest.on("drain",ondrain);function cleanup(){dest.removeListener("close",onclose);dest.removeListener("finish",onfinish);dest.removeListener("drain",ondrain);dest.removeListener("error",onerror);dest.removeListener("unpipe",onunpipe);src.removeListener("end",onend);src.removeListener("end",cleanup);if(!dest._writableState||dest._writableState.needDrain)ondrain()}var errListeners=EE.listenerCount(dest,"error");function onerror(er){unpipe();if(errListeners===0&&EE.listenerCount(dest,
"error")===0)dest.emit("error",er)}dest.once("error",onerror);function onclose(){dest.removeListener("finish",onfinish);unpipe()}dest.once("close",onclose);function onfinish(){dest.removeListener("close",onclose);unpipe()}dest.once("finish",onfinish);function unpipe(){src.unpipe(dest)}dest.emit("pipe",src);if(!state.flowing){this.on("readable",pipeOnReadable);state.flowing=true;setImmediate(function(){flow(src)})}return dest};function pipeOnDrain(src){return function(){var dest=this;var state=src._readableState;
state.awaitDrain--;if(state.awaitDrain===0)flow(src)}}function flow(src){var state=src._readableState;var chunk;state.awaitDrain=0;function write(dest,i,list){var written=dest.write(chunk);if(false===written)state.awaitDrain++}while(state.pipesCount&&null!==(chunk=src.read())){if(state.pipesCount===1)write(state.pipes,0,null);else forEach(state.pipes,write);src.emit("data",chunk);if(state.awaitDrain>0)return}if(state.pipesCount===0){state.flowing=false;if(EE.listenerCount(src,"data")>0)emitDataEvents(src);
return}state.ranOut=true}function pipeOnReadable(){if(this._readableState.ranOut){this._readableState.ranOut=false;flow(this)}}Readable.prototype.unpipe=function(dest){var state=this._readableState;if(state.pipesCount===0)return this;if(state.pipesCount===1){if(dest&&dest!==state.pipes)return this;if(!dest)dest=state.pipes;state.pipes=null;state.pipesCount=0;this.removeListener("readable",pipeOnReadable);state.flowing=false;if(dest)dest.emit("unpipe",this);return this}if(!dest){var dests=state.pipes;
var len=state.pipesCount;state.pipes=null;state.pipesCount=0;this.removeListener("readable",pipeOnReadable);state.flowing=false;for(var i=0;i<len;i++)dests[i].emit("unpipe",this);return this}var i=indexOf(state.pipes,dest);if(i===-1)return this;state.pipes.splice(i,1);state.pipesCount-=1;if(state.pipesCount===1)state.pipes=state.pipes[0];dest.emit("unpipe",this);return this};Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if(ev==="data"&&!this._readableState.flowing)emitDataEvents(this);
if(ev==="readable"&&this.readable){var state=this._readableState;if(!state.readableListening){state.readableListening=true;state.emittedReadable=false;state.needReadable=true;if(!state.reading)this.read(0);else if(state.length)emitReadable(this,state)}}return res};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.resume=function(){emitDataEvents(this);this.read(0);this.emit("resume")};Readable.prototype.pause=function(){emitDataEvents(this,true);this.emit("pause")};function emitDataEvents(stream,
startPaused){var state=stream._readableState;if(state.flowing)throw new Error("Cannot switch to old mode now.");var paused=startPaused||false;var readable=false;stream.readable=true;stream.pipe=Stream.prototype.pipe;stream.on=stream.addListener=Stream.prototype.on;stream.on("readable",function(){readable=true;var c;while(!paused&&null!==(c=stream.read()))stream.emit("data",c);if(c===null){readable=false;stream._readableState.needReadable=true}});stream.pause=function(){paused=true;this.emit("pause")};
stream.resume=function(){paused=false;if(readable)setImmediate(function(){stream.emit("readable")});else this.read(0);this.emit("resume")};stream.emit("readable")}Readable.prototype.wrap=function(stream){var state=this._readableState;var paused=false;var self=this;stream.on("end",function(){if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length)self.push(chunk)}self.push(null)});stream.on("data",function(chunk){if(state.decoder)chunk=state.decoder.write(chunk);if(!chunk||
!state.objectMode&&!chunk.length)return;var ret=self.push(chunk);if(!ret){paused=true;stream.pause()}});for(var i in stream)if(typeof stream[i]==="function"&&typeof this[i]==="undefined")this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i);var events=["error","close","destroy","pause","resume"];forEach(events,function(ev){stream.on(ev,function(x){return self.emit.apply(self,ev,x)})});self._read=function(n){if(paused){paused=false;stream.resume()}};return self};
Readable._fromList=fromList;function fromList(n,state){var list=state.buffer;var length=state.length;var stringMode=!!state.decoder;var objectMode=!!state.objectMode;var ret;if(list.length===0)return null;if(length===0)ret=null;else if(objectMode)ret=list.shift();else if(!n||n>=length){if(stringMode)ret=list.join("");else ret=Buffer.concat(list,length);list.length=0}else if(n<list[0].length){var buf=list[0];ret=buf.slice(0,n);list[0]=buf.slice(n)}else if(n===list[0].length)ret=list.shift();else{if(stringMode)ret=
"";else ret=new Buffer(n);var c=0;for(var i=0,l=list.length;i<l&&c<n;i++){var buf=list[0];var cpy=Math.min(n-c,buf.length);if(stringMode)ret+=buf.slice(0,cpy);else buf.copy(ret,c,0,cpy);if(cpy<buf.length)list[0]=buf.slice(cpy);else list.shift();c+=cpy}}return ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error("endReadable called on non-empty stream");if(!state.endEmitted&&state.calledRead){state.ended=true;setImmediate(function(){if(!state.endEmitted&&
state.length===0){state.endEmitted=true;stream.readable=false;stream.emit("end")}})}}function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++)f(xs[i],i)}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++)if(xs[i]===x)return i;return-1}}).call(this,_dereq_("VCmEsw"))},{"./index.js":19,"VCmEsw":13,"buffer":2,"events":5,"inherits":11,"process/browser.js":20,"string_decoder":25}],23:[function(_dereq_,module,exports){module.exports=Transform;var Duplex=_dereq_("./duplex.js");var inherits=_dereq_("inherits");
inherits(Transform,Duplex);function TransformState(options,stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=false;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("no writecb in Transform class"));ts.writechunk=null;ts.writecb=null;if(data!==null&&data!==undefined)stream.push(data);
if(cb)cb(er);var rs=stream._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark)stream._read(rs.highWaterMark)}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options);var ts=this._transformState=new TransformState(options,this);var stream=this;this._readableState.needReadable=true;this._readableState.sync=false;this.once("finish",function(){if("function"===typeof this._flush)this._flush(function(er){done(stream,
er)});else done(stream)})}Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding)};Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("not implemented");};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<
rs.highWaterMark)this._read(rs.highWaterMark)}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk&&ts.writecb&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)}else ts.needTransform=true};function done(stream,er){if(er)return stream.emit("error",er);var ws=stream._writableState;var rs=stream._readableState;var ts=stream._transformState;if(ws.length)throw new Error("calling transform done when ws.length != 0");
if(ts.transforming)throw new Error("calling transform done when still transforming");return stream.push(null)}},{"./duplex.js":18,"inherits":11}],24:[function(_dereq_,module,exports){module.exports=Writable;Writable.WritableState=WritableState;var isUint8Array=typeof Uint8Array!=="undefined"?function(x){return x instanceof Uint8Array}:function(x){return x&&x.constructor&&x.constructor.name==="Uint8Array"};var isArrayBuffer=typeof ArrayBuffer!=="undefined"?function(x){return x instanceof ArrayBuffer}:
function(x){return x&&x.constructor&&x.constructor.name==="ArrayBuffer"};var inherits=_dereq_("inherits");var Stream=_dereq_("./index.js");var setImmediate=_dereq_("process/browser.js").nextTick;var Buffer=_dereq_("buffer").Buffer;inherits(Writable,Stream);function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb}function WritableState(options,stream){options=options||{};var hwm=options.highWaterMark;this.highWaterMark=hwm||hwm===0?hwm:16*1024;this.objectMode=!!options.objectMode;
this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||"utf8";this.length=0;this.writing=false;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er)};this.writecb=null;this.writelen=0;this.buffer=[]}function Writable(options){if(!(this instanceof Writable)&&!(this instanceof Stream.Duplex))return new Writable(options);
this._writableState=new WritableState(options,this);this.writable=true;Stream.call(this)}Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))};function writeAfterEnd(stream,state,cb){var er=new Error("write after end");stream.emit("error",er);setImmediate(function(){cb(er)})}function validChunk(stream,state,chunk,cb){var valid=true;if(!Buffer.isBuffer(chunk)&&"string"!==typeof chunk&&chunk!==null&&chunk!==undefined&&!state.objectMode){var er=new TypeError("Invalid non-string/buffer chunk");
stream.emit("error",er);setImmediate(function(){cb(er)});valid=false}return valid}Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState;var ret=false;if(typeof encoding==="function"){cb=encoding;encoding=null}if(!Buffer.isBuffer(chunk)&&isUint8Array(chunk))chunk=new Buffer(chunk);if(isArrayBuffer(chunk)&&typeof Uint8Array!=="undefined")chunk=new Buffer(new Uint8Array(chunk));if(Buffer.isBuffer(chunk))encoding="buffer";else if(!encoding)encoding=state.defaultEncoding;if(typeof cb!==
"function")cb=function(){};if(state.ended)writeAfterEnd(this,state,cb);else if(validChunk(this,state,chunk,cb))ret=writeOrBuffer(this,state,chunk,encoding,cb);return ret};function decodeChunk(state,chunk,encoding){if(!state.objectMode&&state.decodeStrings!==false&&typeof chunk==="string")chunk=new Buffer(chunk,encoding);return chunk}function writeOrBuffer(stream,state,chunk,encoding,cb){chunk=decodeChunk(state,chunk,encoding);var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<
state.highWaterMark;state.needDrain=!ret;if(state.writing)state.buffer.push(new WriteReq(chunk,encoding,cb));else doWrite(stream,state,len,chunk,encoding,cb);return ret}function doWrite(stream,state,len,chunk,encoding,cb){state.writelen=len;state.writecb=cb;state.writing=true;state.sync=true;stream._write(chunk,encoding,state.onwrite);state.sync=false}function onwriteError(stream,state,sync,er,cb){if(sync)setImmediate(function(){cb(er)});else cb(er);stream.emit("error",er)}function onwriteStateUpdate(state){state.writing=
false;state.writecb=null;state.length-=state.writelen;state.writelen=0}function onwrite(stream,er){var state=stream._writableState;var sync=state.sync;var cb=state.writecb;onwriteStateUpdate(state);if(er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(stream,state);if(!finished&&!state.bufferProcessing&&state.buffer.length)clearBuffer(stream,state);if(sync)setImmediate(function(){afterWrite(stream,state,finished,cb)});else afterWrite(stream,state,finished,cb)}}function afterWrite(stream,
state,finished,cb){if(!finished)onwriteDrain(stream,state);cb();if(finished)finishMaybe(stream,state)}function onwriteDrain(stream,state){if(state.length===0&&state.needDrain){state.needDrain=false;stream.emit("drain")}}function clearBuffer(stream,state){state.bufferProcessing=true;for(var c=0;c<state.buffer.length;c++){var entry=state.buffer[c];var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state.objectMode?1:chunk.length;doWrite(stream,state,len,chunk,encoding,cb);
if(state.writing){c++;break}}state.bufferProcessing=false;if(c<state.buffer.length)state.buffer=state.buffer.slice(c);else state.buffer.length=0}Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("not implemented"))};Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;if(typeof chunk==="function"){cb=chunk;chunk=null;encoding=null}else if(typeof encoding==="function"){cb=encoding;encoding=null}if(typeof chunk!=="undefined"&&chunk!==null)this.write(chunk,
encoding);if(!state.ending&&!state.finished)endWritable(this,state,cb)};function needFinish(stream,state){return state.ending&&state.length===0&&!state.finished&&!state.writing}function finishMaybe(stream,state){var need=needFinish(stream,state);if(need){state.finished=true;stream.emit("finish")}return need}function endWritable(stream,state,cb){state.ending=true;finishMaybe(stream,state);if(cb)if(state.finished)setImmediate(cb);else stream.once("finish",cb);state.ended=true}},{"./index.js":19,"buffer":2,
"inherits":11,"process/browser.js":20}],25:[function(_dereq_,module,exports){var Buffer=_dereq_("buffer").Buffer;function assertEncoding(encoding){if(encoding&&!Buffer.isEncoding(encoding))throw new Error("Unknown encoding: "+encoding);}var StringDecoder=exports.StringDecoder=function(encoding){this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,"");assertEncoding(encoding);switch(this.encoding){case "utf8":this.surrogateSize=3;break;case "ucs2":case "utf16le":this.surrogateSize=2;this.detectIncompleteChar=
utf16DetectIncompleteChar;break;case "base64":this.surrogateSize=3;this.detectIncompleteChar=base64DetectIncompleteChar;break;default:this.write=passThroughWrite;return}this.charBuffer=new Buffer(6);this.charReceived=0;this.charLength=0};StringDecoder.prototype.write=function(buffer){var charStr="";var offset=0;while(this.charLength){var i=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;buffer.copy(this.charBuffer,this.charReceived,offset,i);this.charReceived+=
i-offset;offset=i;if(this.charReceived<this.charLength)return"";charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(charCode>=55296&&charCode<=56319){this.charLength+=this.surrogateSize;charStr="";continue}this.charReceived=this.charLength=0;if(i==buffer.length)return charStr;buffer=buffer.slice(i,buffer.length);break}var lenIncomplete=this.detectIncompleteChar(buffer);var end=buffer.length;if(this.charLength){buffer.copy(this.charBuffer,
0,buffer.length-lenIncomplete,end);this.charReceived=lenIncomplete;end-=lenIncomplete}charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1;var charCode=charStr.charCodeAt(end);if(charCode>=55296&&charCode<=56319){var size=this.surrogateSize;this.charLength+=size;this.charReceived+=size;this.charBuffer.copy(this.charBuffer,size,0,size);this.charBuffer.write(charStr.charAt(charStr.length-1),this.encoding);return charStr.substring(0,end)}return charStr};StringDecoder.prototype.detectIncompleteChar=
function(buffer){var i=buffer.length>=3?3:buffer.length;for(;i>0;i--){var c=buffer[buffer.length-i];if(i==1&&c>>5==6){this.charLength=2;break}if(i<=2&&c>>4==14){this.charLength=3;break}if(i<=3&&c>>3==30){this.charLength=4;break}}return i};StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length)res=this.write(buffer);if(this.charReceived){var cr=this.charReceived;var buf=this.charBuffer;var enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res};function passThroughWrite(buffer){return buffer.toString(this.encoding)}
function utf16DetectIncompleteChar(buffer){var incomplete=this.charReceived=buffer.length%2;this.charLength=incomplete?2:0;return incomplete}function base64DetectIncompleteChar(buffer){var incomplete=this.charReceived=buffer.length%3;this.charLength=incomplete?3:0;return incomplete}},{"buffer":2}],26:[function(_dereq_,module,exports){if(typeof setTimeout!=="undefined")exports.setTimeout=function(){return setTimeout.apply(window,arguments)};if(typeof clearTimeout!=="undefined")exports.clearTimeout=
function(){clearTimeout.apply(window,arguments)};if(typeof setInterval!=="undefined")exports.setInterval=function(){return setInterval.apply(window,arguments)};if(typeof clearInterval!=="undefined")exports.clearInterval=function(){clearInterval.apply(window,arguments)};exports.enroll=function(item,delay){item._timeoutID=setTimeout(item._onTimeout,delay)};exports.unenroll=function(item){clearTimeout(item._timeoutID)};exports.active=function(item){};exports.setImmediate=_dereq_("process/browser.js").nextTick},
{"process/browser.js":27}],27:[function(_dereq_,module,exports){module.exports=_dereq_(20)},{}],28:[function(_dereq_,module,exports){var punycode=_dereq_("punycode");exports.parse=urlParse;exports.resolve=urlResolve;exports.resolveObject=urlResolveObject;exports.format=urlFormat;exports.Url=Url;function Url(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=
null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={"javascript":true,"javascript:":true},hostlessProtocol={"javascript":true,"javascript:":true},slashedProtocol=
{"http":true,"https":true,"ftp":true,"gopher":true,"file":true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},querystring=_dereq_("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&isObject(url)&&url instanceof Url)return url;var u=new Url;u.parse(url,parseQueryString,slashesDenoteHost);return u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);
var rest=url;rest=rest.trim();var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto;rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes=rest.substr(0,2)==="//";if(slashes&&!(proto&&hostlessProtocol[proto])){rest=rest.substr(2);this.slashes=true}}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var hostEnd=-1;for(var i=0;i<hostEndingChars.length;i++){var hec=
rest.indexOf(hostEndingChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}var auth,atSign;if(hostEnd===-1)atSign=rest.lastIndexOf("@");else atSign=rest.lastIndexOf("@",hostEnd);if(atSign!==-1){auth=rest.slice(0,atSign);rest=rest.slice(atSign+1);this.auth=decodeURIComponent(auth)}hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}if(hostEnd===-1)hostEnd=rest.length;this.host=rest.slice(0,hostEnd);
rest=rest.slice(hostEnd);this.parseHost();this.hostname=this.hostname||"";var ipv6Hostname=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(var i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(!part)continue;if(!part.match(hostnamePartPattern)){var newpart="";for(var j=0,k=part.length;j<k;j++)if(part.charCodeAt(j)>127)newpart+="x";else newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,
i);var notHost=hostparts.slice(i+1);var bit=part.match(hostnamePartStart);if(bit){validParts.push(bit[1]);notHost.unshift(bit[2])}if(notHost.length)rest="/"+notHost.join(".")+rest;this.hostname=validParts.join(".");break}}}}if(this.hostname.length>hostnameMaxLen)this.hostname="";else this.hostname=this.hostname.toLowerCase();if(!ipv6Hostname){var domainArray=this.hostname.split(".");var newOut=[];for(var i=0;i<domainArray.length;++i){var s=domainArray[i];newOut.push(s.match(/[^A-Za-z0-9_-]/)?"xn--"+
punycode.encode(s):s)}this.hostname=newOut.join(".")}var p=this.port?":"+this.port:"";var h=this.hostname||"";this.host=h+p;this.href+=this.host;if(ipv6Hostname){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(rest[0]!=="/")rest="/"+rest}}if(!unsafeProtocol[lowerProto])for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];var esc=encodeURIComponent(ae);if(esc===ae)esc=escape(ae);rest=rest.split(ae).join(esc)}var hash=rest.indexOf("#");if(hash!==-1){this.hash=rest.substr(hash);
rest=rest.slice(0,hash)}var qm=rest.indexOf("?");if(qm!==-1){this.search=rest.substr(qm);this.query=rest.substr(qm+1);if(parseQueryString)this.query=querystring.parse(this.query);rest=rest.slice(0,qm)}else if(parseQueryString){this.search="";this.query={}}if(rest)this.pathname=rest;if(slashedProtocol[lowerProto]&&this.hostname&&!this.pathname)this.pathname="/";if(this.pathname||this.search){var p=this.pathname||"";var s=this.search||"";this.path=p+s}this.href=this.format();return this};function urlFormat(obj){if(isString(obj))obj=
urlParse(obj);if(!(obj instanceof Url))return Url.prototype.format.call(obj);return obj.format()}Url.prototype.format=function(){var auth=this.auth||"";if(auth){auth=encodeURIComponent(auth);auth=auth.replace(/%3A/i,":");auth+="@"}var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=false,query="";if(this.host)host=auth+this.host;else if(this.hostname){host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port)host+=":"+this.port}if(this.query&&
isObject(this.query)&&Object.keys(this.query).length)query=querystring.stringify(this.query);var search=this.search||query&&"?"+query||"";if(protocol&&protocol.substr(-1)!==":")protocol+=":";if(this.slashes||(!protocol||slashedProtocol[protocol])&&host!==false){host="//"+(host||"");if(pathname&&pathname.charAt(0)!=="/")pathname="/"+pathname}else if(!host)host="";if(hash&&hash.charAt(0)!=="#")hash="#"+hash;if(search&&search.charAt(0)!=="?")search="?"+search;pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)});
search=search.replace("#","%23");return protocol+host+pathname+search+hash};function urlResolve(source,relative){return urlParse(source,false,true).resolve(relative)}Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,false,true)).format()};function urlResolveObject(source,relative){if(!source)return relative;return urlParse(source,false,true).resolveObject(relative)}Url.prototype.resolveObject=function(relative){if(isString(relative)){var rel=new Url;rel.parse(relative,
false,true);relative=rel}var result=new Url;Object.keys(this).forEach(function(k){result[k]=this[k]},this);result.hash=relative.hash;if(relative.href===""){result.href=result.format();return result}if(relative.slashes&&!relative.protocol){Object.keys(relative).forEach(function(k){if(k!=="protocol")result[k]=relative[k]});if(slashedProtocol[result.protocol]&&result.hostname&&!result.pathname)result.path=result.pathname="/";result.href=result.format();return result}if(relative.protocol&&relative.protocol!==
result.protocol){if(!slashedProtocol[relative.protocol]){Object.keys(relative).forEach(function(k){result[k]=relative[k]});result.href=result.format();return result}result.protocol=relative.protocol;if(!relative.host&&!hostlessProtocol[relative.protocol]){var relPath=(relative.pathname||"").split("/");while(relPath.length&&!(relative.host=relPath.shift()));if(!relative.host)relative.host="";if(!relative.hostname)relative.hostname="";if(relPath[0]!=="")relPath.unshift("");if(relPath.length<2)relPath.unshift("");
result.pathname=relPath.join("/")}else result.pathname=relative.pathname;result.search=relative.search;result.query=relative.query;result.host=relative.host||"";result.auth=relative.auth;result.hostname=relative.hostname||relative.host;result.port=relative.port;if(result.pathname||result.search){var p=result.pathname||"";var s=result.search||"";result.path=p+s}result.slashes=result.slashes||relative.slashes;result.href=result.format();return result}var isSourceAbs=result.pathname&&result.pathname.charAt(0)===
"/",isRelAbs=relative.host||relative.pathname&&relative.pathname.charAt(0)==="/",mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic){result.hostname="";result.port=null;if(result.host)if(srcPath[0]==="")srcPath[0]=result.host;else srcPath.unshift(result.host);result.host=
"";if(relative.protocol){relative.hostname=null;relative.port=null;if(relative.host)if(relPath[0]==="")relPath[0]=relative.host;else relPath.unshift(relative.host);relative.host=null}mustEndAbs=mustEndAbs&&(relPath[0]===""||srcPath[0]==="")}if(isRelAbs){result.host=relative.host||relative.host===""?relative.host:result.host;result.hostname=relative.hostname||relative.hostname===""?relative.hostname:result.hostname;result.search=relative.search;result.query=relative.query;srcPath=relPath}else if(relPath.length){if(!srcPath)srcPath=
[];srcPath.pop();srcPath=srcPath.concat(relPath);result.search=relative.search;result.query=relative.query}else if(!isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}result.search=relative.search;result.query=relative.query;if(!isNull(result.pathname)||!isNull(result.search))result.path=
(result.pathname?result.pathname:"")+(result.search?result.search:"");result.href=result.format();return result}if(!srcPath.length){result.pathname=null;if(result.search)result.path="/"+result.search;else result.path=null;result.href=result.format();return result}var last=srcPath.slice(-1)[0];var hasTrailingSlash=(result.host||relative.host)&&(last==="."||last==="..")||last==="";var up=0;for(var i=srcPath.length;i>=0;i--){last=srcPath[i];if(last==".")srcPath.splice(i,1);else if(last===".."){srcPath.splice(i,
1);up++}else if(up){srcPath.splice(i,1);up--}}if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");if(mustEndAbs&&srcPath[0]!==""&&(!srcPath[0]||srcPath[0].charAt(0)!=="/"))srcPath.unshift("");if(hasTrailingSlash&&srcPath.join("/").substr(-1)!=="/")srcPath.push("");var isAbsolute=srcPath[0]===""||srcPath[0]&&srcPath[0].charAt(0)==="/";if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):
false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}mustEndAbs=mustEndAbs||result.host&&srcPath.length;if(mustEndAbs&&!isAbsolute)srcPath.unshift("");if(!srcPath.length){result.pathname=null;result.path=null}else result.pathname=srcPath.join("/");if(!isNull(result.pathname)||!isNull(result.search))result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"");result.auth=relative.auth||result.auth;result.slashes=result.slashes||relative.slashes;
result.href=result.format();return result};Url.prototype.parseHost=function(){var host=this.host;var port=portPattern.exec(host);if(port){port=port[0];if(port!==":")this.port=port.substr(1);host=host.substr(0,host.length-port.length)}if(host)this.hostname=host};function isString(arg){return typeof arg==="string"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isNull(arg){return arg===null}function isNullOrUndefined(arg){return arg==null}},{"punycode":14,"querystring":17}],
29:[function(_dereq_,module,exports){module.exports=function isBuffer(arg){return arg&&typeof arg==="object"&&typeof arg.copy==="function"&&typeof arg.fill==="function"&&typeof arg.readUInt8==="function"}},{}],30:[function(_dereq_,module,exports){(function(process,global){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}var i=1;var args=arguments;var len=args.length;
var str=String(f).replace(formatRegExp,function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case "%s":return String(args[i++]);case "%d":return Number(args[i++]);case "%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}});for(var x=args[i];i<len;x=args[++i])if(isNull(x)||!isObject(x))str+=" "+x;else str+=" "+inspect(x);return str};exports.deprecate=function(fn,msg){if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,
arguments)};if(process.noDeprecation===true)return fn;var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation)throw new Error(msg);else if(process.traceDeprecation)console.trace(msg);else console.error(msg);warned=true}return fn.apply(this,arguments)}return deprecated};var debugs={};var debugEnviron;exports.debuglog=function(set){if(isUndefined(debugEnviron))debugEnviron=process.env.NODE_DEBUG||"";set=set.toUpperCase();if(!debugs[set])if((new RegExp("\\b"+set+"\\b","i")).test(debugEnviron)){var pid=
process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts))ctx.showHidden=opts;else if(opts)exports._extend(ctx,opts);if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;
if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={"bold":[1,22],"italic":[3,23],"underline":[4,24],"inverse":[7,27],"white":[37,39],"grey":[90,39],"black":[30,39],"blue":[34,39],"cyan":[36,39],"green":[32,39],"magenta":[35,39],"red":[31,39],"yellow":[33,39]};inspect.styles={"special":"cyan","number":"yellow","boolean":"yellow",
"undefined":"grey","null":"bold","string":"green","date":"magenta","regexp":"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style)return"\u001b["+inspect.colors[style][0]+"m"+str+"\u001b["+inspect.colors[style][1]+"m";else return str}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};array.forEach(function(val,idx){hash[val]=true});return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&
value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret))ret=formatValue(ctx,ret,recurseTimes);return ret}var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden)keys=Object.getOwnPropertyNames(value);if(isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(keys.length===
0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value))base=
" "+RegExp.prototype.toString.call(value);if(isDate(value))base=" "+Date.prototype.toUTCString.call(value);if(isError(value))base=" "+formatError(value);if(keys.length===0&&(!array||value.length==0))return braces[0]+base+braces[1];if(recurseTimes<0)if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");else return ctx.stylize("[Object]","special");ctx.seen.push(value);var output;if(array)output=formatArray(ctx,value,recurseTimes,visibleKeys,keys);else output=keys.map(function(key){return formatProperty(ctx,
value,recurseTimes,visibleKeys,key,array)});ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null",
"null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i)if(hasOwnProperty(value,String(i)))output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true));else output.push("");keys.forEach(function(key){if(!key.match(/^\d+$/))output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))});return output}function formatProperty(ctx,value,
recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get)if(desc.set)str=ctx.stylize("[Getter/Setter]","special");else str=ctx.stylize("[Getter]","special");else if(desc.set)str=ctx.stylize("[Setter]","special");if(!hasOwnProperty(visibleKeys,key))name="["+key+"]";if(!str)if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes))str=formatValue(ctx,desc.value,null);else str=formatValue(ctx,desc.value,recurseTimes-1);if(str.indexOf("\n")>
-1)if(array)str=str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2);else str="\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")}else str=ctx.stylize("[Circular]","special");if(isUndefined(name)){if(array&&key.match(/^\d+$/))return str;name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,
"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce(function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(length>60)return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1];return braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg===
"boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;
function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;
function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=_dereq_("./support/isBuffer");function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=
[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=_dereq_("inherits");exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--)origin[keys[i]]=add[keys[i]];return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,
prop)}}).call(this,_dereq_("VCmEsw"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":29,"VCmEsw":13,"inherits":11}],31:[function(_dereq_,module,exports){},{}],32:[function(_dereq_,module,exports){(function(process,global,__dirname){(function(){var _nodejs=typeof process!=="undefined"&&process.versions&&process.versions.node;var _browser=!_nodejs&&(typeof window!=="undefined"||typeof self!=="undefined");if(_browser)if(typeof global==="undefined")if(typeof window!==
"undefined")global=window;else if(typeof self!=="undefined")global=self;else if(typeof $!=="undefined")global=$;var wrapper=function(jsonld){jsonld.compact=function(input,ctx,options,callback){if(arguments.length<2)return jsonld.nextTick(function(){callback(new TypeError("Could not compact, too few arguments."))});if(typeof options==="function"){callback=options;options={}}options=options||{};if(ctx===null)return jsonld.nextTick(function(){callback(new JsonLdError("The compaction context must not be null.",
"jsonld.CompactError",{code:"invalid local context"}))});if(input===null)return jsonld.nextTick(function(){callback(null,null)});if(!("base"in options))options.base=typeof input==="string"?input:"";if(!("compactArrays"in options))options.compactArrays=true;if(!("graph"in options))options.graph=false;if(!("skipExpansion"in options))options.skipExpansion=false;if(!("documentLoader"in options))options.documentLoader=jsonld.loadDocument;if(!("link"in options))options.link=false;if(options.link)options.skipExpansion=
true;var expand=function(input,options,callback){jsonld.nextTick(function(){if(options.skipExpansion)return callback(null,input);jsonld.expand(input,options,callback)})};expand(input,options,function(err,expanded){if(err)return callback(new JsonLdError("Could not expand input before compaction.","jsonld.CompactError",{cause:err}));var activeCtx=_getInitialContext(options);jsonld.processContext(activeCtx,ctx,options,function(err,activeCtx){if(err)return callback(new JsonLdError("Could not process context before compaction.",
"jsonld.CompactError",{cause:err}));var compacted;try{compacted=(new Processor).compact(activeCtx,null,expanded,options)}catch(ex){return callback(ex)}cleanup(null,compacted,activeCtx,options)})});function cleanup(err,compacted,activeCtx,options){if(err)return callback(err);if(options.compactArrays&&!options.graph&&_isArray(compacted))if(compacted.length===1)compacted=compacted[0];else{if(compacted.length===0)compacted={}}else if(options.graph&&_isObject(compacted))compacted=[compacted];if(_isObject(ctx)&&
"@context"in ctx)ctx=ctx["@context"];ctx=_clone(ctx);if(!_isArray(ctx))ctx=[ctx];var tmp=ctx;ctx=[];for(var i=0;i<tmp.length;++i)if(!_isObject(tmp[i])||Object.keys(tmp[i]).length>0)ctx.push(tmp[i]);var hasContext=ctx.length>0;if(ctx.length===1)ctx=ctx[0];if(_isArray(compacted)){var kwgraph=_compactIri(activeCtx,"@graph");var graph=compacted;compacted={};if(hasContext)compacted["@context"]=ctx;compacted[kwgraph]=graph}else if(_isObject(compacted)&&hasContext){var graph=compacted;compacted={"@context":ctx};
for(var key in graph)compacted[key]=graph[key]}callback(null,compacted,activeCtx)}};jsonld.expand=function(input,options,callback){if(arguments.length<1)return jsonld.nextTick(function(){callback(new TypeError("Could not expand, too few arguments."))});if(typeof options==="function"){callback=options;options={}}options=options||{};if(!("documentLoader"in options))options.documentLoader=jsonld.loadDocument;if(!("keepFreeFloatingNodes"in options))options.keepFreeFloatingNodes=false;jsonld.nextTick(function(){if(typeof input===
"string"){var done=function(err,remoteDoc){if(err)return callback(err);try{if(!remoteDoc.document)throw new JsonLdError("No remote document found at the given URL.","jsonld.NullRemoteDocument");if(typeof remoteDoc.document==="string")remoteDoc.document=JSON.parse(remoteDoc.document)}catch(ex){return callback(new JsonLdError("Could not retrieve a JSON-LD document from the URL. URL "+"dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:ex,remoteDoc:remoteDoc}))}expand(remoteDoc)};
var promise=options.documentLoader(input,done);if(promise&&"then"in promise)promise.then(done.bind(null,null),done);return}expand({contextUrl:null,documentUrl:null,document:input})});function expand(remoteDoc){if(!("base"in options))options.base=remoteDoc.documentUrl||"";var input={document:_clone(remoteDoc.document),remoteContext:{"@context":remoteDoc.contextUrl}};if("expandContext"in options){var expandContext=_clone(options.expandContext);if(typeof expandContext==="object"&&"@context"in expandContext)input.expandContext=
expandContext;else input.expandContext={"@context":expandContext}}_retrieveContextUrls(input,options,function(err,input){if(err)return callback(err);var expanded;try{var processor=new Processor;var activeCtx=_getInitialContext(options);var document=input.document;var remoteContext=input.remoteContext["@context"];if(input.expandContext)activeCtx=processor.processContext(activeCtx,input.expandContext["@context"],options);if(remoteContext)activeCtx=processor.processContext(activeCtx,remoteContext,options);
expanded=processor.expand(activeCtx,null,document,options,false);if(_isObject(expanded)&&"@graph"in expanded&&Object.keys(expanded).length===1)expanded=expanded["@graph"];else if(expanded===null)expanded=[];if(!_isArray(expanded))expanded=[expanded]}catch(ex){return callback(ex)}callback(null,expanded)})}};jsonld.flatten=function(input,ctx,options,callback){if(arguments.length<1)return jsonld.nextTick(function(){callback(new TypeError("Could not flatten, too few arguments."))});if(typeof options===
"function"){callback=options;options={}}else if(typeof ctx==="function"){callback=ctx;ctx=null;options={}}options=options||{};if(!("base"in options))options.base=typeof input==="string"?input:"";if(!("documentLoader"in options))options.documentLoader=jsonld.loadDocument;jsonld.expand(input,options,function(err,_input){if(err)return callback(new JsonLdError("Could not expand input before flattening.","jsonld.FlattenError",{cause:err}));var flattened;try{flattened=(new Processor).flatten(_input)}catch(ex){return callback(ex)}if(ctx===
null)return callback(null,flattened);options.graph=true;options.skipExpansion=true;jsonld.compact(flattened,ctx,options,function(err,compacted){if(err)return callback(new JsonLdError("Could not compact flattened output.","jsonld.FlattenError",{cause:err}));callback(null,compacted)})})};jsonld.frame=function(input,frame,options,callback){if(arguments.length<2)return jsonld.nextTick(function(){callback(new TypeError("Could not frame, too few arguments."))});if(typeof options==="function"){callback=
options;options={}}options=options||{};if(!("base"in options))options.base=typeof input==="string"?input:"";if(!("documentLoader"in options))options.documentLoader=jsonld.loadDocument;if(!("embed"in options))options.embed="@last";options.explicit=options.explicit||false;if(!("requireAll"in options))options.requireAll=true;options.omitDefault=options.omitDefault||false;jsonld.nextTick(function(){if(typeof frame==="string"){var done=function(err,remoteDoc){if(err)return callback(err);try{if(!remoteDoc.document)throw new JsonLdError("No remote document found at the given URL.",
"jsonld.NullRemoteDocument");if(typeof remoteDoc.document==="string")remoteDoc.document=JSON.parse(remoteDoc.document)}catch(ex){return callback(new JsonLdError("Could not retrieve a JSON-LD document from the URL. URL "+"dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:ex,remoteDoc:remoteDoc}))}doFrame(remoteDoc)};var promise=options.documentLoader(frame,done);if(promise&&"then"in promise)promise.then(done.bind(null,null),done);return}doFrame({contextUrl:null,
documentUrl:null,document:frame})});function doFrame(remoteFrame){var frame=remoteFrame.document;var ctx;if(frame){ctx=frame["@context"];if(remoteFrame.contextUrl){if(!ctx)ctx=remoteFrame.contextUrl;else if(_isArray(ctx))ctx.push(remoteFrame.contextUrl);else ctx=[ctx,remoteFrame.contextUrl];frame["@context"]=ctx}else ctx=ctx||{}}else ctx={};jsonld.expand(input,options,function(err,expanded){if(err)return callback(new JsonLdError("Could not expand input before framing.","jsonld.FrameError",{cause:err}));
var opts=_clone(options);opts.isFrame=true;opts.keepFreeFloatingNodes=true;jsonld.expand(frame,opts,function(err,expandedFrame){if(err)return callback(new JsonLdError("Could not expand frame before framing.","jsonld.FrameError",{cause:err}));var framed;try{framed=(new Processor).frame(expanded,expandedFrame,opts)}catch(ex){return callback(ex)}opts.graph=true;opts.skipExpansion=true;opts.link={};jsonld.compact(framed,ctx,opts,function(err,compacted,ctx){if(err)return callback(new JsonLdError("Could not compact framed output.",
"jsonld.FrameError",{cause:err}));var graph=_compactIri(ctx,"@graph");opts.link={};compacted[graph]=_removePreserve(ctx,compacted[graph],opts);callback(null,compacted)})})})}};jsonld.link=function(input,ctx,options,callback){var frame={};if(ctx)frame["@context"]=ctx;frame["@embed"]="@link";jsonld.frame(input,frame,options,callback)};jsonld.objectify=function(input,ctx,options,callback){if(typeof options==="function"){callback=options;options={}}options=options||{};if(!("base"in options))options.base=
typeof input==="string"?input:"";if(!("documentLoader"in options))options.documentLoader=jsonld.loadDocument;jsonld.expand(input,options,function(err,_input){if(err)return callback(new JsonLdError("Could not expand input before linking.","jsonld.LinkError",{cause:err}));var flattened;try{flattened=(new Processor).flatten(_input)}catch(ex){return callback(ex)}options.graph=true;options.skipExpansion=true;jsonld.compact(flattened,ctx,options,function(err,compacted,ctx){if(err)return callback(new JsonLdError("Could not compact flattened output before linking.",
"jsonld.LinkError",{cause:err}));var graph=_compactIri(ctx,"@graph");var top=compacted[graph][0];var recurse=function(subject){if(!_isObject(subject)&&!_isArray(subject))return;if(_isObject(subject)){if(recurse.visited[subject["@id"]])return;recurse.visited[subject["@id"]]=true}for(var k in subject){var obj=subject[k];var isid=jsonld.getContextValue(ctx,k,"@type")==="@id";if(!_isArray(obj)&&!_isObject(obj)&&!isid)continue;if(_isString(obj)&&isid){subject[k]=obj=top[obj];recurse(obj)}else if(_isArray(obj))for(var i=
0;i<obj.length;++i){if(_isString(obj[i])&&isid)obj[i]=top[obj[i]];else if(_isObject(obj[i])&&"@id"in obj[i])obj[i]=top[obj[i]["@id"]];recurse(obj[i])}else if(_isObject(obj)){var sid=obj["@id"];subject[k]=obj=top[sid];recurse(obj)}}};recurse.visited={};recurse(top);compacted.of_type={};for(var s in top){if(!("@type"in top[s]))continue;var types=top[s]["@type"];if(!_isArray(types))types=[types];for(var t=0;t<types.length;++t){if(!(types[t]in compacted.of_type))compacted.of_type[types[t]]=[];compacted.of_type[types[t]].push(top[s])}}callback(null,
compacted)})})};jsonld.normalize=function(input,options,callback){if(arguments.length<1)return jsonld.nextTick(function(){callback(new TypeError("Could not normalize, too few arguments."))});if(typeof options==="function"){callback=options;options={}}options=options||{};if(!("base"in options))options.base=typeof input==="string"?input:"";if(!("documentLoader"in options))options.documentLoader=jsonld.loadDocument;var opts=_clone(options);delete opts.format;opts.produceGeneralizedRdf=false;jsonld.toRDF(input,
opts,function(err,dataset){if(err)return callback(new JsonLdError("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:err}));(new Processor).normalize(dataset,options,callback)})};jsonld.fromRDF=function(dataset,options,callback){if(arguments.length<1)return jsonld.nextTick(function(){callback(new TypeError("Could not convert from RDF, too few arguments."))});if(typeof options==="function"){callback=options;options={}}options=options||{};if(!("useRdfType"in
options))options.useRdfType=false;if(!("useNativeTypes"in options))options.useNativeTypes=false;if(!("format"in options)&&_isString(dataset))if(!("format"in options))options.format="application/nquads";jsonld.nextTick(function(){var rdfParser;if(options.format){rdfParser=options.rdfParser||_rdfParsers[options.format];if(!rdfParser)return callback(new JsonLdError("Unknown input format.","jsonld.UnknownFormat",{format:options.format}))}else rdfParser=function(){return dataset};var callbackCalled=false;
try{dataset=rdfParser(dataset,function(err,dataset){callbackCalled=true;if(err)return callback(err);fromRDF(dataset,options,callback)})}catch(e){if(!callbackCalled)return callback(e);throw e;}if(dataset){if("then"in dataset)return dataset.then(function(dataset){fromRDF(dataset,options,callback)},callback);fromRDF(dataset,options,callback)}function fromRDF(dataset,options,callback){(new Processor).fromRDF(dataset,options,callback)}})};jsonld.toRDF=function(input,options,callback){if(arguments.length<
1)return jsonld.nextTick(function(){callback(new TypeError("Could not convert to RDF, too few arguments."))});if(typeof options==="function"){callback=options;options={}}options=options||{};if(!("base"in options))options.base=typeof input==="string"?input:"";if(!("documentLoader"in options))options.documentLoader=jsonld.loadDocument;jsonld.expand(input,options,function(err,expanded){if(err)return callback(new JsonLdError("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:err}));
var dataset;try{dataset=Processor.prototype.toRDF(expanded,options);if(options.format){if(options.format==="application/nquads")return callback(null,_toNQuads(dataset));throw new JsonLdError("Unknown output format.","jsonld.UnknownFormat",{format:options.format});}}catch(ex){return callback(ex)}callback(null,dataset)})};jsonld.createNodeMap=function(input,options,callback){if(arguments.length<1)return jsonld.nextTick(function(){callback(new TypeError("Could not create node map, too few arguments."))});
if(typeof options==="function"){callback=options;options={}}options=options||{};if(!("base"in options))options.base=typeof input==="string"?input:"";if(!("documentLoader"in options))options.documentLoader=jsonld.loadDocument;jsonld.expand(input,options,function(err,_input){if(err)return callback(new JsonLdError("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:err}));var nodeMap;try{nodeMap=(new Processor).createNodeMap(_input,options)}catch(ex){return callback(ex)}callback(null,
nodeMap)})};jsonld.merge=function(docs,ctx,options,callback){if(arguments.length<1)return jsonld.nextTick(function(){callback(new TypeError("Could not merge, too few arguments."))});if(!_isArray(docs))return jsonld.nextTick(function(){callback(new TypeError('Could not merge, "docs" must be an array.'))});if(typeof options==="function"){callback=options;options={}}else if(typeof ctx==="function"){callback=ctx;ctx=null;options={}}options=options||{};var expanded=[];var error=null;var count=docs.length;
for(var i=0;i<docs.length;++i){var opts={};for(var key in options)opts[key]=options[key];jsonld.expand(docs[i],opts,expandComplete)}function expandComplete(err,_input){if(error)return;if(err){error=err;return callback(new JsonLdError("Could not expand input before flattening.","jsonld.FlattenError",{cause:err}))}expanded.push(_input);if(--count===0)merge(expanded)}function merge(expanded){var mergeNodes=true;if("mergeNodes"in options)mergeNodes=options.mergeNodes;var namer=options.namer||new UniqueNamer("_:b");
var graphs={"@default":{}};var defaultGraph;try{for(var i=0;i<expanded.length;++i){var doc=expanded[i];doc=jsonld.relabelBlankNodes(doc,{namer:new UniqueNamer("_:b"+i+"-")});var _graphs=mergeNodes||i===0?graphs:{"@default":{}};_createNodeMap(doc,_graphs,"@default",namer);if(_graphs!==graphs)for(var graphName in _graphs){var _nodeMap=_graphs[graphName];if(!(graphName in graphs)){graphs[graphName]=_nodeMap;continue}var nodeMap=graphs[graphName];for(var key in _nodeMap)if(!(key in nodeMap))nodeMap[key]=
_nodeMap[key]}}defaultGraph=_mergeNodeMaps(graphs)}catch(ex){return callback(ex)}var flattened=[];var keys=Object.keys(defaultGraph).sort();for(var ki=0;ki<keys.length;++ki){var node=defaultGraph[keys[ki]];if(!_isSubjectReference(node))flattened.push(node)}if(ctx===null)return callback(null,flattened);options.graph=true;options.skipExpansion=true;jsonld.compact(flattened,ctx,options,function(err,compacted){if(err)return callback(new JsonLdError("Could not compact merged output.","jsonld.MergeError",
{cause:err}));callback(null,compacted)})}};jsonld.relabelBlankNodes=function(input,options){options=options||{};var namer=options.namer||new UniqueNamer("_:b");return _labelBlankNodes(namer,input)};jsonld.documentLoader=function(url,callback){var err=new JsonLdError("Could not retrieve a JSON-LD document from the URL. URL "+"dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});if(_nodejs)return callback(err,{contextUrl:null,documentUrl:url,document:null});return jsonld.promisify(function(callback){callback(err)})};
jsonld.loadDocument=function(url,callback){var promise=jsonld.documentLoader(url,callback);if(promise&&"then"in promise)promise.then(callback.bind(null,null),callback)};jsonld.promises=function(options){options=options||{};var slice=Array.prototype.slice;var promisify=jsonld.promisify;var api=options.api||{};var version=options.version||"jsonld.js";if(typeof options.api==="string"){if(!options.version)version=options.api;api={}}api.expand=function(input){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");
return promisify.apply(null,[jsonld.expand].concat(slice.call(arguments)))};api.compact=function(input,ctx){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");var compact=function(input,ctx,options,callback){jsonld.compact(input,ctx,options,function(err,compacted){callback(err,compacted)})};return promisify.apply(null,[compact].concat(slice.call(arguments)))};api.flatten=function(input){if(arguments.length<1)throw new TypeError("Could not flatten, too few arguments.");
return promisify.apply(null,[jsonld.flatten].concat(slice.call(arguments)))};api.frame=function(input,frame){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");return promisify.apply(null,[jsonld.frame].concat(slice.call(arguments)))};api.fromRDF=function(dataset){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");return promisify.apply(null,[jsonld.fromRDF].concat(slice.call(arguments)))};api.toRDF=function(input){if(arguments.length<
1)throw new TypeError("Could not convert to RDF, too few arguments.");return promisify.apply(null,[jsonld.toRDF].concat(slice.call(arguments)))};api.normalize=function(input){if(arguments.length<1)throw new TypeError("Could not normalize, too few arguments.");return promisify.apply(null,[jsonld.normalize].concat(slice.call(arguments)))};if(version==="jsonld.js"){api.link=function(input,ctx){if(arguments.length<2)throw new TypeError("Could not link, too few arguments.");return promisify.apply(null,
[jsonld.link].concat(slice.call(arguments)))};api.objectify=function(input){return promisify.apply(null,[jsonld.objectify].concat(slice.call(arguments)))};api.createNodeMap=function(input){return promisify.apply(null,[jsonld.createNodeMap].concat(slice.call(arguments)))};api.merge=function(input){return promisify.apply(null,[jsonld.merge].concat(slice.call(arguments)))}}try{jsonld.Promise=global.Promise||_dereq_("es6-promise").Promise}catch(e){var f=function(){throw new Error("Unable to find a Promise implementation.");
};for(var method in api)api[method]=f}return api};jsonld.promisify=function(op){if(!jsonld.Promise)try{jsonld.Promise=global.Promise||_dereq_("es6-promise").Promise}catch(e){throw new Error("Unable to find a Promise implementation.");}var args=Array.prototype.slice.call(arguments,1);return new jsonld.Promise(function(resolve,reject){op.apply(null,args.concat(function(err,value){if(!err)resolve(value);else reject(err)}))})};jsonld.promises({api:jsonld.promises});function JsonLdProcessor(){}JsonLdProcessor.prototype=
jsonld.promises({version:"json-ld-1.0"});JsonLdProcessor.prototype.toString=function(){if(this instanceof JsonLdProcessor)return"[object JsonLdProcessor]";return"[object JsonLdProcessorPrototype]"};jsonld.JsonLdProcessor=JsonLdProcessor;var canDefineProperty=!!Object.defineProperty;if(canDefineProperty)try{Object.defineProperty({},"x",{})}catch(e){canDefineProperty=false}if(canDefineProperty){Object.defineProperty(JsonLdProcessor,"prototype",{writable:false,enumerable:false});Object.defineProperty(JsonLdProcessor.prototype,
"constructor",{writable:true,enumerable:false,configurable:true,value:JsonLdProcessor})}if(_browser&&typeof global.JsonLdProcessor==="undefined")if(canDefineProperty)Object.defineProperty(global,"JsonLdProcessor",{writable:true,enumerable:false,configurable:true,value:JsonLdProcessor});else global.JsonLdProcessor=JsonLdProcessor;var _setImmediate=typeof setImmediate==="function"&&setImmediate;var _delay=_setImmediate?function(fn){_setImmediate(fn)}:function(fn){setTimeout(fn,0)};if(typeof process===
"object"&&typeof process.nextTick==="function")jsonld.nextTick=process.nextTick;else jsonld.nextTick=_delay;jsonld.setImmediate=_setImmediate?_delay:jsonld.nextTick;jsonld.parseLinkHeader=function(header){var rval={};var entries=header.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g);var rLinkHeader=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/;for(var i=0;i<entries.length;++i){var match=entries[i].match(rLinkHeader);if(!match)continue;var result={target:match[1]};var params=match[2];var rParams=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;
while(match=rParams.exec(params))result[match[1]]=match[2]===undefined?match[3]:match[2];var rel=result["rel"]||"";if(_isArray(rval[rel]))rval[rel].push(result);else if(rel in rval)rval[rel]=[rval[rel],result];else rval[rel]=result}return rval};jsonld.DocumentCache=function(size){this.order=[];this.cache={};this.size=size||50;this.expires=30*1E3};jsonld.DocumentCache.prototype.get=function(url){if(url in this.cache){var entry=this.cache[url];if(entry.expires>=+new Date)return entry.ctx;delete this.cache[url];
this.order.splice(this.order.indexOf(url),1)}return null};jsonld.DocumentCache.prototype.set=function(url,ctx){if(this.order.length===this.size)delete this.cache[this.order.shift()];this.order.push(url);this.cache[url]={ctx:ctx,expires:+new Date+this.expires}};jsonld.ActiveContextCache=function(size){this.order=[];this.cache={};this.size=size||100};jsonld.ActiveContextCache.prototype.get=function(activeCtx,localCtx){var key1=JSON.stringify(activeCtx);var key2=JSON.stringify(localCtx);var level1=this.cache[key1];
if(level1&&key2 in level1)return level1[key2];return null};jsonld.ActiveContextCache.prototype.set=function(activeCtx,localCtx,result){if(this.order.length===this.size){var entry=this.order.shift();delete this.cache[entry.activeCtx][entry.localCtx]}var key1=JSON.stringify(activeCtx);var key2=JSON.stringify(localCtx);this.order.push({activeCtx:key1,localCtx:key2});if(!(key1 in this.cache))this.cache[key1]={};this.cache[key1][key2]=_clone(result)};jsonld.cache={activeCtx:new jsonld.ActiveContextCache};
jsonld.documentLoaders={};jsonld.documentLoaders.jquery=function($,options){options=options||{};var loader=function(url,callback){if(url.indexOf("http:")!==0&&url.indexOf("https:")!==0)return callback(new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are '+"supported.","jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});if(options.secure&&url.indexOf("https")!==0)return callback(new JsonLdError("URL could not be dereferenced; secure mode is enabled and "+
'the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});$.ajax({url:url,accepts:{json:"application/ld+json, application/json"},headers:{"Accept":"application/ld+json, application/json"},dataType:"json",crossDomain:true,success:function(data,textStatus,jqXHR){var doc={contextUrl:null,documentUrl:url,document:data};var contentType=jqXHR.getResponseHeader("Content-Type");var linkHeader=jqXHR.getResponseHeader("Link");
if(linkHeader&&contentType!=="application/ld+json"){linkHeader=jsonld.parseLinkHeader(linkHeader)[LINK_HEADER_REL];if(_isArray(linkHeader))return callback(new JsonLdError("URL could not be dereferenced, it has more than one "+"associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:url}),doc);if(linkHeader)doc.contextUrl=linkHeader.target}callback(null,doc)},error:function(jqXHR,textStatus,err){callback(new JsonLdError("URL could not be dereferenced, an error occurred.",
"jsonld.LoadDocumentError",{code:"loading document failed",url:url,cause:err}),{contextUrl:null,documentUrl:url,document:null})}})};var usePromise=typeof Promise!=="undefined";if("usePromise"in options)usePromise=options.usePromise;if(usePromise)return function(url){return jsonld.promisify(loader,url)};return loader};jsonld.documentLoaders.node=function(options){options=options||{};var strictSSL="strictSSL"in options?options.strictSSL:true;var maxRedirects="maxRedirects"in options?options.maxRedirects:
-1;var request=_dereq_("request");var http=_dereq_("http");var cache=new jsonld.DocumentCache;function loadDocument(url,redirects,callback){if(url.indexOf("http:")!==0&&url.indexOf("https:")!==0)return callback(new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are '+"supported.","jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});if(options.secure&&url.indexOf("https")!==0)return callback(new JsonLdError("URL could not be dereferenced; secure mode is enabled and "+
'the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});var doc=cache.get(url);if(doc!==null)return callback(null,doc);request({url:url,headers:{"Accept":"application/ld+json, application/json"},strictSSL:strictSSL,followRedirect:false},handleResponse);function handleResponse(err,res,body){doc={contextUrl:null,documentUrl:url,document:body||null};if(err)return callback(new JsonLdError("URL could not be dereferenced, an error occurred.",
"jsonld.LoadDocumentError",{code:"loading document failed",url:url,cause:err}),doc);var statusText=http.STATUS_CODES[res.statusCode];if(res.statusCode>=400)return callback(new JsonLdError("URL could not be dereferenced: "+statusText,"jsonld.InvalidUrl",{code:"loading document failed",url:url,httpStatusCode:res.statusCode}),doc);if(res.headers.link&&res.headers["content-type"]!=="application/ld+json"){var linkHeader=jsonld.parseLinkHeader(res.headers.link)[LINK_HEADER_REL];if(_isArray(linkHeader))return callback(new JsonLdError("URL could not be dereferenced, it has more than one associated "+
"HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:url}),doc);if(linkHeader)doc.contextUrl=linkHeader.target}if(res.statusCode>=300&&res.statusCode<400&&res.headers.location){if(redirects.length===maxRedirects)return callback(new JsonLdError("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:url,httpStatusCode:res.statusCode,redirects:redirects}),doc);if(redirects.indexOf(url)!==-1)return callback(new JsonLdError("URL could not be dereferenced; infinite redirection was detected.",
"jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:url,httpStatusCode:res.statusCode,redirects:redirects}),doc);redirects.push(url);return loadDocument(res.headers.location,redirects,callback)}redirects.push(url);for(var i=0;i<redirects.length;++i)cache.set(redirects[i],{contextUrl:null,documentUrl:redirects[i],document:body});callback(err,doc)}}var loader=function(url,callback){loadDocument(url,[],callback)};if(options.usePromise)return function(url){return jsonld.promisify(loader,
url)};return loader};jsonld.documentLoaders.xhr=function(options){var rlink=/(^|(\r\n))link:/i;options=options||{};var loader=function(url,callback){if(url.indexOf("http:")!==0&&url.indexOf("https:")!==0)return callback(new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are '+"supported.","jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});if(options.secure&&url.indexOf("https")!==0)return callback(new JsonLdError("URL could not be dereferenced; secure mode is enabled and "+
'the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});var xhr=options.xhr||XMLHttpRequest;var req=new xhr;req.onload=function(e){if(req.status>=400)return callback(new JsonLdError("URL could not be dereferenced: "+req.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:url,httpStatusCode:req.status}),{contextUrl:null,documentUrl:url,document:null});var doc={contextUrl:null,documentUrl:url,
document:req.response};var contentType=req.getResponseHeader("Content-Type");var linkHeader;if(rlink.test(req.getAllResponseHeaders()))linkHeader=req.getResponseHeader("Link");if(linkHeader&&contentType!=="application/ld+json"){linkHeader=jsonld.parseLinkHeader(linkHeader)[LINK_HEADER_REL];if(_isArray(linkHeader))return callback(new JsonLdError("URL could not be dereferenced, it has more than one "+"associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:url}),
doc);if(linkHeader)doc.contextUrl=linkHeader.target}callback(null,doc)};req.onerror=function(){callback(new JsonLdError("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null})};req.open("GET",url,true);req.setRequestHeader("Accept","application/ld+json, application/json");req.send()};var usePromise=typeof Promise!=="undefined";if("usePromise"in options)usePromise=options.usePromise;if(usePromise)return function(url){return jsonld.promisify(loader,
url)};return loader};jsonld.useDocumentLoader=function(type){if(!(type in jsonld.documentLoaders))throw new JsonLdError('Unknown document loader type: "'+type+'"',"jsonld.UnknownDocumentLoader",{type:type});jsonld.documentLoader=jsonld.documentLoaders[type].apply(jsonld,Array.prototype.slice.call(arguments,1))};jsonld.processContext=function(activeCtx,localCtx){var options={};var callbackArg=2;if(arguments.length>3){options=arguments[2]||{};callbackArg+=1}var callback=arguments[callbackArg];if(!("base"in
options))options.base="";if(!("documentLoader"in options))options.documentLoader=jsonld.loadDocument;if(localCtx===null)return callback(null,_getInitialContext(options));localCtx=_clone(localCtx);if(!(_isObject(localCtx)&&"@context"in localCtx))localCtx={"@context":localCtx};_retrieveContextUrls(localCtx,options,function(err,ctx){if(err)return callback(err);try{ctx=(new Processor).processContext(activeCtx,ctx,options)}catch(ex){return callback(ex)}callback(null,ctx)})};jsonld.hasProperty=function(subject,
property){var rval=false;if(property in subject){var value=subject[property];rval=!_isArray(value)||value.length>0}return rval};jsonld.hasValue=function(subject,property,value){var rval=false;if(jsonld.hasProperty(subject,property)){var val=subject[property];var isList=_isList(val);if(_isArray(val)||isList){if(isList)val=val["@list"];for(var i=0;i<val.length;++i)if(jsonld.compareValues(value,val[i])){rval=true;break}}else if(!_isArray(value))rval=jsonld.compareValues(value,val)}return rval};jsonld.addValue=
function(subject,property,value,options){options=options||{};if(!("propertyIsArray"in options))options.propertyIsArray=false;if(!("allowDuplicate"in options))options.allowDuplicate=true;if(_isArray(value)){if(value.length===0&&options.propertyIsArray&&!(property in subject))subject[property]=[];for(var i=0;i<value.length;++i)jsonld.addValue(subject,property,value[i],options)}else if(property in subject){var hasValue=!options.allowDuplicate&&jsonld.hasValue(subject,property,value);if(!_isArray(subject[property])&&
(!hasValue||options.propertyIsArray))subject[property]=[subject[property]];if(!hasValue)subject[property].push(value)}else subject[property]=options.propertyIsArray?[value]:value};jsonld.getValues=function(subject,property){var rval=subject[property]||[];if(!_isArray(rval))rval=[rval];return rval};jsonld.removeProperty=function(subject,property){delete subject[property]};jsonld.removeValue=function(subject,property,value,options){options=options||{};if(!("propertyIsArray"in options))options.propertyIsArray=
false;var values=jsonld.getValues(subject,property).filter(function(e){return!jsonld.compareValues(e,value)});if(values.length===0)jsonld.removeProperty(subject,property);else if(values.length===1&&!options.propertyIsArray)subject[property]=values[0];else subject[property]=values};jsonld.compareValues=function(v1,v2){if(v1===v2)return true;if(_isValue(v1)&&_isValue(v2)&&v1["@value"]===v2["@value"]&&v1["@type"]===v2["@type"]&&v1["@language"]===v2["@language"]&&v1["@index"]===v2["@index"])return true;
if(_isObject(v1)&&"@id"in v1&&_isObject(v2)&&"@id"in v2)return v1["@id"]===v2["@id"];return false};jsonld.getContextValue=function(ctx,key,type){var rval=null;if(key===null)return rval;if(type==="@language"&&type in ctx)rval=ctx[type];if(ctx.mappings[key]){var entry=ctx.mappings[key];if(_isUndefined(type))rval=entry;else if(type in entry)rval=entry[type]}return rval};var _rdfParsers={};jsonld.registerRDFParser=function(contentType,parser){_rdfParsers[contentType]=parser};jsonld.unregisterRDFParser=
function(contentType){delete _rdfParsers[contentType]};if(_nodejs){if(typeof XMLSerializer==="undefined")var XMLSerializer=null;if(typeof Node==="undefined")var Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var XSD_BOOLEAN="http://www.w3.org/2001/XMLSchema#boolean";var XSD_DOUBLE="http://www.w3.org/2001/XMLSchema#double";
var XSD_INTEGER="http://www.w3.org/2001/XMLSchema#integer";var XSD_STRING="http://www.w3.org/2001/XMLSchema#string";var RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#";var RDF_LIST=RDF+"List";var RDF_FIRST=RDF+"first";var RDF_REST=RDF+"rest";var RDF_NIL=RDF+"nil";var RDF_TYPE=RDF+"type";var RDF_PLAIN_LITERAL=RDF+"PlainLiteral";var RDF_XML_LITERAL=RDF+"XMLLiteral";var RDF_OBJECT=RDF+"object";var RDF_LANGSTRING=RDF+"langString";var LINK_HEADER_REL="http://www.w3.org/ns/json-ld#context";var MAX_CONTEXT_URLS=
10;var JsonLdError=function(msg,type,details){if(_nodejs){Error.call(this);Error.captureStackTrace(this,this.constructor)}else if(typeof Error!=="undefined")this.stack=(new Error).stack;this.name=type||"jsonld.Error";this.message=msg||"An unspecified JSON-LD error occurred.";this.details=details||{}};if(_nodejs)_dereq_("util").inherits(JsonLdError,Error);else if(typeof Error!=="undefined")JsonLdError.prototype=new Error;var Processor=function(){};Processor.prototype.compact=function(activeCtx,activeProperty,
element,options){if(_isArray(element)){var rval=[];for(var i=0;i<element.length;++i){var compacted=this.compact(activeCtx,activeProperty,element[i],options);if(compacted!==null)rval.push(compacted)}if(options.compactArrays&&rval.length===1){var container=jsonld.getContextValue(activeCtx,activeProperty,"@container");if(container===null)rval=rval[0]}return rval}if(_isObject(element)){if(options.link&&"@id"in element&&element["@id"]in options.link){var linked=options.link[element["@id"]];for(var i=0;i<
linked.length;++i)if(linked[i].expanded===element)return linked[i].compacted}if(_isValue(element)||_isSubjectReference(element)){var rval=_compactValue(activeCtx,activeProperty,element);if(options.link&&_isSubjectReference(element)){if(!(element["@id"]in options.link))options.link[element["@id"]]=[];options.link[element["@id"]].push({expanded:element,compacted:rval})}return rval}var insideReverse=activeProperty==="@reverse";var rval={};if(options.link&&"@id"in element){if(!(element["@id"]in options.link))options.link[element["@id"]]=
[];options.link[element["@id"]].push({expanded:element,compacted:rval})}var keys=Object.keys(element).sort();for(var ki=0;ki<keys.length;++ki){var expandedProperty=keys[ki];var expandedValue=element[expandedProperty];if(expandedProperty==="@id"||expandedProperty==="@type"){var compactedValue;if(_isString(expandedValue))compactedValue=_compactIri(activeCtx,expandedValue,null,{vocab:expandedProperty==="@type"});else{compactedValue=[];for(var vi=0;vi<expandedValue.length;++vi)compactedValue.push(_compactIri(activeCtx,
expandedValue[vi],null,{vocab:true}))}var alias=_compactIri(activeCtx,expandedProperty);var isArray=_isArray(compactedValue)&&expandedValue.length===0;jsonld.addValue(rval,alias,compactedValue,{propertyIsArray:isArray});continue}if(expandedProperty==="@reverse"){var compactedValue=this.compact(activeCtx,"@reverse",expandedValue,options);for(var compactedProperty in compactedValue)if(activeCtx.mappings[compactedProperty]&&activeCtx.mappings[compactedProperty].reverse){var value=compactedValue[compactedProperty];
var container=jsonld.getContextValue(activeCtx,compactedProperty,"@container");var useArray=container==="@set"||!options.compactArrays;jsonld.addValue(rval,compactedProperty,value,{propertyIsArray:useArray});delete compactedValue[compactedProperty]}if(Object.keys(compactedValue).length>0){var alias=_compactIri(activeCtx,expandedProperty);jsonld.addValue(rval,alias,compactedValue)}continue}if(expandedProperty==="@index"){var container=jsonld.getContextValue(activeCtx,activeProperty,"@container");if(container===
"@index")continue;var alias=_compactIri(activeCtx,expandedProperty);jsonld.addValue(rval,alias,expandedValue);continue}if(expandedProperty!=="@graph"&&expandedProperty!=="@list"&&_isKeyword(expandedProperty)){var alias=_compactIri(activeCtx,expandedProperty);jsonld.addValue(rval,alias,expandedValue);continue}if(expandedValue.length===0){var itemActiveProperty=_compactIri(activeCtx,expandedProperty,expandedValue,{vocab:true},insideReverse);jsonld.addValue(rval,itemActiveProperty,expandedValue,{propertyIsArray:true})}for(var vi=
0;vi<expandedValue.length;++vi){var expandedItem=expandedValue[vi];var itemActiveProperty=_compactIri(activeCtx,expandedProperty,expandedItem,{vocab:true},insideReverse);var container=jsonld.getContextValue(activeCtx,itemActiveProperty,"@container");var isList=_isList(expandedItem);var list=null;if(isList)list=expandedItem["@list"];var compactedItem=this.compact(activeCtx,itemActiveProperty,isList?list:expandedItem,options);if(isList){if(!_isArray(compactedItem))compactedItem=[compactedItem];if(container!==
"@list"){var wrapper={};wrapper[_compactIri(activeCtx,"@list")]=compactedItem;compactedItem=wrapper;if("@index"in expandedItem)compactedItem[_compactIri(activeCtx,"@index")]=expandedItem["@index"]}else if(itemActiveProperty in rval)throw new JsonLdError('JSON-LD compact error; property has a "@list" @container '+"rule but there is more than a single @list that matches "+"the compacted term in the document. Compaction might mix "+"unwanted items into the list.","jsonld.SyntaxError",{code:"compaction to list of lists"});
}if(container==="@language"||container==="@index"){var mapObject;if(itemActiveProperty in rval)mapObject=rval[itemActiveProperty];else rval[itemActiveProperty]=mapObject={};if(container==="@language"&&_isValue(compactedItem))compactedItem=compactedItem["@value"];jsonld.addValue(mapObject,expandedItem[container],compactedItem)}else{var isArray=!options.compactArrays||container==="@set"||container==="@list"||_isArray(compactedItem)&&compactedItem.length===0||expandedProperty==="@list"||expandedProperty===
"@graph";jsonld.addValue(rval,itemActiveProperty,compactedItem,{propertyIsArray:isArray})}}}return rval}return element};Processor.prototype.expand=function(activeCtx,activeProperty,element,options,insideList){var self=this;if(element===null||element===undefined)return null;if(!_isArray(element)&&!_isObject(element)){if(!insideList&&(activeProperty===null||_expandIri(activeCtx,activeProperty,{vocab:true})==="@graph"))return null;return _expandValue(activeCtx,activeProperty,element)}if(_isArray(element)){var rval=
[];var container=jsonld.getContextValue(activeCtx,activeProperty,"@container");insideList=insideList||container==="@list";for(var i=0;i<element.length;++i){var e=self.expand(activeCtx,activeProperty,element[i],options);if(insideList&&(_isArray(e)||_isList(e)))throw new JsonLdError("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});if(e!==null)if(_isArray(e))rval=rval.concat(e);else rval.push(e)}return rval}if("@context"in element)activeCtx=self.processContext(activeCtx,
element["@context"],options);var expandedActiveProperty=_expandIri(activeCtx,activeProperty,{vocab:true});var rval={};var keys=Object.keys(element).sort();for(var ki=0;ki<keys.length;++ki){var key=keys[ki];var value=element[key];var expandedValue;if(key==="@context")continue;var expandedProperty=_expandIri(activeCtx,key,{vocab:true});if(expandedProperty===null||!(_isAbsoluteIri(expandedProperty)||_isKeyword(expandedProperty)))continue;if(_isKeyword(expandedProperty)){if(expandedActiveProperty==="@reverse")throw new JsonLdError("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse "+
"property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:value});if(expandedProperty in rval)throw new JsonLdError("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:expandedProperty});}if(expandedProperty==="@id"&&!_isString(value)){if(!options.isFrame)throw new JsonLdError('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:value});if(!_isObject(value))throw new JsonLdError('Invalid JSON-LD syntax; "@id" value must be a string or an '+
"object.","jsonld.SyntaxError",{code:"invalid @id value",value:value});}if(expandedProperty==="@type")_validateTypeValue(value);if(expandedProperty==="@graph"&&!(_isObject(value)||_isArray(value)))throw new JsonLdError('Invalid JSON-LD syntax; "@graph" value must not be an '+"object or an array.","jsonld.SyntaxError",{code:"invalid @graph value",value:value});if(expandedProperty==="@value"&&(_isObject(value)||_isArray(value)))throw new JsonLdError('Invalid JSON-LD syntax; "@value" value must not be an '+
"object or an array.","jsonld.SyntaxError",{code:"invalid value object value",value:value});if(expandedProperty==="@language"){if(value===null)continue;if(!_isString(value))throw new JsonLdError('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:value});value=value.toLowerCase()}if(expandedProperty==="@index")if(!_isString(value))throw new JsonLdError('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",
{code:"invalid @index value",value:value});if(expandedProperty==="@reverse"){if(!_isObject(value))throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:value});expandedValue=self.expand(activeCtx,"@reverse",value,options);if("@reverse"in expandedValue)for(var property in expandedValue["@reverse"])jsonld.addValue(rval,property,expandedValue["@reverse"][property],{propertyIsArray:true});var reverseMap=rval["@reverse"]||
null;for(var property in expandedValue){if(property==="@reverse")continue;if(reverseMap===null)reverseMap=rval["@reverse"]={};jsonld.addValue(reverseMap,property,[],{propertyIsArray:true});var items=expandedValue[property];for(var ii=0;ii<items.length;++ii){var item=items[ii];if(_isValue(item)||_isList(item))throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must not be a '+"@value or an @list.","jsonld.SyntaxError",{code:"invalid reverse property value",value:expandedValue});jsonld.addValue(reverseMap,
property,item,{propertyIsArray:true})}}continue}var container=jsonld.getContextValue(activeCtx,key,"@container");if(container==="@language"&&_isObject(value))expandedValue=_expandLanguageMap(value);else if(container==="@index"&&_isObject(value))expandedValue=function _expandIndexMap(activeProperty){var rval=[];var keys=Object.keys(value).sort();for(var ki=0;ki<keys.length;++ki){var key=keys[ki];var val=value[key];if(!_isArray(val))val=[val];val=self.expand(activeCtx,activeProperty,val,options,false);
for(var vi=0;vi<val.length;++vi){var item=val[vi];if(!("@index"in item))item["@index"]=key;rval.push(item)}}return rval}(key);else{var isList=expandedProperty==="@list";if(isList||expandedProperty==="@set"){var nextActiveProperty=activeProperty;if(isList&&expandedActiveProperty==="@graph")nextActiveProperty=null;expandedValue=self.expand(activeCtx,nextActiveProperty,value,options,isList);if(isList&&_isList(expandedValue))throw new JsonLdError("Invalid JSON-LD syntax; lists of lists are not permitted.",
"jsonld.SyntaxError",{code:"list of lists"});}else expandedValue=self.expand(activeCtx,key,value,options,false)}if(expandedValue===null&&expandedProperty!=="@value")continue;if(expandedProperty!=="@list"&&!_isList(expandedValue)&&container==="@list"){expandedValue=_isArray(expandedValue)?expandedValue:[expandedValue];expandedValue={"@list":expandedValue}}if(activeCtx.mappings[key]&&activeCtx.mappings[key].reverse){var reverseMap=rval["@reverse"]=rval["@reverse"]||{};if(!_isArray(expandedValue))expandedValue=
[expandedValue];for(var ii=0;ii<expandedValue.length;++ii){var item=expandedValue[ii];if(_isValue(item)||_isList(item))throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must not be a '+"@value or an @list.","jsonld.SyntaxError",{code:"invalid reverse property value",value:expandedValue});jsonld.addValue(reverseMap,expandedProperty,item,{propertyIsArray:true})}continue}var useArray=["@index","@id","@type","@value","@language"].indexOf(expandedProperty)===-1;jsonld.addValue(rval,expandedProperty,
expandedValue,{propertyIsArray:useArray})}keys=Object.keys(rval);var count=keys.length;if("@value"in rval){if("@type"in rval&&"@language"in rval)throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" may not '+'contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:rval});var validCount=count-1;if("@type"in rval)validCount-=1;if("@index"in rval)validCount-=1;if("@language"in rval)validCount-=1;if(validCount!==0)throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" may only '+
'have an "@index" property and at most one other property '+'which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:rval});if(rval["@value"]===null)rval=null;else if("@language"in rval&&!_isString(rval["@value"]))throw new JsonLdError("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:rval});else if("@type"in rval&&(!_isAbsoluteIri(rval["@type"])||rval["@type"].indexOf("_:")===0))throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" and "@type" '+
'must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:rval});}else if("@type"in rval&&!_isArray(rval["@type"]))rval["@type"]=[rval["@type"]];else if("@set"in rval||"@list"in rval){if(count>1&&!(count===2&&"@index"in rval))throw new JsonLdError('Invalid JSON-LD syntax; if an element has the property "@set" '+'or "@list", then it can have at most one other property that is '+'"@index".',"jsonld.SyntaxError",{code:"invalid set or list object",
element:rval});if("@set"in rval){rval=rval["@set"];keys=Object.keys(rval);count=keys.length}}else if(count===1&&"@language"in rval)rval=null;if(_isObject(rval)&&!options.keepFreeFloatingNodes&&!insideList&&(activeProperty===null||expandedActiveProperty==="@graph"))if(count===0||"@value"in rval||"@list"in rval||count===1&&"@id"in rval)rval=null;return rval};Processor.prototype.createNodeMap=function(input,options){options=options||{};var namer=options.namer||new UniqueNamer("_:b");var graphs={"@default":{}};
_createNodeMap(input,graphs,"@default",namer);return _mergeNodeMaps(graphs)};Processor.prototype.flatten=function(input){var defaultGraph=this.createNodeMap(input);var flattened=[];var keys=Object.keys(defaultGraph).sort();for(var ki=0;ki<keys.length;++ki){var node=defaultGraph[keys[ki]];if(!_isSubjectReference(node))flattened.push(node)}return flattened};Processor.prototype.frame=function(input,frame,options){var state={options:options,graphs:{"@default":{},"@merged":{}},subjectStack:[],link:{}};
var namer=new UniqueNamer("_:b");_createNodeMap(input,state.graphs,"@merged",namer);state.subjects=state.graphs["@merged"];var framed=[];_frame(state,Object.keys(state.subjects).sort(),frame,framed,null);return framed};Processor.prototype.normalize=function(dataset,options,callback){var quads=[];var bnodes={};for(var graphName in dataset){var triples=dataset[graphName];if(graphName==="@default")graphName=null;for(var ti=0;ti<triples.length;++ti){var quad=triples[ti];if(graphName!==null)if(graphName.indexOf("_:")===
0)quad.name={type:"blank node",value:graphName};else quad.name={type:"IRI",value:graphName};quads.push(quad);var attrs=["subject","object","name"];for(var ai=0;ai<attrs.length;++ai){var attr=attrs[ai];if(quad[attr]&&quad[attr].type==="blank node"){var id=quad[attr].value;if(id in bnodes)bnodes[id].quads.push(quad);else bnodes[id]={quads:[quad]}}}}}var namer=new UniqueNamer("_:c14n");return hashBlankNodes(Object.keys(bnodes));function hashBlankNodes(unnamed){var nextUnnamed=[];var duplicates={};var unique=
{};jsonld.setImmediate(function(){hashUnnamed(0)});function hashUnnamed(i){if(i===unnamed.length)return nameBlankNodes(unique,duplicates,nextUnnamed);var bnode=unnamed[i];var hash=_hashQuads(bnode,bnodes);if(hash in duplicates){duplicates[hash].push(bnode);nextUnnamed.push(bnode)}else if(hash in unique){duplicates[hash]=[unique[hash],bnode];nextUnnamed.push(unique[hash]);nextUnnamed.push(bnode);delete unique[hash]}else unique[hash]=bnode;jsonld.setImmediate(function(){hashUnnamed(i+1)})}}function nameBlankNodes(unique,
duplicates,unnamed){var named=false;var hashes=Object.keys(unique).sort();for(var i=0;i<hashes.length;++i){var bnode=unique[hashes[i]];namer.getName(bnode);named=true}if(named)hashBlankNodes(unnamed);else nameDuplicates(duplicates)}function nameDuplicates(duplicates){var hashes=Object.keys(duplicates).sort();processGroup(0);function processGroup(i){if(i===hashes.length)return createArray();var group=duplicates[hashes[i]];var results=[];nameGroupMember(group,0);function nameGroupMember(group,n){if(n===
group.length){results.sort(function(a,b){a=a.hash;b=b.hash;return a<b?-1:a>b?1:0});for(var r=0;r<results.length;++r)for(var key in results[r].pathNamer.existing)namer.getName(key);return processGroup(i+1)}var bnode=group[n];if(namer.isNamed(bnode))return nameGroupMember(group,n+1);var pathNamer=new UniqueNamer("_:b");pathNamer.getName(bnode);_hashPaths(bnode,bnodes,namer,pathNamer,function(err,result){if(err)return callback(err);results.push(result);nameGroupMember(group,n+1)})}}}function createArray(){var normalized=
[];for(var i=0;i<quads.length;++i){var quad=quads[i];var attrs=["subject","object","name"];for(var ai=0;ai<attrs.length;++ai){var attr=attrs[ai];if(quad[attr]&&quad[attr].type==="blank node"&&quad[attr].value.indexOf("_:c14n")!==0)quad[attr].value=namer.getName(quad[attr].value)}normalized.push(_toNQuad(quad,quad.name?quad.name.value:null))}normalized.sort();if(options.format){if(options.format==="application/nquads")return callback(null,normalized.join(""));return callback(new JsonLdError("Unknown output format.",
"jsonld.UnknownFormat",{format:options.format}))}callback(null,_parseNQuads(normalized.join("")))}};Processor.prototype.fromRDF=function(dataset,options,callback){var defaultGraph={};var graphMap={"@default":defaultGraph};var referencedOnce={};for(var name in dataset){var graph=dataset[name];if(!(name in graphMap))graphMap[name]={};if(name!=="@default"&&!(name in defaultGraph))defaultGraph[name]={"@id":name};var nodeMap=graphMap[name];for(var ti=0;ti<graph.length;++ti){var triple=graph[ti];var s=
triple.subject.value;var p=triple.predicate.value;var o=triple.object;if(!(s in nodeMap))nodeMap[s]={"@id":s};var node=nodeMap[s];var objectIsId=o.type==="IRI"||o.type==="blank node";if(objectIsId&&!(o.value in nodeMap))nodeMap[o.value]={"@id":o.value};if(p===RDF_TYPE&&!options.useRdfType&&objectIsId){jsonld.addValue(node,"@type",o.value,{propertyIsArray:true});continue}var value=_RDFToObject(o,options.useNativeTypes);jsonld.addValue(node,p,value,{propertyIsArray:true});if(objectIsId)if(o.value===
RDF_NIL){var object=nodeMap[o.value];if(!("usages"in object))object.usages=[];object.usages.push({node:node,property:p,value:value})}else if(o.value in referencedOnce)referencedOnce[o.value]=false;else referencedOnce[o.value]={node:node,property:p,value:value}}}for(var name in graphMap){var graphObject=graphMap[name];if(!(RDF_NIL in graphObject))continue;var nil=graphObject[RDF_NIL];for(var i=0;i<nil.usages.length;++i){var usage=nil.usages[i];var node=usage.node;var property=usage.property;var head=
usage.value;var list=[];var listNodes=[];var nodeKeyCount=Object.keys(node).length;while(property===RDF_REST&&_isObject(referencedOnce[node["@id"]])&&_isArray(node[RDF_FIRST])&&node[RDF_FIRST].length===1&&_isArray(node[RDF_REST])&&node[RDF_REST].length===1&&(nodeKeyCount===3||nodeKeyCount===4&&_isArray(node["@type"])&&node["@type"].length===1&&node["@type"][0]===RDF_LIST)){list.push(node[RDF_FIRST][0]);listNodes.push(node["@id"]);usage=referencedOnce[node["@id"]];node=usage.node;property=usage.property;
head=usage.value;nodeKeyCount=Object.keys(node).length;if(node["@id"].indexOf("_:")!==0)break}if(property===RDF_FIRST){if(node["@id"]===RDF_NIL)continue;head=graphObject[head["@id"]][RDF_REST][0];list.pop();listNodes.pop()}delete head["@id"];head["@list"]=list.reverse();for(var j=0;j<listNodes.length;++j)delete graphObject[listNodes[j]]}delete nil.usages}var result=[];var subjects=Object.keys(defaultGraph).sort();for(var i=0;i<subjects.length;++i){var subject=subjects[i];var node=defaultGraph[subject];
if(subject in graphMap){var graph=node["@graph"]=[];var graphObject=graphMap[subject];var subjects_=Object.keys(graphObject).sort();for(var si=0;si<subjects_.length;++si){var node_=graphObject[subjects_[si]];if(!_isSubjectReference(node_))graph.push(node_)}}if(!_isSubjectReference(node))result.push(node)}callback(null,result)};Processor.prototype.toRDF=function(input,options){var namer=new UniqueNamer("_:b");var nodeMap={"@default":{}};_createNodeMap(input,nodeMap,"@default",namer);var dataset={};
var graphNames=Object.keys(nodeMap).sort();for(var i=0;i<graphNames.length;++i){var graphName=graphNames[i];if(graphName==="@default"||_isAbsoluteIri(graphName))dataset[graphName]=_graphToRDF(nodeMap[graphName],namer,options)}return dataset};Processor.prototype.processContext=function(activeCtx,localCtx,options){if(_isObject(localCtx)&&"@context"in localCtx&&_isArray(localCtx["@context"]))localCtx=localCtx["@context"];var ctxs=_isArray(localCtx)?localCtx:[localCtx];if(ctxs.length===0)return activeCtx.clone();
var rval=activeCtx;for(var i=0;i<ctxs.length;++i){var ctx=ctxs[i];if(ctx===null){rval=activeCtx=_getInitialContext(options);continue}if(_isObject(ctx)&&"@context"in ctx)ctx=ctx["@context"];if(!_isObject(ctx))throw new JsonLdError("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:ctx});if(jsonld.cache.activeCtx){var cached=jsonld.cache.activeCtx.get(activeCtx,ctx);if(cached){rval=activeCtx=cached;continue}}activeCtx=rval;rval=rval.clone();
var defined={};if("@base"in ctx){var base=ctx["@base"];if(base===null)base=null;else if(!_isString(base))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@base" in a '+"@context must be a string or null.","jsonld.SyntaxError",{code:"invalid base IRI",context:ctx});else if(base!==""&&!_isAbsoluteIri(base))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@base" in a '+"@context must be an absolute IRI or the empty string.","jsonld.SyntaxError",{code:"invalid base IRI",context:ctx});
if(base!==null)base=jsonld.url.parse(base||"");rval["@base"]=base;defined["@base"]=true}if("@vocab"in ctx){var value=ctx["@vocab"];if(value===null)delete rval["@vocab"];else if(!_isString(value))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@vocab" in a '+"@context must be a string or null.","jsonld.SyntaxError",{code:"invalid vocab mapping",context:ctx});else if(!_isAbsoluteIri(value))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@vocab" in a '+"@context must be an absolute IRI.",
"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ctx});else rval["@vocab"]=value;defined["@vocab"]=true}if("@language"in ctx){var value=ctx["@language"];if(value===null)delete rval["@language"];else if(!_isString(value))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@language" in a '+"@context must be a string or null.","jsonld.SyntaxError",{code:"invalid default language",context:ctx});else rval["@language"]=value.toLowerCase();defined["@language"]=true}for(var key in ctx)_createTermDefinition(rval,
ctx,key,defined);if(jsonld.cache.activeCtx)jsonld.cache.activeCtx.set(activeCtx,ctx,rval)}return rval};function _expandLanguageMap(languageMap){var rval=[];var keys=Object.keys(languageMap).sort();for(var ki=0;ki<keys.length;++ki){var key=keys[ki];var val=languageMap[key];if(!_isArray(val))val=[val];for(var vi=0;vi<val.length;++vi){var item=val[vi];if(!_isString(item))throw new JsonLdError("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",
languageMap:languageMap});rval.push({"@value":item,"@language":key.toLowerCase()})}}return rval}function _labelBlankNodes(namer,element){if(_isArray(element))for(var i=0;i<element.length;++i)element[i]=_labelBlankNodes(namer,element[i]);else if(_isList(element))element["@list"]=_labelBlankNodes(namer,element["@list"]);else if(_isObject(element)){if(_isBlankNode(element))element["@id"]=namer.getName(element["@id"]);var keys=Object.keys(element).sort();for(var ki=0;ki<keys.length;++ki){var key=keys[ki];
if(key!=="@id")element[key]=_labelBlankNodes(namer,element[key])}}return element}function _expandValue(activeCtx,activeProperty,value){if(value===null||value===undefined)return null;var expandedProperty=_expandIri(activeCtx,activeProperty,{vocab:true});if(expandedProperty==="@id")return _expandIri(activeCtx,value,{base:true});else if(expandedProperty==="@type")return _expandIri(activeCtx,value,{vocab:true,base:true});var type=jsonld.getContextValue(activeCtx,activeProperty,"@type");if(type==="@id"||
expandedProperty==="@graph"&&_isString(value))return{"@id":_expandIri(activeCtx,value,{base:true})};if(type==="@vocab")return{"@id":_expandIri(activeCtx,value,{vocab:true,base:true})};if(_isKeyword(expandedProperty))return value;var rval={};if(type!==null)rval["@type"]=type;else if(_isString(value)){var language=jsonld.getContextValue(activeCtx,activeProperty,"@language");if(language!==null)rval["@language"]=language}if(["boolean","number","string"].indexOf(typeof value)===-1)value=value.toString();
rval["@value"]=value;return rval}function _graphToRDF(graph,namer,options){var rval=[];var ids=Object.keys(graph).sort();for(var i=0;i<ids.length;++i){var id=ids[i];var node=graph[id];var properties=Object.keys(node).sort();for(var pi=0;pi<properties.length;++pi){var property=properties[pi];var items=node[property];if(property==="@type")property=RDF_TYPE;else if(_isKeyword(property))continue;for(var ii=0;ii<items.length;++ii){var item=items[ii];var subject={};subject.type=id.indexOf("_:")===0?"blank node":
"IRI";subject.value=id;if(!_isAbsoluteIri(id))continue;var predicate={};predicate.type=property.indexOf("_:")===0?"blank node":"IRI";predicate.value=property;if(!_isAbsoluteIri(property))continue;if(predicate.type==="blank node"&&!options.produceGeneralizedRdf)continue;if(_isList(item))_listToRDF(item["@list"],namer,subject,predicate,rval);else{var object=_objectToRDF(item);if(object)rval.push({subject:subject,predicate:predicate,object:object})}}}}return rval}function _listToRDF(list,namer,subject,
predicate,triples){var first={type:"IRI",value:RDF_FIRST};var rest={type:"IRI",value:RDF_REST};var nil={type:"IRI",value:RDF_NIL};for(var i=0;i<list.length;++i){var item=list[i];var blankNode={type:"blank node",value:namer.getName()};triples.push({subject:subject,predicate:predicate,object:blankNode});subject=blankNode;predicate=first;var object=_objectToRDF(item);if(object)triples.push({subject:subject,predicate:predicate,object:object});predicate=rest}triples.push({subject:subject,predicate:predicate,
object:nil})}function _objectToRDF(item){var object={};if(_isValue(item)){object.type="literal";var value=item["@value"];var datatype=item["@type"]||null;if(_isBoolean(value)){object.value=value.toString();object.datatype=datatype||XSD_BOOLEAN}else if(_isDouble(value)||datatype===XSD_DOUBLE){if(!_isDouble(value))value=parseFloat(value);object.value=value.toExponential(15).replace(/(\d)0*e\+?/,"$1E");object.datatype=datatype||XSD_DOUBLE}else if(_isNumber(value)){object.value=value.toFixed(0);object.datatype=
datatype||XSD_INTEGER}else if("@language"in item){object.value=value;object.datatype=datatype||RDF_LANGSTRING;object.language=item["@language"]}else{object.value=value;object.datatype=datatype||XSD_STRING}}else{var id=_isObject(item)?item["@id"]:item;object.type=id.indexOf("_:")===0?"blank node":"IRI";object.value=id}if(object.type==="IRI"&&!_isAbsoluteIri(object.value))return null;return object}function _RDFToObject(o,useNativeTypes){if(o.type==="IRI"||o.type==="blank node")return{"@id":o.value};
var rval={"@value":o.value};if(o.language)rval["@language"]=o.language;else{var type=o.datatype;if(!type)type=XSD_STRING;if(useNativeTypes){if(type===XSD_BOOLEAN)if(rval["@value"]==="true")rval["@value"]=true;else{if(rval["@value"]==="false")rval["@value"]=false}else if(_isNumeric(rval["@value"]))if(type===XSD_INTEGER){var i=parseInt(rval["@value"],10);if(i.toFixed(0)===rval["@value"])rval["@value"]=i}else if(type===XSD_DOUBLE)rval["@value"]=parseFloat(rval["@value"]);if([XSD_BOOLEAN,XSD_INTEGER,
XSD_DOUBLE,XSD_STRING].indexOf(type)===-1)rval["@type"]=type}else if(type!==XSD_STRING)rval["@type"]=type}return rval}function _compareRDFTriples(t1,t2){var attrs=["subject","predicate","object"];for(var i=0;i<attrs.length;++i){var attr=attrs[i];if(t1[attr].type!==t2[attr].type||t1[attr].value!==t2[attr].value)return false}if(t1.object.language!==t2.object.language)return false;if(t1.object.datatype!==t2.object.datatype)return false;return true}function _hashQuads(id,bnodes){if("hash"in bnodes[id])return bnodes[id].hash;
var quads=bnodes[id].quads;var nquads=[];for(var i=0;i<quads.length;++i)nquads.push(_toNQuad(quads[i],quads[i].name?quads[i].name.value:null,id));nquads.sort();var hash=bnodes[id].hash=sha1.hash(nquads);return hash}function _hashPaths(id,bnodes,namer,pathNamer,callback){var md=sha1.create();var groups={};var groupHashes;var quads=bnodes[id].quads;jsonld.setImmediate(function(){groupNodes(0)});function groupNodes(i){if(i===quads.length){groupHashes=Object.keys(groups).sort();return hashGroup(0)}var quad=
quads[i];var bnode=_getAdjacentBlankNodeName(quad.subject,id);var direction=null;if(bnode!==null)direction="p";else{bnode=_getAdjacentBlankNodeName(quad.object,id);if(bnode!==null)direction="r"}if(bnode!==null){var name;if(namer.isNamed(bnode))name=namer.getName(bnode);else if(pathNamer.isNamed(bnode))name=pathNamer.getName(bnode);else name=_hashQuads(bnode,bnodes);var md=sha1.create();md.update(direction);md.update(quad.predicate.value);md.update(name);var groupHash=md.digest();if(groupHash in groups)groups[groupHash].push(bnode);
else groups[groupHash]=[bnode]}jsonld.setImmediate(function(){groupNodes(i+1)})}function hashGroup(i){if(i===groupHashes.length)return callback(null,{hash:md.digest(),pathNamer:pathNamer});var groupHash=groupHashes[i];md.update(groupHash);var chosenPath=null;var chosenNamer=null;var permutator=new Permutator(groups[groupHash]);jsonld.setImmediate(function(){permutate()});function permutate(){var permutation=permutator.next();var pathNamerCopy=pathNamer.clone();var path="";var recurse=[];for(var n in permutation){var bnode=
permutation[n];if(namer.isNamed(bnode))path+=namer.getName(bnode);else{if(!pathNamerCopy.isNamed(bnode))recurse.push(bnode);path+=pathNamerCopy.getName(bnode)}if(chosenPath!==null&&path.length>=chosenPath.length&&path>chosenPath)return nextPermutation(true)}nextRecursion(0);function nextRecursion(n){if(n===recurse.length)return nextPermutation(false);var bnode=recurse[n];_hashPaths(bnode,bnodes,namer,pathNamerCopy,function(err,result){if(err)return callback(err);path+=pathNamerCopy.getName(bnode)+
"<"+result.hash+">";pathNamerCopy=result.pathNamer;if(chosenPath!==null&&path.length>=chosenPath.length&&path>chosenPath)return nextPermutation(true);nextRecursion(n+1)})}function nextPermutation(skipped){if(!skipped&&(chosenPath===null||path<chosenPath)){chosenPath=path;chosenNamer=pathNamerCopy}if(permutator.hasNext())jsonld.setImmediate(function(){permutate()});else{md.update(chosenPath);pathNamer=chosenNamer;hashGroup(i+1)}}}}}function _getAdjacentBlankNodeName(node,id){return node.type==="blank node"&&
node.value!==id?node.value:null}function _createNodeMap(input,graphs,graph,namer,name,list){if(_isArray(input)){for(var i=0;i<input.length;++i)_createNodeMap(input[i],graphs,graph,namer,undefined,list);return}if(!_isObject(input)){if(list)list.push(input);return}if(_isValue(input)){if("@type"in input){var type=input["@type"];if(type.indexOf("_:")===0)input["@type"]=type=namer.getName(type)}if(list)list.push(input);return}if("@type"in input){var types=input["@type"];for(var i=0;i<types.length;++i){var type=
types[i];if(type.indexOf("_:")===0)namer.getName(type)}}if(_isUndefined(name))name=_isBlankNode(input)?namer.getName(input["@id"]):input["@id"];if(list)list.push({"@id":name});var subjects=graphs[graph];var subject=subjects[name]=subjects[name]||{};subject["@id"]=name;var properties=Object.keys(input).sort();for(var pi=0;pi<properties.length;++pi){var property=properties[pi];if(property==="@id")continue;if(property==="@reverse"){var referencedNode={"@id":name};var reverseMap=input["@reverse"];for(var reverseProperty in reverseMap){var items=
reverseMap[reverseProperty];for(var ii=0;ii<items.length;++ii){var item=items[ii];var itemName=item["@id"];if(_isBlankNode(item))itemName=namer.getName(itemName);_createNodeMap(item,graphs,graph,namer,itemName);jsonld.addValue(subjects[itemName],reverseProperty,referencedNode,{propertyIsArray:true,allowDuplicate:false})}}continue}if(property==="@graph"){if(!(name in graphs))graphs[name]={};var g=graph==="@merged"?graph:name;_createNodeMap(input[property],graphs,g,namer);continue}if(property!=="@type"&&
_isKeyword(property)){if(property==="@index"&&property in subject&&(input[property]!==subject[property]||input[property]["@id"]!==subject[property]["@id"]))throw new JsonLdError("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:subject});subject[property]=input[property];continue}var objects=input[property];if(property.indexOf("_:")===0)property=namer.getName(property);if(objects.length===0){jsonld.addValue(subject,property,[],
{propertyIsArray:true});continue}for(var oi=0;oi<objects.length;++oi){var o=objects[oi];if(property==="@type")o=o.indexOf("_:")===0?namer.getName(o):o;if(_isSubject(o)||_isSubjectReference(o)){var id=_isBlankNode(o)?namer.getName(o["@id"]):o["@id"];jsonld.addValue(subject,property,{"@id":id},{propertyIsArray:true,allowDuplicate:false});_createNodeMap(o,graphs,graph,namer,id)}else if(_isList(o)){var _list=[];_createNodeMap(o["@list"],graphs,graph,namer,name,_list);o={"@list":_list};jsonld.addValue(subject,
property,o,{propertyIsArray:true,allowDuplicate:false})}else{_createNodeMap(o,graphs,graph,namer,name);jsonld.addValue(subject,property,o,{propertyIsArray:true,allowDuplicate:false})}}}}function _mergeNodeMaps(graphs){var defaultGraph=graphs["@default"];var graphNames=Object.keys(graphs).sort();for(var i=0;i<graphNames.length;++i){var graphName=graphNames[i];if(graphName==="@default")continue;var nodeMap=graphs[graphName];var subject=defaultGraph[graphName];if(!subject)defaultGraph[graphName]=subject=
{"@id":graphName,"@graph":[]};else if(!("@graph"in subject))subject["@graph"]=[];var graph=subject["@graph"];var ids=Object.keys(nodeMap).sort();for(var ii=0;ii<ids.length;++ii){var node=nodeMap[ids[ii]];if(!_isSubjectReference(node))graph.push(node)}}return defaultGraph}function _frame(state,subjects,frame,parent,property){_validateFrame(frame);frame=frame[0];var options=state.options;var flags={embed:_getFrameFlag(frame,options,"embed"),explicit:_getFrameFlag(frame,options,"explicit"),requireAll:_getFrameFlag(frame,
options,"requireAll")};var matches=_filterSubjects(state,subjects,frame,flags);var ids=Object.keys(matches).sort();for(var idx=0;idx<ids.length;++idx){var id=ids[idx];var subject=matches[id];if(flags.embed==="@link"&&id in state.link){_addFrameOutput(parent,property,state.link[id]);continue}if(property===null)state.uniqueEmbeds={};var output={};output["@id"]=id;state.link[id]=output;if(flags.embed==="@never"||_createsCircularReference(subject,state.subjectStack)){_addFrameOutput(parent,property,output);
continue}if(flags.embed==="@last"){if(id in state.uniqueEmbeds)_removeEmbed(state,id);state.uniqueEmbeds[id]={parent:parent,property:property}}state.subjectStack.push(subject);var props=Object.keys(subject).sort();for(var i=0;i<props.length;i++){var prop=props[i];if(_isKeyword(prop)){output[prop]=_clone(subject[prop]);continue}if(flags.explicit&&!(prop in frame))continue;var objects=subject[prop];for(var oi=0;oi<objects.length;++oi){var o=objects[oi];if(_isList(o)){var list={"@list":[]};_addFrameOutput(output,
prop,list);var src=o["@list"];for(var n in src){o=src[n];if(_isSubjectReference(o)){var subframe=prop in frame?frame[prop][0]["@list"]:_createImplicitFrame(flags);_frame(state,[o["@id"]],subframe,list,"@list")}else _addFrameOutput(list,"@list",_clone(o))}continue}if(_isSubjectReference(o)){var subframe=prop in frame?frame[prop]:_createImplicitFrame(flags);_frame(state,[o["@id"]],subframe,output,prop)}else _addFrameOutput(output,prop,_clone(o))}}var props=Object.keys(frame).sort();for(var i=0;i<props.length;++i){var prop=
props[i];if(_isKeyword(prop))continue;var next=frame[prop][0];var omitDefaultOn=_getFrameFlag(next,options,"omitDefault");if(!omitDefaultOn&&!(prop in output)){var preserve="@null";if("@default"in next)preserve=_clone(next["@default"]);if(!_isArray(preserve))preserve=[preserve];output[prop]=[{"@preserve":preserve}]}}_addFrameOutput(parent,property,output);state.subjectStack.pop()}}function _createImplicitFrame(flags){var frame={};for(var key in flags)if(flags[key]!==undefined)frame["@"+key]=[flags[key]];
return[frame]}function _createsCircularReference(subjectToEmbed,subjectStack){for(var i=subjectStack.length-1;i>=0;--i)if(subjectStack[i]["@id"]===subjectToEmbed["@id"])return true;return false}function _getFrameFlag(frame,options,name){var flag="@"+name;var rval=flag in frame?frame[flag][0]:options[name];if(name==="embed")if(rval===true)rval="@last";else if(rval===false)rval="@never";else if(rval!=="@always"&&rval!=="@never"&&rval!=="@link")rval="@last";return rval}function _validateFrame(frame){if(!_isArray(frame)||
frame.length!==1||!_isObject(frame[0]))throw new JsonLdError("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:frame});}function _filterSubjects(state,subjects,frame,flags){var rval={};for(var i=0;i<subjects.length;++i){var id=subjects[i];var subject=state.subjects[id];if(_filterSubject(subject,frame,flags))rval[id]=subject}return rval}function _filterSubject(subject,frame,flags){if("@type"in frame&&!(frame["@type"].length===1&&_isObject(frame["@type"][0]))){var types=
frame["@type"];for(var i=0;i<types.length;++i)if(jsonld.hasValue(subject,"@type",types[i]))return true;return false}var wildcard=true;var matchesSome=false;for(var key in frame){if(_isKeyword(key)){if(key!=="@id"&&key!=="@type")continue;wildcard=false;if(key==="@id"&&_isString(frame[key])){if(subject[key]!==frame[key])return false;matchesSome=true;continue}}wildcard=false;if(key in subject){if(_isArray(frame[key])&&frame[key].length===0&&subject[key]!==undefined)return false;matchesSome=true;continue}var hasDefault=
_isArray(frame[key])&&_isObject(frame[key][0])&&"@default"in frame[key][0];if(flags.requireAll&&!hasDefault)return false}return wildcard||matchesSome}function _removeEmbed(state,id){var embeds=state.uniqueEmbeds;var embed=embeds[id];var parent=embed.parent;var property=embed.property;var subject={"@id":id};if(_isArray(parent))for(var i=0;i<parent.length;++i){if(jsonld.compareValues(parent[i],subject)){parent[i]=subject;break}}else{var useArray=_isArray(parent[property]);jsonld.removeValue(parent,
property,subject,{propertyIsArray:useArray});jsonld.addValue(parent,property,subject,{propertyIsArray:useArray})}var removeDependents=function(id){var ids=Object.keys(embeds);for(var i=0;i<ids.length;++i){var next=ids[i];if(next in embeds&&_isObject(embeds[next].parent)&&embeds[next].parent["@id"]===id){delete embeds[next];removeDependents(next)}}};removeDependents(id)}function _addFrameOutput(parent,property,output){if(_isObject(parent))jsonld.addValue(parent,property,output,{propertyIsArray:true});
else parent.push(output)}function _removePreserve(ctx,input,options){if(_isArray(input)){var output=[];for(var i=0;i<input.length;++i){var result=_removePreserve(ctx,input[i],options);if(result!==null)output.push(result)}input=output}else if(_isObject(input)){if("@preserve"in input){if(input["@preserve"]==="@null")return null;return input["@preserve"]}if(_isValue(input))return input;if(_isList(input)){input["@list"]=_removePreserve(ctx,input["@list"],options);return input}var idAlias=_compactIri(ctx,
"@id");if(idAlias in input){var id=input[idAlias];if(id in options.link){var idx=options.link[id].indexOf(input);if(idx===-1)options.link[id].push(input);else return options.link[id][idx]}else options.link[id]=[input]}for(var prop in input){var result=_removePreserve(ctx,input[prop],options);var container=jsonld.getContextValue(ctx,prop,"@container");if(options.compactArrays&&_isArray(result)&&result.length===1&&container===null)result=result[0];input[prop]=result}}return input}function _compareShortestLeast(a,
b){if(a.length<b.length)return-1;if(b.length<a.length)return 1;if(a===b)return 0;return a<b?-1:1}function _selectTerm(activeCtx,iri,value,containers,typeOrLanguage,typeOrLanguageValue){if(typeOrLanguageValue===null)typeOrLanguageValue="@null";var prefs=[];if((typeOrLanguageValue==="@id"||typeOrLanguageValue==="@reverse")&&_isSubjectReference(value)){if(typeOrLanguageValue==="@reverse")prefs.push("@reverse");var term=_compactIri(activeCtx,value["@id"],null,{vocab:true});if(term in activeCtx.mappings&&
activeCtx.mappings[term]&&activeCtx.mappings[term]["@id"]===value["@id"])prefs.push.apply(prefs,["@vocab","@id"]);else prefs.push.apply(prefs,["@id","@vocab"])}else prefs.push(typeOrLanguageValue);prefs.push("@none");var containerMap=activeCtx.inverse[iri];for(var ci=0;ci<containers.length;++ci){var container=containers[ci];if(!(container in containerMap))continue;var typeOrLanguageValueMap=containerMap[container][typeOrLanguage];for(var pi=0;pi<prefs.length;++pi){var pref=prefs[pi];if(!(pref in typeOrLanguageValueMap))continue;
return typeOrLanguageValueMap[pref]}}return null}function _compactIri(activeCtx,iri,value,relativeTo,reverse){if(iri===null)return iri;if(_isUndefined(value))value=null;if(_isUndefined(reverse))reverse=false;relativeTo=relativeTo||{};if(_isKeyword(iri))relativeTo.vocab=true;if(relativeTo.vocab&&iri in activeCtx.getInverse()){var defaultLanguage=activeCtx["@language"]||"@none";var containers=[];if(_isObject(value)&&"@index"in value)containers.push("@index");var typeOrLanguage="@language";var typeOrLanguageValue=
"@null";if(reverse){typeOrLanguage="@type";typeOrLanguageValue="@reverse";containers.push("@set")}else if(_isList(value)){if(!("@index"in value))containers.push("@list");var list=value["@list"];var commonLanguage=list.length===0?defaultLanguage:null;var commonType=null;for(var i=0;i<list.length;++i){var item=list[i];var itemLanguage="@none";var itemType="@none";if(_isValue(item))if("@language"in item)itemLanguage=item["@language"];else if("@type"in item)itemType=item["@type"];else itemLanguage="@null";
else itemType="@id";if(commonLanguage===null)commonLanguage=itemLanguage;else if(itemLanguage!==commonLanguage&&_isValue(item))commonLanguage="@none";if(commonType===null)commonType=itemType;else if(itemType!==commonType)commonType="@none";if(commonLanguage==="@none"&&commonType==="@none")break}commonLanguage=commonLanguage||"@none";commonType=commonType||"@none";if(commonType!=="@none"){typeOrLanguage="@type";typeOrLanguageValue=commonType}else typeOrLanguageValue=commonLanguage}else{if(_isValue(value))if("@language"in
value&&!("@index"in value)){containers.push("@language");typeOrLanguageValue=value["@language"]}else{if("@type"in value){typeOrLanguage="@type";typeOrLanguageValue=value["@type"]}}else{typeOrLanguage="@type";typeOrLanguageValue="@id"}containers.push("@set")}containers.push("@none");var term=_selectTerm(activeCtx,iri,value,containers,typeOrLanguage,typeOrLanguageValue);if(term!==null)return term}if(relativeTo.vocab)if("@vocab"in activeCtx){var vocab=activeCtx["@vocab"];if(iri.indexOf(vocab)===0&&iri!==
vocab){var suffix=iri.substr(vocab.length);if(!(suffix in activeCtx.mappings))return suffix}}var choice=null;for(var term in activeCtx.mappings){if(term.indexOf(":")!==-1)continue;var definition=activeCtx.mappings[term];if(!definition||definition["@id"]===iri||iri.indexOf(definition["@id"])!==0)continue;var curie=term+":"+iri.substr(definition["@id"].length);var isUsableCurie=!(curie in activeCtx.mappings)||value===null&&activeCtx.mappings[curie]&&activeCtx.mappings[curie]["@id"]===iri;if(isUsableCurie&&
(choice===null||_compareShortestLeast(curie,choice)<0))choice=curie}if(choice!==null)return choice;if(!relativeTo.vocab)return _removeBase(activeCtx["@base"],iri);return iri}function _compactValue(activeCtx,activeProperty,value){if(_isValue(value)){var type=jsonld.getContextValue(activeCtx,activeProperty,"@type");var language=jsonld.getContextValue(activeCtx,activeProperty,"@language");var container=jsonld.getContextValue(activeCtx,activeProperty,"@container");var preserveIndex="@index"in value&&
container!=="@index";if(!preserveIndex)if(value["@type"]===type||value["@language"]===language)return value["@value"];var keyCount=Object.keys(value).length;var isValueOnlyKey=keyCount===1||keyCount===2&&"@index"in value&&!preserveIndex;var hasDefaultLanguage="@language"in activeCtx;var isValueString=_isString(value["@value"]);var hasNullMapping=activeCtx.mappings[activeProperty]&&activeCtx.mappings[activeProperty]["@language"]===null;if(isValueOnlyKey&&(!hasDefaultLanguage||!isValueString||hasNullMapping))return value["@value"];
var rval={};if(preserveIndex)rval[_compactIri(activeCtx,"@index")]=value["@index"];if("@type"in value)rval[_compactIri(activeCtx,"@type")]=_compactIri(activeCtx,value["@type"],null,{vocab:true});else if("@language"in value)rval[_compactIri(activeCtx,"@language")]=value["@language"];rval[_compactIri(activeCtx,"@value")]=value["@value"];return rval}var expandedProperty=_expandIri(activeCtx,activeProperty,{vocab:true});var type=jsonld.getContextValue(activeCtx,activeProperty,"@type");var compacted=_compactIri(activeCtx,
value["@id"],null,{vocab:type==="@vocab"});if(type==="@id"||type==="@vocab"||expandedProperty==="@graph")return compacted;var rval={};rval[_compactIri(activeCtx,"@id")]=compacted;return rval}function _createTermDefinition(activeCtx,localCtx,term,defined){if(term in defined){if(defined[term])return;throw new JsonLdError("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:localCtx,term:term});}defined[term]=false;if(_isKeyword(term))throw new JsonLdError("Invalid JSON-LD syntax; keywords cannot be overridden.",
"jsonld.SyntaxError",{code:"keyword redefinition",context:localCtx,term:term});if(term==="")throw new JsonLdError("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:localCtx});if(activeCtx.mappings[term])delete activeCtx.mappings[term];var value=localCtx[term];if(value===null||_isObject(value)&&value["@id"]===null){activeCtx.mappings[term]=null;defined[term]=true;return}if(_isString(value))value={"@id":value};if(!_isObject(value))throw new JsonLdError("Invalid JSON-LD syntax; @context property values must be "+
"strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:localCtx});var mapping=activeCtx.mappings[term]={};mapping.reverse=false;if("@reverse"in value){if("@id"in value)throw new JsonLdError("Invalid JSON-LD syntax; a @reverse term definition must not "+"contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:localCtx});var reverse=value["@reverse"];if(!_isString(reverse))throw new JsonLdError("Invalid JSON-LD syntax; a @context @reverse value must be a string.",
"jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx});var id=_expandIri(activeCtx,reverse,{vocab:true,base:false},localCtx,defined);if(!_isAbsoluteIri(id))throw new JsonLdError("Invalid JSON-LD syntax; a @context @reverse value must be an "+"absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx});mapping["@id"]=id;mapping.reverse=true}else if("@id"in value){var id=value["@id"];if(!_isString(id))throw new JsonLdError("Invalid JSON-LD syntax; a @context @id value must be an array "+
"of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx});if(id!==term){id=_expandIri(activeCtx,id,{vocab:true,base:false},localCtx,defined);if(!_isAbsoluteIri(id)&&!_isKeyword(id))throw new JsonLdError("Invalid JSON-LD syntax; a @context @id value must be an "+"absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx});mapping["@id"]=id}}if(!("@id"in mapping)){var colon=term.indexOf(":");if(colon!==
-1){var prefix=term.substr(0,colon);if(prefix in localCtx)_createTermDefinition(activeCtx,localCtx,prefix,defined);if(activeCtx.mappings[prefix]){var suffix=term.substr(colon+1);mapping["@id"]=activeCtx.mappings[prefix]["@id"]+suffix}else mapping["@id"]=term}else{if(!("@vocab"in activeCtx))throw new JsonLdError("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx,term:term});mapping["@id"]=activeCtx["@vocab"]+term}}defined[term]=
true;if("@type"in value){var type=value["@type"];if(!_isString(type))throw new JsonLdError("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx});if(type!=="@id"&&type!=="@vocab"){type=_expandIri(activeCtx,type,{vocab:true,base:false},localCtx,defined);if(!_isAbsoluteIri(type))throw new JsonLdError("Invalid JSON-LD syntax; an @context @type value must be an "+"absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",
context:localCtx});if(type.indexOf("_:")===0)throw new JsonLdError("Invalid JSON-LD syntax; an @context @type values must be an IRI, "+"not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx});}mapping["@type"]=type}if("@container"in value){var container=value["@container"];if(container!=="@list"&&container!=="@set"&&container!=="@index"&&container!=="@language")throw new JsonLdError("Invalid JSON-LD syntax; @context @container value must be "+"one of the following: @list, @set, @index, or @language.",
"jsonld.SyntaxError",{code:"invalid container mapping",context:localCtx});if(mapping.reverse&&container!=="@index"&&container!=="@set"&&container!==null)throw new JsonLdError("Invalid JSON-LD syntax; @context @container value for a @reverse "+"type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:localCtx});mapping["@container"]=container}if("@language"in value&&!("@type"in value)){var language=value["@language"];if(language!==null&&!_isString(language))throw new JsonLdError("Invalid JSON-LD syntax; @context @language value must be "+
"a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:localCtx});if(language!==null)language=language.toLowerCase();mapping["@language"]=language}var id=mapping["@id"];if(id==="@context"||id==="@preserve")throw new JsonLdError("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:localCtx});}function _expandIri(activeCtx,value,relativeTo,localCtx,defined){if(value===null||_isKeyword(value))return value;
value=String(value);if(localCtx&&value in localCtx&&defined[value]!==true)_createTermDefinition(activeCtx,localCtx,value,defined);relativeTo=relativeTo||{};if(relativeTo.vocab){var mapping=activeCtx.mappings[value];if(mapping===null)return null;if(mapping)return mapping["@id"]}var colon=value.indexOf(":");if(colon!==-1){var prefix=value.substr(0,colon);var suffix=value.substr(colon+1);if(prefix==="_"||suffix.indexOf("//")===0)return value;if(localCtx&&prefix in localCtx)_createTermDefinition(activeCtx,
localCtx,prefix,defined);var mapping=activeCtx.mappings[prefix];if(mapping)return mapping["@id"]+suffix;return value}if(relativeTo.vocab&&"@vocab"in activeCtx)return activeCtx["@vocab"]+value;var rval=value;if(relativeTo.base)rval=_prependBase(activeCtx["@base"],rval);return rval}function _prependBase(base,iri){if(base===null)return iri;if(iri.indexOf(":")!==-1)return iri;if(_isString(base))base=jsonld.url.parse(base||"");var rel=jsonld.url.parse(iri);var transform={protocol:base.protocol||""};if(rel.authority!==
null){transform.authority=rel.authority;transform.path=rel.path;transform.query=rel.query}else{transform.authority=base.authority;if(rel.path===""){transform.path=base.path;if(rel.query!==null)transform.query=rel.query;else transform.query=base.query}else{if(rel.path.indexOf("/")===0)transform.path=rel.path;else{var path=base.path;if(rel.path!==""){path=path.substr(0,path.lastIndexOf("/")+1);if(path.length>0&&path.substr(-1)!=="/")path+="/";path+=rel.path}transform.path=path}transform.query=rel.query}}transform.path=
_removeDotSegments(transform.path,!!transform.authority);var rval=transform.protocol;if(transform.authority!==null)rval+="//"+transform.authority;rval+=transform.path;if(transform.query!==null)rval+="?"+transform.query;if(rel.fragment!==null)rval+="#"+rel.fragment;if(rval==="")rval="./";return rval}function _removeBase(base,iri){if(base===null)return iri;if(_isString(base))base=jsonld.url.parse(base||"");var root="";if(base.href!=="")root+=(base.protocol||"")+"//"+(base.authority||"");else if(iri.indexOf("//"))root+=
"//";if(iri.indexOf(root)!==0)return iri;var rel=jsonld.url.parse(iri.substr(root.length));var baseSegments=base.normalizedPath.split("/");var iriSegments=rel.normalizedPath.split("/");var last=rel.fragment||rel.query?0:1;while(baseSegments.length>0&&iriSegments.length>last){if(baseSegments[0]!==iriSegments[0])break;baseSegments.shift();iriSegments.shift()}var rval="";if(baseSegments.length>0){baseSegments.pop();for(var i=0;i<baseSegments.length;++i)rval+="../"}rval+=iriSegments.join("/");if(rel.query!==
null)rval+="?"+rel.query;if(rel.fragment!==null)rval+="#"+rel.fragment;if(rval==="")rval="./";return rval}function _getInitialContext(options){var base=jsonld.url.parse(options.base||"");return{"@base":base,mappings:{},inverse:null,getInverse:_createInverseContext,clone:_cloneActiveContext};function _createInverseContext(){var activeCtx=this;if(activeCtx.inverse)return activeCtx.inverse;var inverse=activeCtx.inverse={};var defaultLanguage=activeCtx["@language"]||"@none";var mappings=activeCtx.mappings;
var terms=Object.keys(mappings).sort(_compareShortestLeast);for(var i=0;i<terms.length;++i){var term=terms[i];var mapping=mappings[term];if(mapping===null)continue;var container=mapping["@container"]||"@none";var ids=mapping["@id"];if(!_isArray(ids))ids=[ids];for(var ii=0;ii<ids.length;++ii){var iri=ids[ii];var entry=inverse[iri];if(!entry)inverse[iri]=entry={};if(!entry[container])entry[container]={"@language":{},"@type":{}};entry=entry[container];if(mapping.reverse)_addPreferredTerm(mapping,term,
entry["@type"],"@reverse");else if("@type"in mapping)_addPreferredTerm(mapping,term,entry["@type"],mapping["@type"]);else if("@language"in mapping){var language=mapping["@language"]||"@null";_addPreferredTerm(mapping,term,entry["@language"],language)}else{_addPreferredTerm(mapping,term,entry["@language"],defaultLanguage);_addPreferredTerm(mapping,term,entry["@type"],"@none");_addPreferredTerm(mapping,term,entry["@language"],"@none")}}}return inverse}function _addPreferredTerm(mapping,term,entry,typeOrLanguageValue){if(!(typeOrLanguageValue in
entry))entry[typeOrLanguageValue]=term}function _cloneActiveContext(){var child={};child["@base"]=this["@base"];child.mappings=_clone(this.mappings);child.clone=this.clone;child.inverse=null;child.getInverse=this.getInverse;if("@language"in this)child["@language"]=this["@language"];if("@vocab"in this)child["@vocab"]=this["@vocab"];return child}}function _isKeyword(v){if(!_isString(v))return false;switch(v){case "@base":case "@context":case "@container":case "@default":case "@embed":case "@explicit":case "@graph":case "@id":case "@index":case "@language":case "@list":case "@omitDefault":case "@preserve":case "@requireAll":case "@reverse":case "@set":case "@type":case "@value":case "@vocab":return true}return false}
function _isObject(v){return Object.prototype.toString.call(v)==="[object Object]"}function _isEmptyObject(v){return _isObject(v)&&Object.keys(v).length===0}function _isArray(v){return Array.isArray(v)}function _validateTypeValue(v){if(_isString(v)||_isEmptyObject(v))return;var isValid=false;if(_isArray(v)){isValid=true;for(var i=0;i<v.length;++i)if(!_isString(v[i])){isValid=false;break}}if(!isValid)throw new JsonLdError('Invalid JSON-LD syntax; "@type" value must a string, an array of '+"strings, or an empty object.",
"jsonld.SyntaxError",{code:"invalid type value",value:v});}function _isString(v){return typeof v==="string"||Object.prototype.toString.call(v)==="[object String]"}function _isNumber(v){return typeof v==="number"||Object.prototype.toString.call(v)==="[object Number]"}function _isDouble(v){return _isNumber(v)&&String(v).indexOf(".")!==-1}function _isNumeric(v){return!isNaN(parseFloat(v))&&isFinite(v)}function _isBoolean(v){return typeof v==="boolean"||Object.prototype.toString.call(v)==="[object Boolean]"}
function _isUndefined(v){return typeof v==="undefined"}function _isSubject(v){var rval=false;if(_isObject(v)&&!("@value"in v||"@set"in v||"@list"in v)){var keyCount=Object.keys(v).length;rval=keyCount>1||!("@id"in v)}return rval}function _isSubjectReference(v){return _isObject(v)&&Object.keys(v).length===1&&"@id"in v}function _isValue(v){return _isObject(v)&&"@value"in v}function _isList(v){return _isObject(v)&&"@list"in v}function _isBlankNode(v){var rval=false;if(_isObject(v))if("@id"in v)rval=
v["@id"].indexOf("_:")===0;else rval=Object.keys(v).length===0||!("@value"in v||"@set"in v||"@list"in v);return rval}function _isAbsoluteIri(v){return _isString(v)&&v.indexOf(":")!==-1}function _clone(value){if(value&&typeof value==="object"){var rval;if(_isArray(value)){rval=[];for(var i=0;i<value.length;++i)rval[i]=_clone(value[i])}else if(_isObject(value)){rval={};for(var key in value)rval[key]=_clone(value[key])}else rval=value.toString();return rval}return value}function _findContextUrls(input,
urls,replace,base){var count=Object.keys(urls).length;if(_isArray(input)){for(var i=0;i<input.length;++i)_findContextUrls(input[i],urls,replace,base);return count<Object.keys(urls).length}else if(_isObject(input)){for(var key in input){if(key!=="@context"){_findContextUrls(input[key],urls,replace,base);continue}var ctx=input[key];if(_isArray(ctx)){var length=ctx.length;for(var i=0;i<length;++i){var _ctx=ctx[i];if(_isString(_ctx)){_ctx=_prependBase(base,_ctx);if(replace){_ctx=urls[_ctx];if(_isArray(_ctx)){Array.prototype.splice.apply(ctx,
[i,1].concat(_ctx));i+=_ctx.length-1;length=ctx.length}else ctx[i]=_ctx}else if(!(_ctx in urls))urls[_ctx]=false}}}else if(_isString(ctx)){ctx=_prependBase(base,ctx);if(replace)input[key]=urls[ctx];else if(!(ctx in urls))urls[ctx]=false}}return count<Object.keys(urls).length}return false}function _retrieveContextUrls(input,options,callback){var error=null;var documentLoader=options.documentLoader;var retrieve=function(input,cycles,documentLoader,base,callback){if(Object.keys(cycles).length>MAX_CONTEXT_URLS){error=
new JsonLdError("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:MAX_CONTEXT_URLS});return callback(error)}var urls={};var finished=function(){_findContextUrls(input,urls,true,base);callback(null,input)};if(!_findContextUrls(input,urls,false,base))finished();var queue=[];for(var url in urls)if(urls[url]===false)queue.push(url);var count=queue.length;for(var i=0;i<queue.length;++i)(function(url){if(url in cycles){error=new JsonLdError("Cyclical @context URLs detected.",
"jsonld.ContextUrlError",{code:"recursive context inclusion",url:url});return callback(error)}var _cycles=_clone(cycles);_cycles[url]=true;var done=function(err,remoteDoc){if(error)return;var ctx=remoteDoc?remoteDoc.document:null;if(!err&&_isString(ctx))try{ctx=JSON.parse(ctx)}catch(ex){err=ex}if(err)err=new JsonLdError("Dereferencing a URL did not result in a valid JSON-LD object. "+"Possible causes are an inaccessible URL perhaps due to "+"a same-origin policy (ensure the server uses CORS if you are "+
"using client-side JavaScript), too many redirects, a "+"non-JSON response, or more than one HTTP Link Header was "+"provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:url,cause:err});else if(!_isObject(ctx))err=new JsonLdError("Dereferencing a URL did not result in a JSON object. The "+"response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:url,cause:err});if(err){error=err;return callback(error)}if(!("@context"in
ctx))ctx={"@context":{}};else ctx={"@context":ctx["@context"]};if(remoteDoc.contextUrl){if(!_isArray(ctx["@context"]))ctx["@context"]=[ctx["@context"]];ctx["@context"].push(remoteDoc.contextUrl)}retrieve(ctx,_cycles,documentLoader,url,function(err,ctx){if(err)return callback(err);urls[url]=ctx["@context"];count-=1;if(count===0)finished()})};var promise=documentLoader(url,done);if(promise&&"then"in promise)promise.then(done.bind(null,null),done)})(queue[i])};retrieve(input,{},documentLoader,options.base,
callback)}if(!Object.keys)Object.keys=function(o){if(o!==Object(o))throw new TypeError("Object.keys called on non-object");var rval=[];for(var p in o)if(Object.prototype.hasOwnProperty.call(o,p))rval.push(p);return rval};function _parseNQuads(input){var iri="(?:<([^:]+:[^>]*)>)";var bnode="(_:(?:[A-Za-z0-9]+))";var plain='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"';var datatype="(?:\\^\\^"+iri+")";var language="(?:@([a-z]+(?:-[a-z0-9]+)*))";var literal="(?:"+plain+"(?:"+datatype+"|"+language+")?)";var ws="[ \\t]+";
var wso="[ \\t]*";var eoln=/(?:\r\n)|(?:\n)|(?:\r)/g;var empty=new RegExp("^"+wso+"$");var subject="(?:"+iri+"|"+bnode+")"+ws;var property=iri+ws;var object="(?:"+iri+"|"+bnode+"|"+literal+")"+wso;var graphName="(?:\\.|(?:(?:"+iri+"|"+bnode+")"+wso+"\\.))";var quad=new RegExp("^"+wso+subject+property+object+graphName+wso+"$");var dataset={};var lines=input.split(eoln);var lineNumber=0;for(var li=0;li<lines.length;++li){var line=lines[li];lineNumber++;if(empty.test(line))continue;var match=line.match(quad);
if(match===null)throw new JsonLdError("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:lineNumber});var triple={};if(!_isUndefined(match[1]))triple.subject={type:"IRI",value:match[1]};else triple.subject={type:"blank node",value:match[2]};triple.predicate={type:"IRI",value:match[3]};if(!_isUndefined(match[4]))triple.object={type:"IRI",value:match[4]};else if(!_isUndefined(match[5]))triple.object={type:"blank node",value:match[5]};else{triple.object={type:"literal"};if(!_isUndefined(match[7]))triple.object.datatype=
match[7];else if(!_isUndefined(match[8])){triple.object.datatype=RDF_LANGSTRING;triple.object.language=match[8]}else triple.object.datatype=XSD_STRING;var unescaped=match[6].replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");triple.object.value=unescaped}var name="@default";if(!_isUndefined(match[9]))name=match[9];else if(!_isUndefined(match[10]))name=match[10];if(!(name in dataset))dataset[name]=[triple];else{var unique=true;var triples=dataset[name];
for(var ti=0;unique&&ti<triples.length;++ti)if(_compareRDFTriples(triples[ti],triple))unique=false;if(unique)triples.push(triple)}}return dataset}jsonld.registerRDFParser("application/nquads",_parseNQuads);function _toNQuads(dataset){var quads=[];for(var graphName in dataset){var triples=dataset[graphName];for(var ti=0;ti<triples.length;++ti){var triple=triples[ti];if(graphName==="@default")graphName=null;quads.push(_toNQuad(triple,graphName))}}quads.sort();return quads.join("")}function _toNQuad(triple,
graphName,bnode){var s=triple.subject;var p=triple.predicate;var o=triple.object;var g=graphName;var quad="";if(s.type==="IRI")quad+="<"+s.value+">";else if(bnode)quad+=s.value===bnode?"_:a":"_:z";else quad+=s.value;quad+=" ";if(p.type==="IRI")quad+="<"+p.value+">";else if(bnode)quad+="_:p";else quad+=p.value;quad+=" ";if(o.type==="IRI")quad+="<"+o.value+">";else if(o.type==="blank node")if(bnode)quad+=o.value===bnode?"_:a":"_:z";else quad+=o.value;else{var escaped=o.value.replace(/\\/g,"\\\\").replace(/\t/g,
"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"');quad+='"'+escaped+'"';if(o.datatype===RDF_LANGSTRING){if(o.language)quad+="@"+o.language}else if(o.datatype!==XSD_STRING)quad+="^^<"+o.datatype+">"}if(g!==null)if(g.indexOf("_:")!==0)quad+=" <"+g+">";else if(bnode)quad+=" _:g";else quad+=" "+g;quad+=" .\n";return quad}function _parseRdfaApiData(data){var dataset={};dataset["@default"]=[];var subjects=data.getSubjects();for(var si=0;si<subjects.length;++si){var subject=subjects[si];
if(subject===null)continue;var triples=data.getSubjectTriples(subject);if(triples===null)continue;var predicates=triples.predicates;for(var predicate in predicates){var objects=predicates[predicate].objects;for(var oi=0;oi<objects.length;++oi){var object=objects[oi];var triple={};if(subject.indexOf("_:")===0)triple.subject={type:"blank node",value:subject};else triple.subject={type:"IRI",value:subject};if(predicate.indexOf("_:")===0)triple.predicate={type:"blank node",value:predicate};else triple.predicate=
{type:"IRI",value:predicate};var value=object.value;if(object.type===RDF_XML_LITERAL){if(!XMLSerializer)_defineXMLSerializer();var serializer=new XMLSerializer;value="";for(var x=0;x<object.value.length;x++)if(object.value[x].nodeType===Node.ELEMENT_NODE)value+=serializer.serializeToString(object.value[x]);else if(object.value[x].nodeType===Node.TEXT_NODE)value+=object.value[x].nodeValue}triple.object={};if(object.type===RDF_OBJECT)if(object.value.indexOf("_:")===0)triple.object.type="blank node";
else triple.object.type="IRI";else{triple.object.type="literal";if(object.type===RDF_PLAIN_LITERAL)if(object.language){triple.object.datatype=RDF_LANGSTRING;triple.object.language=object.language}else triple.object.datatype=XSD_STRING;else triple.object.datatype=object.type}triple.object.value=value;dataset["@default"].push(triple)}}}return dataset}jsonld.registerRDFParser("rdfa-api",_parseRdfaApiData);function UniqueNamer(prefix){this.prefix=prefix;this.counter=0;this.existing={}}jsonld.UniqueNamer=
UniqueNamer;UniqueNamer.prototype.clone=function(){var copy=new UniqueNamer(this.prefix);copy.counter=this.counter;copy.existing=_clone(this.existing);return copy};UniqueNamer.prototype.getName=function(oldName){if(oldName&&oldName in this.existing)return this.existing[oldName];var name=this.prefix+this.counter;this.counter+=1;if(oldName)this.existing[oldName]=name;return name};UniqueNamer.prototype.isNamed=function(oldName){return oldName in this.existing};var Permutator=function(list){this.list=
list.sort();this.done=false;this.left={};for(var i=0;i<list.length;++i)this.left[list[i]]=true};Permutator.prototype.hasNext=function(){return!this.done};Permutator.prototype.next=function(){var rval=this.list.slice();var k=null;var pos=0;var length=this.list.length;for(var i=0;i<length;++i){var element=this.list[i];var left=this.left[element];if((k===null||element>k)&&(left&&i>0&&element>this.list[i-1]||!left&&i<length-1&&element>this.list[i+1])){k=element;pos=i}}if(k===null)this.done=true;else{var swap=
this.left[k]?pos-1:pos+1;this.list[pos]=this.list[swap];this.list[swap]=k;for(var i=0;i<length;++i)if(this.list[i]>k)this.left[this.list[i]]=!this.left[this.list[i]]}return rval};var sha1=jsonld.sha1={};if(_nodejs){var crypto=_dereq_("crypto");sha1.create=function(){var md=crypto.createHash("sha1");return{update:function(data){md.update(data,"utf8")},digest:function(){return md.digest("hex")}}}}else sha1.create=function(){return new sha1.MessageDigest};sha1.hash=function(nquads){var md=sha1.create();
for(var i=0;i<nquads.length;++i)md.update(nquads[i]);return md.digest()};if(!_nodejs){sha1.Buffer=function(){this.data="";this.read=0};sha1.Buffer.prototype.putInt32=function(i){this.data+=String.fromCharCode(i>>24&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i&255)};sha1.Buffer.prototype.getInt32=function(){var rval=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+
3);this.read+=4;return rval};sha1.Buffer.prototype.bytes=function(){return this.data.slice(this.read)};sha1.Buffer.prototype.length=function(){return this.data.length-this.read};sha1.Buffer.prototype.compact=function(){this.data=this.data.slice(this.read);this.read=0};sha1.Buffer.prototype.toHex=function(){var rval="";for(var i=this.read;i<this.data.length;++i){var b=this.data.charCodeAt(i);if(b<16)rval+="0";rval+=b.toString(16)}return rval};sha1.MessageDigest=function(){if(!_sha1.initialized)_sha1.init();
this.blockLength=64;this.digestLength=20;this.messageLength=0;this.input=new sha1.Buffer;this.words=new Array(80);this.state={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520}};sha1.MessageDigest.prototype.update=function(msg){msg=unescape(encodeURIComponent(msg));this.messageLength+=msg.length;this.input.data+=msg;_sha1.update(this.state,this.words,this.input);if(this.input.read>2048||this.input.length()===0)this.input.compact()};sha1.MessageDigest.prototype.digest=function(){var len=
this.messageLength;var padBytes=new sha1.Buffer;padBytes.data+=this.input.bytes();padBytes.data+=_sha1.padding.substr(0,64-(len+8)%64);padBytes.putInt32(len>>>29&255);padBytes.putInt32(len<<3&4294967295);_sha1.update(this.state,this.words,padBytes);var rval=new sha1.Buffer;rval.putInt32(this.state.h0);rval.putInt32(this.state.h1);rval.putInt32(this.state.h2);rval.putInt32(this.state.h3);rval.putInt32(this.state.h4);return rval.toHex()};var _sha1={padding:null,initialized:false};_sha1.init=function(){_sha1.padding=
String.fromCharCode(128);var c=String.fromCharCode(0);var n=64;while(n>0){if(n&1)_sha1.padding+=c;n>>>=1;if(n>0)c+=c}_sha1.initialized=true};_sha1.update=function(s,w,input){var t,a,b,c,d,e,f,i;var len=input.length();while(len>=64){a=s.h0;b=s.h1;c=s.h2;d=s.h3;e=s.h4;for(i=0;i<16;++i){t=input.getInt32();w[i]=t;f=d^b&(c^d);t=(a<<5|a>>>27)+f+e+1518500249+t;e=d;d=c;c=b<<30|b>>>2;b=a;a=t}for(;i<20;++i){t=w[i-3]^w[i-8]^w[i-14]^w[i-16];t=t<<1|t>>>31;w[i]=t;f=d^b&(c^d);t=(a<<5|a>>>27)+f+e+1518500249+t;e=
d;d=c;c=b<<30|b>>>2;b=a;a=t}for(;i<32;++i){t=w[i-3]^w[i-8]^w[i-14]^w[i-16];t=t<<1|t>>>31;w[i]=t;f=b^c^d;t=(a<<5|a>>>27)+f+e+1859775393+t;e=d;d=c;c=b<<30|b>>>2;b=a;a=t}for(;i<40;++i){t=w[i-6]^w[i-16]^w[i-28]^w[i-32];t=t<<2|t>>>30;w[i]=t;f=b^c^d;t=(a<<5|a>>>27)+f+e+1859775393+t;e=d;d=c;c=b<<30|b>>>2;b=a;a=t}for(;i<60;++i){t=w[i-6]^w[i-16]^w[i-28]^w[i-32];t=t<<2|t>>>30;w[i]=t;f=b&c|d&(b^c);t=(a<<5|a>>>27)+f+e+2400959708+t;e=d;d=c;c=b<<30|b>>>2;b=a;a=t}for(;i<80;++i){t=w[i-6]^w[i-16]^w[i-28]^w[i-32];
t=t<<2|t>>>30;w[i]=t;f=b^c^d;t=(a<<5|a>>>27)+f+e+3395469782+t;e=d;d=c;c=b<<30|b>>>2;b=a;a=t}s.h0+=a;s.h1+=b;s.h2+=c;s.h3+=d;s.h4+=e;len-=64}}}if(!XMLSerializer)var _defineXMLSerializer=function(){XMLSerializer=_dereq_("xmldom").XMLSerializer};jsonld.url={};jsonld.url.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password",
"hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}};jsonld.url.parse=function(str,parser){var parsed={};var o=jsonld.url.parsers[parser||"full"];var m=o.regex.exec(str);var i=o.keys.length;while(i--)parsed[o.keys[i]]=m[i]===undefined?null:m[i];parsed.normalizedPath=_removeDotSegments(parsed.path,!!parsed.authority);return parsed};function _removeDotSegments(path,
hasAuthority){var rval="";if(path.indexOf("/")===0)rval="/";var input=path.split("/");var output=[];while(input.length>0){if(input[0]==="."||input[0]===""&&input.length>1){input.shift();continue}if(input[0]===".."){input.shift();if(hasAuthority||output.length>0&&output[output.length-1]!=="..")output.pop();else output.push("..");continue}output.push(input.shift())}return rval+output.join("/")}if(_nodejs)jsonld.useDocumentLoader("node");else if(typeof XMLHttpRequest!=="undefined")jsonld.useDocumentLoader("xhr");
if(_nodejs){jsonld.use=function(extension){switch(extension){case "request":jsonld.request=_dereq_("./request");break;default:throw new JsonLdError("Unknown extension.","jsonld.UnknownExtension",{extension:extension});}};var _module={exports:{},filename:__dirname};_dereq_("pkginfo")(_module,"version");jsonld.version=_module.exports.version}return jsonld};var factory=function(){return wrapper(function(){return factory()})};if(!_nodejs&&(typeof define==="function"&&define.amd))define([],function(){wrapper(factory);
return factory});else{wrapper(factory);if(typeof _dereq_==="function"&&typeof module!=="undefined"&&module.exports)module.exports=factory;if(_browser)if(typeof jsonld==="undefined")jsonld=jsonldjs=factory;else jsonldjs=factory}return factory})()}).call(this,_dereq_("VCmEsw"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},"/..\\node_modules\\jsonld\\js")},{"./request":31,"VCmEsw":13,"crypto":31,"es6-promise":33,"http":31,"pkginfo":34,"request":31,"util":31,"xmldom":31}],33:[function(_dereq_,
module,exports){(function(process,global){(function(){function $$utils$$objectOrFunction(x){return typeof x==="function"||typeof x==="object"&&x!==null}function $$utils$$isFunction(x){return typeof x==="function"}function $$utils$$isMaybeThenable(x){return typeof x==="object"&&x!==null}var $$utils$$_isArray;if(!Array.isArray)$$utils$$_isArray=function(x){return Object.prototype.toString.call(x)==="[object Array]"};else $$utils$$_isArray=Array.isArray;var $$utils$$isArray=$$utils$$_isArray;var $$utils$$now=
Date.now||function(){return(new Date).getTime()};function $$utils$$F(){}var $$utils$$o_create=Object.create||function(o){if(arguments.length>1)throw new Error("Second argument not supported");if(typeof o!=="object")throw new TypeError("Argument must be an object");$$utils$$F.prototype=o;return new $$utils$$F};var $$asap$$len=0;var $$asap$$default=function asap(callback,arg){$$asap$$queue[$$asap$$len]=callback;$$asap$$queue[$$asap$$len+1]=arg;$$asap$$len+=2;if($$asap$$len===2)$$asap$$scheduleFlush()};
var $$asap$$browserGlobal=typeof window!=="undefined"?window:{};var $$asap$$BrowserMutationObserver=$$asap$$browserGlobal.MutationObserver||$$asap$$browserGlobal.WebKitMutationObserver;var $$asap$$isWorker=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function $$asap$$useNextTick(){return function(){process.nextTick($$asap$$flush)}}function $$asap$$useMutationObserver(){var iterations=0;var observer=new $$asap$$BrowserMutationObserver($$asap$$flush);
var node=document.createTextNode("");observer.observe(node,{characterData:true});return function(){node.data=iterations=++iterations%2}}function $$asap$$useMessageChannel(){var channel=new MessageChannel;channel.port1.onmessage=$$asap$$flush;return function(){channel.port2.postMessage(0)}}function $$asap$$useSetTimeout(){return function(){setTimeout($$asap$$flush,1)}}var $$asap$$queue=new Array(1E3);function $$asap$$flush(){for(var i=0;i<$$asap$$len;i+=2){var callback=$$asap$$queue[i];var arg=$$asap$$queue[i+
1];callback(arg);$$asap$$queue[i]=undefined;$$asap$$queue[i+1]=undefined}$$asap$$len=0}var $$asap$$scheduleFlush;if(typeof process!=="undefined"&&{}.toString.call(process)==="[object process]")$$asap$$scheduleFlush=$$asap$$useNextTick();else if($$asap$$BrowserMutationObserver)$$asap$$scheduleFlush=$$asap$$useMutationObserver();else if($$asap$$isWorker)$$asap$$scheduleFlush=$$asap$$useMessageChannel();else $$asap$$scheduleFlush=$$asap$$useSetTimeout();function $$$internal$$noop(){}var $$$internal$$PENDING=
void 0;var $$$internal$$FULFILLED=1;var $$$internal$$REJECTED=2;var $$$internal$$GET_THEN_ERROR=new $$$internal$$ErrorObject;function $$$internal$$selfFullfillment(){return new TypeError("You cannot resolve a promise with itself")}function $$$internal$$cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function $$$internal$$getThen(promise){try{return promise.then}catch(error){$$$internal$$GET_THEN_ERROR.error=error;return $$$internal$$GET_THEN_ERROR}}function $$$internal$$tryThen(then,
value,fulfillmentHandler,rejectionHandler){try{then.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function $$$internal$$handleForeignThenable(promise,thenable,then){$$asap$$default(function(promise){var sealed=false;var error=$$$internal$$tryThen(then,thenable,function(value){if(sealed)return;sealed=true;if(thenable!==value)$$$internal$$resolve(promise,value);else $$$internal$$fulfill(promise,value)},function(reason){if(sealed)return;sealed=true;$$$internal$$reject(promise,reason)},
"Settle: "+(promise._label||" unknown promise"));if(!sealed&&error){sealed=true;$$$internal$$reject(promise,error)}},promise)}function $$$internal$$handleOwnThenable(promise,thenable){if(thenable._state===$$$internal$$FULFILLED)$$$internal$$fulfill(promise,thenable._result);else if(promise._state===$$$internal$$REJECTED)$$$internal$$reject(promise,thenable._result);else $$$internal$$subscribe(thenable,undefined,function(value){$$$internal$$resolve(promise,value)},function(reason){$$$internal$$reject(promise,
reason)})}function $$$internal$$handleMaybeThenable(promise,maybeThenable){if(maybeThenable.constructor===promise.constructor)$$$internal$$handleOwnThenable(promise,maybeThenable);else{var then=$$$internal$$getThen(maybeThenable);if(then===$$$internal$$GET_THEN_ERROR)$$$internal$$reject(promise,$$$internal$$GET_THEN_ERROR.error);else if(then===undefined)$$$internal$$fulfill(promise,maybeThenable);else if($$utils$$isFunction(then))$$$internal$$handleForeignThenable(promise,maybeThenable,then);else $$$internal$$fulfill(promise,
maybeThenable)}}function $$$internal$$resolve(promise,value){if(promise===value)$$$internal$$reject(promise,$$$internal$$selfFullfillment());else if($$utils$$objectOrFunction(value))$$$internal$$handleMaybeThenable(promise,value);else $$$internal$$fulfill(promise,value)}function $$$internal$$publishRejection(promise){if(promise._onerror)promise._onerror(promise._result);$$$internal$$publish(promise)}function $$$internal$$fulfill(promise,value){if(promise._state!==$$$internal$$PENDING)return;promise._result=
value;promise._state=$$$internal$$FULFILLED;if(promise._subscribers.length===0);else $$asap$$default($$$internal$$publish,promise)}function $$$internal$$reject(promise,reason){if(promise._state!==$$$internal$$PENDING)return;promise._state=$$$internal$$REJECTED;promise._result=reason;$$asap$$default($$$internal$$publishRejection,promise)}function $$$internal$$subscribe(parent,child,onFulfillment,onRejection){var subscribers=parent._subscribers;var length=subscribers.length;parent._onerror=null;subscribers[length]=
child;subscribers[length+$$$internal$$FULFILLED]=onFulfillment;subscribers[length+$$$internal$$REJECTED]=onRejection;if(length===0&&parent._state)$$asap$$default($$$internal$$publish,parent)}function $$$internal$$publish(promise){var subscribers=promise._subscribers;var settled=promise._state;if(subscribers.length===0)return;var child,callback,detail=promise._result;for(var i=0;i<subscribers.length;i+=3){child=subscribers[i];callback=subscribers[i+settled];if(child)$$$internal$$invokeCallback(settled,
child,callback,detail);else callback(detail)}promise._subscribers.length=0}function $$$internal$$ErrorObject(){this.error=null}var $$$internal$$TRY_CATCH_ERROR=new $$$internal$$ErrorObject;function $$$internal$$tryCatch(callback,detail){try{return callback(detail)}catch(e){$$$internal$$TRY_CATCH_ERROR.error=e;return $$$internal$$TRY_CATCH_ERROR}}function $$$internal$$invokeCallback(settled,promise,callback,detail){var hasCallback=$$utils$$isFunction(callback),value,error,succeeded,failed;if(hasCallback){value=
$$$internal$$tryCatch(callback,detail);if(value===$$$internal$$TRY_CATCH_ERROR){failed=true;error=value.error;value=null}else succeeded=true;if(promise===value){$$$internal$$reject(promise,$$$internal$$cannotReturnOwn());return}}else{value=detail;succeeded=true}if(promise._state!==$$$internal$$PENDING);else if(hasCallback&&succeeded)$$$internal$$resolve(promise,value);else if(failed)$$$internal$$reject(promise,error);else if(settled===$$$internal$$FULFILLED)$$$internal$$fulfill(promise,value);else if(settled===
$$$internal$$REJECTED)$$$internal$$reject(promise,value)}function $$$internal$$initializePromise(promise,resolver){try{resolver(function resolvePromise(value){$$$internal$$resolve(promise,value)},function rejectPromise(reason){$$$internal$$reject(promise,reason)})}catch(e){$$$internal$$reject(promise,e)}}function $$$enumerator$$makeSettledResult(state,position,value){if(state===$$$internal$$FULFILLED)return{state:"fulfilled",value:value};else return{state:"rejected",reason:value}}function $$$enumerator$$Enumerator(Constructor,
input,abortOnReject,label){this._instanceConstructor=Constructor;this.promise=new Constructor($$$internal$$noop,label);this._abortOnReject=abortOnReject;if(this._validateInput(input)){this._input=input;this.length=input.length;this._remaining=input.length;this._init();if(this.length===0)$$$internal$$fulfill(this.promise,this._result);else{this.length=this.length||0;this._enumerate();if(this._remaining===0)$$$internal$$fulfill(this.promise,this._result)}}else $$$internal$$reject(this.promise,this._validationError())}
$$$enumerator$$Enumerator.prototype._validateInput=function(input){return $$utils$$isArray(input)};$$$enumerator$$Enumerator.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")};$$$enumerator$$Enumerator.prototype._init=function(){this._result=new Array(this.length)};var $$$enumerator$$default=$$$enumerator$$Enumerator;$$$enumerator$$Enumerator.prototype._enumerate=function(){var length=this.length;var promise=this.promise;var input=this._input;for(var i=
0;promise._state===$$$internal$$PENDING&&i<length;i++)this._eachEntry(input[i],i)};$$$enumerator$$Enumerator.prototype._eachEntry=function(entry,i){var c=this._instanceConstructor;if($$utils$$isMaybeThenable(entry))if(entry.constructor===c&&entry._state!==$$$internal$$PENDING){entry._onerror=null;this._settledAt(entry._state,i,entry._result)}else this._willSettleAt(c.resolve(entry),i);else{this._remaining--;this._result[i]=this._makeResult($$$internal$$FULFILLED,i,entry)}};$$$enumerator$$Enumerator.prototype._settledAt=
function(state,i,value){var promise=this.promise;if(promise._state===$$$internal$$PENDING){this._remaining--;if(this._abortOnReject&&state===$$$internal$$REJECTED)$$$internal$$reject(promise,value);else this._result[i]=this._makeResult(state,i,value)}if(this._remaining===0)$$$internal$$fulfill(promise,this._result)};$$$enumerator$$Enumerator.prototype._makeResult=function(state,i,value){return value};$$$enumerator$$Enumerator.prototype._willSettleAt=function(promise,i){var enumerator=this;$$$internal$$subscribe(promise,
undefined,function(value){enumerator._settledAt($$$internal$$FULFILLED,i,value)},function(reason){enumerator._settledAt($$$internal$$REJECTED,i,reason)})};var $$promise$all$$default=function all(entries,label){return(new $$$enumerator$$default(this,entries,true,label)).promise};var $$promise$race$$default=function race(entries,label){var Constructor=this;var promise=new Constructor($$$internal$$noop,label);if(!$$utils$$isArray(entries)){$$$internal$$reject(promise,new TypeError("You must pass an array to race."));
return promise}var length=entries.length;function onFulfillment(value){$$$internal$$resolve(promise,value)}function onRejection(reason){$$$internal$$reject(promise,reason)}for(var i=0;promise._state===$$$internal$$PENDING&&i<length;i++)$$$internal$$subscribe(Constructor.resolve(entries[i]),undefined,onFulfillment,onRejection);return promise};var $$promise$resolve$$default=function resolve(object,label){var Constructor=this;if(object&&typeof object==="object"&&object.constructor===Constructor)return object;
var promise=new Constructor($$$internal$$noop,label);$$$internal$$resolve(promise,object);return promise};var $$promise$reject$$default=function reject(reason,label){var Constructor=this;var promise=new Constructor($$$internal$$noop,label);$$$internal$$reject(promise,reason);return promise};var $$es6$promise$promise$$counter=0;function $$es6$promise$promise$$needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function $$es6$promise$promise$$needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
}var $$es6$promise$promise$$default=$$es6$promise$promise$$Promise;function $$es6$promise$promise$$Promise(resolver){this._id=$$es6$promise$promise$$counter++;this._state=undefined;this._result=undefined;this._subscribers=[];if($$$internal$$noop!==resolver){if(!$$utils$$isFunction(resolver))$$es6$promise$promise$$needsResolver();if(!(this instanceof $$es6$promise$promise$$Promise))$$es6$promise$promise$$needsNew();$$$internal$$initializePromise(this,resolver)}}$$es6$promise$promise$$Promise.all=$$promise$all$$default;
$$es6$promise$promise$$Promise.race=$$promise$race$$default;$$es6$promise$promise$$Promise.resolve=$$promise$resolve$$default;$$es6$promise$promise$$Promise.reject=$$promise$reject$$default;$$es6$promise$promise$$Promise.prototype={constructor:$$es6$promise$promise$$Promise,then:function(onFulfillment,onRejection){var parent=this;var state=parent._state;if(state===$$$internal$$FULFILLED&&!onFulfillment||state===$$$internal$$REJECTED&&!onRejection)return this;var child=new this.constructor($$$internal$$noop);
var result=parent._result;if(state){var callback=arguments[state-1];$$asap$$default(function(){$$$internal$$invokeCallback(state,child,callback,result)})}else $$$internal$$subscribe(parent,child,onFulfillment,onRejection);return child},"catch":function(onRejection){return this.then(null,onRejection)}};var $$es6$promise$polyfill$$default=function polyfill(){var local;if(typeof global!=="undefined")local=global;else if(typeof window!=="undefined"&&window.document)local=window;else local=self;var es6PromiseSupport=
"Promise"in local&&"resolve"in local.Promise&&"reject"in local.Promise&&"all"in local.Promise&&"race"in local.Promise&&function(){var resolve;new local.Promise(function(r){resolve=r});return $$utils$$isFunction(resolve)}();if(!es6PromiseSupport)local.Promise=$$es6$promise$promise$$default};var es6$promise$umd$$ES6Promise={"Promise":$$es6$promise$promise$$default,"polyfill":$$es6$promise$polyfill$$default};if(typeof define==="function"&&define["amd"])define(function(){return es6$promise$umd$$ES6Promise});
else if(typeof module!=="undefined"&&module["exports"])module["exports"]=es6$promise$umd$$ES6Promise;else if(typeof this!=="undefined")this["ES6Promise"]=es6$promise$umd$$ES6Promise}).call(this)}).call(this,_dereq_("VCmEsw"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"VCmEsw":13}],34:[function(_dereq_,module,exports){(function(__dirname){var fs=_dereq_("fs"),path=_dereq_("path");var pkginfo=module.exports=function(pmodule,options){var args=[].slice.call(arguments,2).filter(function(arg){return typeof arg===
"string"});if(Array.isArray(options))options={include:options};else if(typeof options==="string")options={include:[options]};options=options||{};options.include=options.include||[];if(args.length>0)options.include=options.include.concat(args);var pkg=pkginfo.read(pmodule,options.dir).package;Object.keys(pkg).forEach(function(key){if(options.include.length>0&&!~options.include.indexOf(key))return;if(!pmodule.exports[key])pmodule.exports[key]=pkg[key]});return pkginfo};pkginfo.find=function(pmodule,
dir){if(!dir)dir=path.dirname(pmodule.filename);var files=fs.readdirSync(dir);if(~files.indexOf("package.json"))return path.join(dir,"package.json");if(dir==="/")throw new Error("Could not find package.json up from: "+dir);else if(!dir||dir===".")throw new Error("Cannot find package.json from unspecified directory");return pkginfo.find(pmodule,path.dirname(dir))};pkginfo.read=function(pmodule,dir){dir=pkginfo.find(pmodule,dir);var data=fs.readFileSync(dir).toString();return{dir:dir,package:JSON.parse(data)}};
pkginfo(module,{dir:__dirname,include:["version"],target:pkginfo})}).call(this,"/..\\node_modules\\jsonld\\node_modules\\pkginfo\\lib")},{"fs":1,"path":12}],35:[function(_dereq_,module,exports){var fromCharCode=String.fromCharCode;var immediately=typeof setImmediate==="function"?setImmediate:function setImmediate(func){setTimeout(func,0)};var escapeSequence=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g;var escapeReplacements={"\\":"\\","'":"'",'"':'"',"n":"\n","r":"\r","t":"\t","f":"\f",
"b":"\b","_":"_","~":"~",".":".","-":"-","!":"!","$":"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"};var illegalIriChars=/[\x00-\x20<>\\"\{\}\|\^\`]/;function N3Lexer(options){if(!(this instanceof N3Lexer))return new N3Lexer(options);if(options&&options.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var self=this;this._tokenize=this.tokenize;this.tokenize=function(input,callback){this._tokenize(input,function(error,
token){if(!error&&/IRI|prefixed|literal|langcode|type|\.|eof/.test(token.type))callback&&callback(error,token);else callback&&callback(error||self._syntaxError(token.type,callback=null))})}}}N3Lexer.prototype={_iri:/^<((?:[^>\\]|\\[uU])+)>/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>/,_unescapedString:/^"[^"\\]+"(?=[^"\\])/,_singleQuotedString:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,
_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=\.?[,;\s#()\[\]\{\}"'<])/,
_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=[.,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;:\s#()\[\]\{\}"'<])/,
_keyword:/^@[a-z]+(?=[\s#<:])/,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<:])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(callback,inputFinished){var input=this._input;while(true){var whiteSpaceMatch;while(whiteSpaceMatch=this._newline.exec(input))input=input.substr(whiteSpaceMatch[0].length,input.length),this._line++;if(whiteSpaceMatch=this._whitespace.exec(input))input=input.substr(whiteSpaceMatch[0].length,
input.length);if(this._endOfFile.test(input)){if(inputFinished)callback(input=null,{line:this._line,type:"eof",value:"",prefix:""});return this._input=input}var line=this._line,type="",value="",prefix="",firstChar=input[0],match=null,matchLength=0,unescaped,inconclusive=false;switch(firstChar){case "^":if(input.length===1)break;else if(input[1]!=="^")return reportSyntaxError(this);this._prevTokenType="^";input=input.substr(2);if(input[0]!=="<"){inconclusive=true;break}case "<":if(match=this._unescapedIri.exec(input)){type=
"IRI";value=match[1]}else if(match=this._iri.exec(input)){unescaped=this._unescape(match[1]);if(unescaped===null||illegalIriChars.test(unescaped))return reportSyntaxError(this);type="IRI";value=unescaped}break;case "_":if((match=this._blank.exec(input))||inputFinished&&(match=this._blank.exec(input+" "))){type="prefixed";prefix="_";value=match[1]}break;case '"':case "'":if(match=this._unescapedString.exec(input)){type="literal";value=match[0]}else if(match=this._singleQuotedString.exec(input)){unescaped=
this._unescape(match[0]);if(unescaped===null)return reportSyntaxError(this);type="literal";value=unescaped.replace(/^'|'$/g,'"')}else if(match=this._tripleQuotedString.exec(input)){unescaped=match[1]||match[2];this._line+=unescaped.split(/\r\n|\r|\n/).length-1;unescaped=this._unescape(unescaped);if(unescaped===null)return reportSyntaxError(this);type="literal";value=unescaped.replace(/^'|'$/g,'"')}break;case "@":if(this._prevTokenType==="literal"&&(match=this._langcode.exec(input))){type="langcode";
value=match[1]}else if(match=this._keyword.exec(input))type=match[0];break;case ".":if(input.length===1?inputFinished:input[1]<"0"||input[1]>"9"){type=".";matchLength=1;break}case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":case "+":case "-":if(match=this._number.exec(input)){type="literal";value='"'+match[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(match[1]?"double":/^[+\-]?\d+$/.test(match[0])?"integer":"decimal")}break;case "B":case "b":case "p":case "P":case "G":case "g":if(match=
this._sparqlKeyword.exec(input))type=match[0].toUpperCase();else inconclusive=true;break;case "f":case "t":if(match=this._boolean.exec(input)){type="literal";value='"'+match[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'}else inconclusive=true;break;case "a":if(match=this._shortPredicates.exec(input)){type="abbreviation";value="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}else inconclusive=true;break;case ",":case ";":case "[":case "]":case "(":case ")":case "{":case "}":matchLength=1;type=
firstChar;break;default:inconclusive=true}if(inconclusive)if((this._prevTokenType==="@prefix"||this._prevTokenType==="PREFIX")&&(match=this._prefix.exec(input))){type="prefix";value=match[1]||""}else if((match=this._prefixed.exec(input))||inputFinished&&(match=this._prefixed.exec(input+" "))){type="prefixed";prefix=match[1]||"";value=this._unescape(match[2])}if(this._prevTokenType==="^")type=type==="IRI"||type==="prefixed"?"type":"";if(!type)if(inputFinished||!/^'''|^"""/.test(input)&&/\n|\r/.test(input))return reportSyntaxError(this);
else return this._input=input;callback(null,{line:line,type:type,value:value,prefix:prefix});this._prevTokenType=type;input=input.substr(matchLength||match[0].length,input.length)}function reportSyntaxError(self){callback(self._syntaxError(/^\S*/.exec(input)[0]))}},_unescape:function(item){try{return item.replace(escapeSequence,function(sequence,unicode4,unicode8,escapedChar){var charCode;if(unicode4){charCode=parseInt(unicode4,16);if(isNaN(charCode))throw new Error;return fromCharCode(charCode)}else if(unicode8){charCode=
parseInt(unicode8,16);if(isNaN(charCode))throw new Error;if(charCode<=65535)return fromCharCode(charCode);return fromCharCode(55296+(charCode-=65536)/1024,56320+(charCode&1023))}else{var replacement=escapeReplacements[escapedChar];if(!replacement)throw new Error;return replacement}})}catch(error){return null}},_syntaxError:function(issue){this._input=null;return new Error('Syntax error: unexpected "'+issue+'" on line '+this._line+".")},tokenize:function(input,callback){var self=this;this._line=1;
if(typeof input==="string"){this._input=input;immediately(function(){self._tokenizeToEnd(callback,true)})}else{this._input="";if(!input||typeof input==="function"){this.addChunk=addChunk;this.end=end;if(!callback)callback=input}else{if(typeof input.setEncoding==="function")input.setEncoding("utf8");input.on("data",addChunk);input.on("end",end)}}function addChunk(data){if(self._input!==null){self._input+=data;self._tokenizeToEnd(callback,false)}}function end(){if(self._input!==null)self._tokenizeToEnd(callback,
true)}}};module.exports=N3Lexer},{}],36:[function(_dereq_,module,exports){var N3Lexer=_dereq_("./N3Lexer");var RDF_PREFIX="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDF_NIL=RDF_PREFIX+"nil",RDF_FIRST=RDF_PREFIX+"first",RDF_REST=RDF_PREFIX+"rest";var absoluteIRI=/:/,documentPart=/[^\/]*$/,rootIRI=/^(?:[^:]+:\/*)?[^\/]*/;var blankNodePrefix=0,blankNodeCount=0;function N3Parser(options){if(!(this instanceof N3Parser))return new N3Parser(options);this._tripleStack=[];this._graph=null;options=options||
{};if(!options.documentIRI){this._baseIRI=null;this._baseIRIPath=null}else{if(options.documentIRI.indexOf("#")>0)throw new Error("Invalid document IRI");this._baseIRI=options.documentIRI;this._baseIRIPath=this._baseIRI.replace(documentPart,"");this._baseIRIRoot=this._baseIRI.match(rootIRI)[0]}var format=typeof options.format==="string"&&options.format.match(/\w*$/)[0].toLowerCase(),isTurtle=format==="turtle",isTriG=format==="trig",isNTriples=/triple/.test(format),isNQuads=/quad/.test(format),isLineMode=
isNTriples||isNQuads;if(!(this._supportsNamedGraphs=!isTurtle))this._readPredicateOrNamedGraph=this._readPredicate;this._supportsQuads=!(isTurtle||isTriG||isNTriples);if(isLineMode){this._baseIRI="";this._resolveIRI=function(token){this._error("Disallowed relative IRI",token);return this._callback=noop,this._subject=null}}this._blankNodePrefix=typeof options.blankNodePrefix!=="string"?"":"_:"+options.blankNodePrefix.replace(/^_:/,"");this._lexer=options.lexer||new N3Lexer({lineMode:isLineMode})}N3Parser._resetBlankNodeIds=
function(){blankNodePrefix=blankNodeCount=0};N3Parser.prototype={_readInTopContext:function(token){switch(token.type){case "eof":if(this._graph!==null)return this._error("Unclosed graph",token);delete this._prefixes._;return this._callback(null,null,this._prefixes);case "@prefix":this._sparqlStyle=false;return this._readPrefix;case "PREFIX":this._sparqlStyle=true;return this._readPrefix;case "@base":this._sparqlStyle=false;return this._readBaseIRI;case "BASE":this._sparqlStyle=true;return this._readBaseIRI;
case "{":if(this._supportsNamedGraphs){this._graph="";this._subject=null;return this._readSubject}case "GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(token)}},_readSubject:function(token){this._predicate=null;switch(token.type){case "IRI":if(this._baseIRI===null||absoluteIRI.test(token.value))this._subject=token.value;else this._subject=this._resolveIRI(token);break;case "prefixed":var prefix=this._prefixes[token.prefix];if(prefix===undefined)return this._error('Undefined prefix "'+
token.prefix+':"',token);this._subject=prefix+token.value;break;case "[":this._subject="_:b"+blankNodeCount++;this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"});return this._readBlankNodeHead;case "(":this._tripleStack.push({subject:RDF_NIL,predicate:null,object:null,type:"list"});this._subject=null;return this._readListItem;case "}":return this._readPunctuation(token);default:return this._error("Expected subject but got "+token.type,token)}return this._readPredicateOrNamedGraph},
_readPredicate:function(token){var type=token.type;switch(type){case "IRI":case "abbreviation":if(this._baseIRI===null||absoluteIRI.test(token.value))this._predicate=token.value;else this._predicate=this._resolveIRI(token);break;case "prefixed":if(token.prefix==="_")return this._error("Disallowed blank node as predicate",token);else{var prefix=this._prefixes[token.prefix];if(prefix===undefined)return this._error('Undefined prefix "'+token.prefix+':"',token);this._predicate=prefix+token.value}break;
case ".":case "]":case "}":if(this._predicate===null)return this._error("Unexpected "+type,token);this._subject=null;return type==="]"?this._readBlankNodeTail(token):this._readPunctuation(token);case ";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',token)}return this._readObject},_readObject:function(token){switch(token.type){case "IRI":if(this._baseIRI===null||absoluteIRI.test(token.value))this._object=token.value;else this._object=this._resolveIRI(token);
break;case "prefixed":var prefix=this._prefixes[token.prefix];if(prefix===undefined)return this._error('Undefined prefix "'+token.prefix+':"',token);this._object=prefix+token.value;break;case "literal":this._object=token.value;return this._readDataTypeOrLang;case "[":var blank="_:b"+blankNodeCount++;this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:blank,type:"blank"});this._subject=blank;return this._readBlankNodeHead;case "(":this._tripleStack.push({subject:this._subject,
predicate:this._predicate,object:RDF_NIL,type:"list"});this._subject=null;return this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',token)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(token){return token.type==="{"?this._readGraph(token):this._readPredicate(token)},_readGraph:function(token){if(token.type!=="{")return this._error("Expected graph but got "+token.type,token);this._graph=this._subject,this._subject=null;return this._readSubject},
_readBlankNodeHead:function(token){if(token.type==="]"){this._subject=null;return this._readBlankNodeTail(token)}this._predicate=null;return this._readPredicate(token)},_readBlankNodeTail:function(token){if(token.type!=="]")return this._readBlankNodePunctuation(token);if(this._subject!==null)this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""});var triple=this._tripleStack.pop();this._subject=triple.subject;if(triple.object!==null){this._predicate=
triple.predicate;this._object=triple.object;return this._getTripleEndReader()}return this._predicate!==null?this._readPredicate:this._readPredicateOrNamedGraph},_readDataTypeOrLang:function(token){switch(token.type){case "type":var value;if(token.prefix==="")if(this._baseIRI===null||absoluteIRI.test(token.value))value=token.value;else value=this._resolveIRI(token);else{var prefix=this._prefixes[token.prefix];if(prefix===undefined)return this._error('Undefined prefix "'+token.prefix+':"',token);value=
prefix+token.value}this._object+="^^"+value;return this._getTripleEndReader();case "langcode":this._object+="@"+token.value.toLowerCase();return this._getTripleEndReader();default:return this._getTripleEndReader().call(this,token)}},_readListItem:function(token){var item=null,itemHead=null,prevItemHead=this._subject,stack=this._tripleStack,parentTriple=stack[stack.length-1],next=this._readListItem;switch(token.type){case "IRI":item=token.value;break;case "prefixed":var prefix=this._prefixes[token.prefix];
if(prefix===undefined)return this._error('Undefined prefix "'+token.prefix+':"',token);item=prefix+token.value;break;case "literal":item=token.value;next=this._readDataTypeOrLang;break;case "[":itemHead="_:b"+blankNodeCount++;item="_:b"+blankNodeCount++;stack.push({subject:itemHead,predicate:RDF_FIRST,object:item,type:"blank"});this._subject=item;next=this._readBlankNodeHead;break;case "(":itemHead="_:b"+blankNodeCount++;stack.push({subject:itemHead,predicate:RDF_FIRST,object:RDF_NIL,type:"list"});
this._subject=null;next=this._readListItem;break;case ")":stack.pop();if(stack.length!==0&&stack[stack.length-1].type==="list")this._callback(null,{subject:parentTriple.subject,predicate:parentTriple.predicate,object:parentTriple.object,graph:this._graph||""});this._subject=parentTriple.subject;if(parentTriple.predicate===null){next=this._readPredicate;if(parentTriple.subject===RDF_NIL)return next}else{this._predicate=parentTriple.predicate;this._object=parentTriple.object;next=this._getTripleEndReader();
if(parentTriple.object===RDF_NIL)return next}itemHead=RDF_NIL;break;default:return this._error('Expected list item instead of "'+token.type+'"',token)}if(itemHead===null)this._subject=itemHead="_:b"+blankNodeCount++;if(prevItemHead===null)if(parentTriple.object===RDF_NIL)parentTriple.object=itemHead;else parentTriple.subject=itemHead;else this._callback(null,{subject:prevItemHead,predicate:RDF_REST,object:itemHead,graph:this._graph||""});if(item!==null)this._callback(null,{subject:itemHead,predicate:RDF_FIRST,
object:item,graph:this._graph||""});return next},_readPunctuation:function(token){var next,subject=this._subject,graph=this._graph;switch(token.type){case "}":if(this._graph===null)return this._error("Unexpected graph closing",token);this._graph=null;case ".":this._subject=null;next=this._readInTopContext;break;case ";":next=this._readPredicate;break;case ",":next=this._readObject;break;case "IRI":if(this._supportsQuads&&this._graph===null){if(this._baseIRI===null||absoluteIRI.test(token.value))graph=
token.value;else graph=this._resolveIRI(token);subject=this._subject;next=this._readQuadPunctuation;break}case "prefixed":if(this._supportsQuads&&this._graph===null){var prefix=this._prefixes[token.prefix];if(prefix===undefined)return this._error('Undefined prefix "'+token.prefix+':"',token);graph=prefix+token.value;next=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',token)}if(subject!==null)this._callback(null,{subject:subject,predicate:this._predicate,
object:this._object,graph:graph||""});return next},_readBlankNodePunctuation:function(token){var next;switch(token.type){case ";":next=this._readPredicate;break;case ",":next=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',token)}this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""});return next},_readQuadPunctuation:function(token){if(token.type!==".")return this._error("Expected dot to follow quad",
token);return this._readInTopContext},_readPrefix:function(token){if(token.type!=="prefix")return this._error("Expected prefix to follow @prefix",token);this._prefix=token.value;return this._readPrefixIRI},_readPrefixIRI:function(token){if(token.type!=="IRI")return this._error('Expected IRI to follow prefix "'+this._prefix+':"',token);var prefixIRI;if(this._baseIRI===null||absoluteIRI.test(token.value))prefixIRI=token.value;else prefixIRI=this._resolveIRI(token);this._prefixes[this._prefix]=prefixIRI;
this._prefixCallback(this._prefix,prefixIRI);return this._readDeclarationPunctuation},_readBaseIRI:function(token){if(token.type!=="IRI")return this._error("Expected IRI to follow base declaration",token);if(token.value.indexOf("#")>0)return this._error("Invalid base IRI",token);if(this._baseIRI===null||absoluteIRI.test(token.value))this._baseIRI=token.value;else this._baseIRI=this._resolveIRI(token);this._baseIRIPath=this._baseIRI.replace(documentPart,"");this._baseIRIRoot=this._baseIRI.match(rootIRI)[0];
return this._readDeclarationPunctuation},_readNamedGraphLabel:function(token){switch(token.type){case "IRI":case "prefixed":return this._readSubject(token),this._readGraph;case "[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",token)}},_readNamedGraphBlankLabel:function(token){if(token.type!=="]")return this._error("Invalid graph label",token);this._subject="_:b"+blankNodeCount++;return this._readGraph},_readDeclarationPunctuation:function(token){if(this._sparqlStyle)return this._readInTopContext(token);
if(token.type!==".")return this._error("Expected declaration to end with a dot",token);return this._readInTopContext},_getTripleEndReader:function(){var stack=this._tripleStack;if(stack.length===0)return this._readPunctuation;switch(stack[stack.length-1].type){case "blank":return this._readBlankNodeTail;case "list":return this._readListItem}},_error:function(message,token){this._callback(new Error(message+" at line "+token.line+"."))},_resolveIRI:function(token){var iri=token.value;switch(iri[0]){case undefined:return this._baseIRI;
case "#":return this._baseIRI+iri;case "?":return this._baseIRI.replace(/(?:\?.*)?$/,iri);case "/":return this._baseIRIRoot+iri;default:return this._baseIRIPath+iri}},parse:function(input,tripleCallback,prefixCallback){this._readCallback=this._readInTopContext;this._prefixes=Object.create(null);this._prefixes._=this._blankNodePrefix||"_:b"+blankNodePrefix++ +"_";if(typeof input==="function")prefixCallback=tripleCallback,tripleCallback=input,input=null;this._callback=tripleCallback||noop;this._prefixCallback=
prefixCallback||noop;var self=this;this._lexer.tokenize(input,function(error,token){if(error!==null)self._callback(error),self._callback=noop;else if(self._readCallback!==undefined)self._readCallback=self._readCallback(token)});if(!input){this.addChunk=this._lexer.addChunk;this.end=this._lexer.end}}};function noop(){}module.exports=N3Parser},{"./N3Lexer":35}],37:[function(_dereq_,module,exports){var SparqlParser=_dereq_("./parser");var Utils=_dereq_("./utils");var _=Utils;function NonSupportedSparqlFeatureError(feature,
message){this.name="NonSupportedSparqlFeatureError";this.feature=feature;this.message=message||"SPARQL feature "+feature+" non supported"}NonSupportedSparqlFeatureError.prototype=new Error;NonSupportedSparqlFeatureError.constructor=NonSupportedSparqlFeatureError;function SparqlParserError(message){this.name=ParserError;this.message=message||"Error parsing SPARQL query"}SparqlParserError.prototype=new Error;SparqlParserError.constructor=SparqlParserError;AbstractQueryTree=function(){};AbstractQueryTree.prototype.parseQueryString=
function(query_string){return SparqlParser.parse(query_string)};AbstractQueryTree.prototype.parseExecutableUnit=function(executableUnit){if(executableUnit.kind==="select")return this.parseSelect(executableUnit);else if(executableUnit.kind==="ask")return this.parseSelect(executableUnit);else if(executableUnit.kind==="modify")return this.parseSelect(executableUnit);else if(executableUnit.kind==="construct")return this.parseSelect(executableUnit);else if(executableUnit.kind==="insertdata")return this.parseInsertData(executableUnit);
else if(executableUnit.kind==="deletedata")return this.parseInsertData(executableUnit);else if(executableUnit.kind==="load")return executableUnit;else if(executableUnit.kind==="clear")return executableUnit;else if(executableUnit.kind==="drop")return executableUnit;else if(executableUnit.kind==="create")return executableUnit;else throw new Error("unknown executable unit: "+executableUnit.kind);};AbstractQueryTree.prototype.parseSelect=function(syntaxTree){if(syntaxTree==null){console.log("error parsing query");
return null}else{var env={freshCounter:0};syntaxTree.pattern=this.build(syntaxTree.pattern,env);return syntaxTree}};AbstractQueryTree.prototype.parseInsertData=function(syntaxTree){if(syntaxTree==null){console.log("error parsing query");return null}else return syntaxTree};AbstractQueryTree.prototype.build=function(node,env){if(node.token==="groupgraphpattern")return this._buildGroupGraphPattern(node,env);else if(node.token==="basicgraphpattern"){var bgp={kind:"BGP",value:node.triplesContext};bgp=
AbstractQueryTree.translatePathExpressionsInBGP(bgp,env);return bgp}else if(node.token==="graphunionpattern"){var a=this.build(node.value[0],env);var b=this.build(node.value[1],env);return{kind:"UNION",value:[a,b]}}else if(node.token==="graphgraphpattern"){var c=this.build(node.value,env);return{kind:"GRAPH",value:c,graph:node.graph}}else if(node.token!=null)throw new NonSupportedSparqlFeatureError(node.token,"Non implemented SPARQL graph pattern: '"+node.token+"'");else throw new SparqlParserError("Error parsing graph pattern: '"+
JSON.stringify(node)+"'");};AbstractQueryTree.translatePathExpressionsInBGP=function(bgp,env){var pathExpression;var before=[],rest,bottomJoin;for(var i=0;i<bgp.value.length;i++)if(bgp.value[i].predicate&&bgp.value[i].predicate.token==="path"){pathExpression=bgp.value[i];rest=bgp.value.slice(i+1);var bgpTransformed=AbstractQueryTree.translatePathExpression(pathExpression,env);var optionalPattern=null;if(bgpTransformed.kind==="BGP")before=before.concat(bgpTransformed.value);else if(bgpTransformed.kind===
"ZERO_OR_MORE_PATH"||bgpTransformed.kind==="ONE_OR_MORE_PATH"){if(before.length>0)bottomJoin={kind:"JOIN",lvalue:{kind:"BGP",value:before},rvalue:bgpTransformed};else bottomJoin=bgpTransformed;if(bgpTransformed.kind==="ZERO_OR_MORE_PATH")if(bgpTransformed.y.token==="var"&&bgpTransformed.y.value.indexOf("fresh:")===0&&bgpTransformed.x.token==="var"&&bgpTransformed.x.value.indexOf("fresh:")===0)for(var j=0;j<bgp.value.length;j++){if(bgp.value[j].object&&bgp.value[j].object.token==="var"&&bgp.value[j].object.value===
bgpTransformed.x.value){optionalPattern=_.clone(bgp.value[j],true);optionalPattern.object=bgpTransformed.y}}else if(bgpTransformed.y.token==="var"&&bgpTransformed.y.value.indexOf("fresh:")===0)for(var j=0;j<bgp.value.length;j++)if(bgp.value[j].subject&&bgp.value[j].subject.token==="var"&&bgp.value[j].subject.value===bgpTransformed.y.value){optionalPattern=_.clone(bgp.value[j],true);optionalPattern.subject=bgpTransformed.x}if(rest.length>0){var rvalueJoin=AbstractQueryTree.translatePathExpressionsInBGP({kind:"BGP",
value:rest},env);if(optionalPattern!=null){var optionals=before.concat([optionalPattern]).concat(rest);return{kind:"UNION",value:[{kind:"JOIN",lvalue:bottomJoin,rvalue:rvalueJoin},{kind:"BGP",value:optionals}]}}else return{kind:"JOIN",lvalue:bottomJoin,rvalue:rvalueJoin}}else return bottomJoin}else return bgpTransformed}else before.push(bgp.value[i]);bgp.value=before;return bgp};AbstractQueryTree.translatePathExpression=function(pathExpression,env){if(pathExpression.predicate.kind==="element")if(pathExpression.predicate.modifier===
"+"){pathExpression.predicate.modifier=null;var expandedPath=AbstractQueryTree.translatePathExpression(pathExpression,env);return{kind:"ONE_OR_MORE_PATH",path:expandedPath,x:pathExpression.subject,y:pathExpression.object}}else if(pathExpression.predicate.modifier==="*"){pathExpression.predicate.modifier=null;var expandedPath=AbstractQueryTree.translatePathExpression(pathExpression,env);return{kind:"ZERO_OR_MORE_PATH",path:expandedPath,x:pathExpression.subject,y:pathExpression.object}}else{pathExpression.predicate=
pathExpression.predicate.value;return{kind:"BGP",value:[pathExpression]}}else if(pathExpression.predicate.kind==="sequence"){var currentSubject=pathExpression.subject;var lastObject=pathExpression.object;var currentGraph=pathExpression.graph;var nextObject,chain;var restTriples=[];for(var i=0;i<pathExpression.predicate.value.length;i++){if(i!=pathExpression.predicate.value.length-1){nextObject={token:"var",value:"fresh:"+env.freshCounter};env.freshCounter++}else nextObject=lastObject;chain={subject:currentSubject,
predicate:pathExpression.predicate.value[i],object:nextObject};if(currentGraph!=null)chain.graph=_.clone(currentGraph,true);restTriples.push(chain);if(i!=pathExpression.predicate.value.length-1)currentSubject=_.clone(nextObject,true)}var bgp={kind:"BGP",value:restTriples};return AbstractQueryTree.translatePathExpressionsInBGP(bgp,env)}else throw new NonSupportedSparqlFeatureError("Non supported path expression "+pathExpression.predicate.kind);};AbstractQueryTree.prototype._buildGroupGraphPattern=
function(node,env){var f=node.filters||[];var g={kind:"EMPTY_PATTERN"};for(var i=0;i<node.patterns.length;i++){var pattern=node.patterns[i];if(pattern.token==="optionalgraphpattern"){var parsedPattern=this.build(pattern.value,env);if(parsedPattern.kind==="FILTER")g={kind:"LEFT_JOIN",lvalue:g,rvalue:parsedPattern.value,filter:parsedPattern.filter};else g={kind:"LEFT_JOIN",lvalue:g,rvalue:parsedPattern,filter:true}}else{var parsedPattern=this.build(pattern,env);if(g.kind=="EMPTY_PATTERN")g=parsedPattern;
else g={kind:"JOIN",lvalue:g,rvalue:parsedPattern}}}if(f.length!=0)if(g.kind==="EMPTY_PATTERN")return{kind:"FILTER",filter:f,value:g};else if(g.kind==="LEFT_JOIN"&&g.filter===true)return{kind:"FILTER",filter:f,value:g};else if(g.kind==="LEFT_JOIN")return{kind:"FILTER",filter:f,value:g};else if(g.kind==="JOIN")return{kind:"FILTER",filter:f,value:g};else if(g.kind==="UNION")return{kind:"FILTER",filter:f,value:g};else if(g.kind==="GRAPH")return{kind:"FILTER",filter:f,value:g};else if(g.kind==="BGP")return{kind:"FILTER",
filter:f,value:g};else throw new Error("Unknow kind of algebra expression: "+g.kind);else return g};AbstractQueryTree.prototype.collectBasicTriples=function(aqt,acum){if(acum==null)acum=[];if(aqt.kind==="select")acum=this.collectBasicTriples(aqt.pattern,acum);else if(aqt.kind==="BGP")acum=acum.concat(aqt.value);else if(aqt.kind==="ZERO_OR_MORE_PATH")acum=this.collectBasicTriples(aqt.path);else if(aqt.kind==="UNION"){acum=this.collectBasicTriples(aqt.value[0],acum);acum=this.collectBasicTriples(aqt.value[1],
acum)}else if(aqt.kind==="GRAPH")acum=this.collectBasicTriples(aqt.value,acum);else if(aqt.kind==="LEFT_JOIN"||aqt.kind==="JOIN"){acum=this.collectBasicTriples(aqt.lvalue,acum);acum=this.collectBasicTriples(aqt.rvalue,acum)}else if(aqt.kind==="FILTER")acum=this.collectBasicTriples(aqt.value,acum);else if(aqt.kind==="construct")acum=this.collectBasicTriples(aqt.pattern,acum);else if(aqt.kind==="EMPTY_PATTERN");else throw"Unknown pattern: "+aqt.kind;return acum};AbstractQueryTree.prototype.bind=function(aqt,
bindings){if(aqt.graph!=null&&aqt.graph.token&&aqt.graph.token==="var"&&bindings[aqt.graph.value]!=null)aqt.graph=bindings[aqt.graph.value];if(aqt.filter!=null){var acum=[];for(var i=0;i<aqt.filter.length;i++){aqt.filter[i].value=this._bindFilter(aqt.filter[i].value,bindings);acum.push(aqt.filter[i])}aqt.filter=acum}if(aqt.kind==="select")aqt.pattern=this.bind(aqt.pattern,bindings);else if(aqt.kind==="BGP")aqt.value=this._bindTripleContext(aqt.value,bindings);else if(aqt.kind==="ZERO_OR_MORE_PATH"){aqt.path=
this._bindTripleContext(aqt.path,bindings);if(aqt.x&&aqt.x.token==="var"&&bindings[aqt.x.value]!=null)aqt.x=bindings[aqt.x.value];if(aqt.y&&aqt.y.token==="var"&&bindings[aqt.y.value]!=null)aqt.y=bindings[aqt.y.value]}else if(aqt.kind==="UNION"){aqt.value[0]=this.bind(aqt.value[0],bindings);aqt.value[1]=this.bind(aqt.value[1],bindings)}else if(aqt.kind==="GRAPH")aqt.value=this.bind(aqt.value,bindings);else if(aqt.kind==="LEFT_JOIN"||aqt.kind==="JOIN"){aqt.lvalue=this.bind(aqt.lvalue,bindings);aqt.rvalue=
this.bind(aqt.rvalue,bindings)}else if(aqt.kind==="FILTER")aqt.filter=this._bindFilter(aqt.filter[i].value,bindings);else if(aqt.kind==="EMPTY_PATTERN");else throw"Unknown pattern: "+aqt.kind;return aqt};AbstractQueryTree.prototype._bindTripleContext=function(triples,bindings){for(var i=0;i<triples.length;i++){delete triples[i]["graph"];delete triples[i]["variables"];for(var p in triples[i]){var comp=triples[i][p];if(comp.token==="var"&&bindings[comp.value]!=null)triples[i][p]=bindings[comp.value]}}return triples};
AbstractQueryTree.prototype._bindFilter=function(filterExpr,bindings){if(filterExpr.expressionType!=null){var expressionType=filterExpr.expressionType;if(expressionType=="relationalexpression"){filterExpr.op1=this._bindFilter(filterExpr.op1,bindings);filterExpr.op2=this._bindFilter(filterExpr.op2,bindings)}else if(expressionType=="conditionalor"||expressionType=="conditionaland")for(var i=0;i<filterExpr.operands.length;i++)filterExpr.operands[i]=this._bindFilter(filterExpr.operands[i],bindings);else if(expressionType==
"additiveexpression"){filterExpr.summand=this._bindFilter(filterExpr.summand,bindings);for(var i=0;i<filterExpr.summands.length;i++)filterExpr.summands[i].expression=this._bindFilter(filterExpr.summands[i].expression,bindings)}else if(expressionType=="builtincall")for(var i=0;i<filterExpr.args.length;i++)filterExpr.args[i]=this._bindFilter(filterExpr.args[i],bindings);else if(expressionType=="multiplicativeexpression"){filterExpr.factor=this._bindFilter(filterExpr.factor,bindings);for(var i=0;i<filterExpr.factors.length;i++)filterExpr.factors[i].expression=
this._bindFilter(filterExpr.factors[i].expression,bindings)}else if(expressionType=="unaryexpression")filterExpr.expression=this._bindFilter(filterExpr.expression,bindings);else if(expressionType=="irireforfunction")for(var i=0;i<filterExpr.factors.args;i++)filterExpr.args[i]=this._bindFilter(filterExpr.args[i],bindings);else if(expressionType=="atomic")if(filterExpr.primaryexpression=="var")if(bindings[filterExpr.value.value]!=null){var val=bindings[filterExpr.value.value];if(val.token==="uri")filterExpr.primaryexpression=
"iri";else filterExpr.primaryexpression="literal";filterExpr.value=val}}return filterExpr};AbstractQueryTree.prototype.replace=function(aqt,from,to,ns){if(aqt.graph!=null&&aqt.graph.token&&aqt.graph.token===from.token&&aqt.graph.value==from.value)aqt.graph=_.clone(to,true);if(aqt.filter!=null){var acum=[];for(var i=0;i<aqt.filter.length;i++){aqt.filter[i].value=this._replaceFilter(aqt.filter[i].value,from,to,ns);acum.push(aqt.filter[i])}aqt.filter=acum}if(aqt.kind==="select")aqt.pattern=this.replace(aqt.pattern,
from,to,ns);else if(aqt.kind==="BGP")aqt.value=this._replaceTripleContext(aqt.value,from,to,ns);else if(aqt.kind==="ZERO_OR_MORE_PATH"){aqt.path=this._replaceTripleContext(aqt.path,from,to,ns);if(aqt.x&&aqt.x.token===from.token&&aqt.value===from.value)aqt.x=_.clone(to,true);if(aqt.y&&aqt.y.token===from.token&&aqt.value===from.value)aqt.y=_.clone(to,true)}else if(aqt.kind==="UNION"){aqt.value[0]=this.replace(aqt.value[0],from,to,ns);aqt.value[1]=this.replace(aqt.value[1],from,to,ns)}else if(aqt.kind===
"GRAPH")aqt.value=this.replace(aqt.value,from,to);else if(aqt.kind==="LEFT_JOIN"||aqt.kind==="JOIN"){aqt.lvalue=this.replace(aqt.lvalue,from,to,ns);aqt.rvalue=this.replace(aqt.rvalue,from,to,ns)}else if(aqt.kind==="FILTER")aqt.value=this._replaceFilter(aqt.value,from,to,ns);else if(aqt.kind==="EMPTY_PATTERN");else throw"Unknown pattern: "+aqt.kind;return aqt};AbstractQueryTree.prototype._replaceTripleContext=function(triples,from,to,ns){for(var i=0;i<triples.length;i++)for(var p in triples[i]){var comp=
triples[i][p];if(comp.token==="var"&&from.token==="var"&&comp.value===from.value)triples[i][p]=to;else if(comp.token==="blank"&&from.token==="blank"&&comp.value===from.value)triples[i][p]=to;else if((comp.token==="literal"||comp.token==="uri")&&(from.token==="literal"||from.token==="uri")&&comp.token===from.token&&Utils.lexicalFormTerm(comp,ns)[comp.token]===Utils.lexicalFormTerm(from,ns)[comp.token])triples[i][p]=to}return triples};AbstractQueryTree.prototype._replaceFilter=function(filterExpr,from,
to,ns){if(filterExpr.expressionType!=null){var expressionType=filterExpr.expressionType;if(expressionType=="relationalexpression"){filterExpr.op1=this._replaceFilter(filterExpr.op1,from,to,ns);filterExpr.op2=this._replaceFilter(filterExpr.op2,from,to,ns)}else if(expressionType=="conditionalor"||expressionType=="conditionaland")for(var i=0;i<filterExpr.operands.length;i++)filterExpr.operands[i]=this._replaceFilter(filterExpr.operands[i],from,to,ns);else if(expressionType=="additiveexpression"){filterExpr.summand=
this._replaceFilter(filterExpr.summand,from,to,ns);for(var i=0;i<filterExpr.summands.length;i++)filterExpr.summands[i].expression=this._replaceFilter(filterExpr.summands[i].expression,from,to,ns)}else if(expressionType=="builtincall")for(var i=0;i<filterExpr.args.length;i++)filterExpr.args[i]=this._replaceFilter(filterExpr.args[i],from,to,ns);else if(expressionType=="multiplicativeexpression"){filterExpr.factor=this._replaceFilter(filterExpr.factor,from,to,ns);for(var i=0;i<filterExpr.factors.length;i++)filterExpr.factors[i].expression=
this._replaceFilter(filterExpr.factors[i].expression,from,to,ns)}else if(expressionType=="unaryexpression")filterExpr.expression=this._replaceFilter(filterExpr.expression,from,to,ns);else if(expressionType=="irireforfunction")for(var i=0;i<filterExpr.factors.args;i++)filterExpr.args[i]=this._replaceFilter(filterExpr.args[i],from,to,ns);else if(expressionType=="atomic"){var val=null;if(filterExpr.primaryexpression==from.token&&filterExpr.value==from.value)val=to.value;else if(filterExpr.primaryexpression==
"iri"&&from.token=="uri"&&filterExpr.value==from.value)val=to.value;if(val!=null){if(to.token==="uri")filterExpr.primaryexpression="iri";else filterExpr.primaryexpression=to.token;filterExpr.value=val}}}return filterExpr};AbstractQueryTree.prototype.treeWithUnion=function(aqt){if(aqt==null)return false;if(aqt.kind==null)return false;if(aqt.kind==="select")return this.treeWithUnion(aqt.pattern);else if(aqt.kind==="BGP")return this.treeWithUnion(aqt.value);else if(aqt.kind==="ZERO_OR_MORE_PATH")return false;
else if(aqt.kind==="UNION")if(aqt.value[0].value!=null&&aqt.value[0].value.variables!=null&&aqt.value[1].value!=null&&aqt.value[1].value.variables!=null){if(aqt.value[0].variables.join("/")===aqt.values[1].variables.join("/"))if(this.treeWithUnion(aqt.value[0]))return true;else return this.treeWithUnion(aqt.value[1])}else return true;else if(aqt.kind==="GRAPH")return false;else if(aqt.kind==="LEFT_JOIN"||aqt.kind==="JOIN"){var leftUnion=this.treeWithUnion(aqt.lvalue);if(leftUnion)return true;else this.treeWithUnion(aqt.rvalue)}else if(aqt.kind===
"FILTER")return false;else if(aqt.kind==="EMPTY_PATTERN")return false;else return false};module.exports={AbstractQueryTree:AbstractQueryTree,NonSupportedSparqlFeatureError:NonSupportedSparqlFeatureError,SparqlParserError:SparqlParserError}},{"./parser":44,"./utils":55}],38:[function(_dereq_,module,exports){var utils=_dereq_("./utils");var async=utils;var nextTick=utils.nextTick;var left=-1;var right=1;var Tree=function(order,f){if(arguments.length!=0){this.order=order;this.root=this._allocateNode();
this.root.isLeaf=true;this.root.level=0;var that=this;this._diskWrite(this.root,function(root){that.root=root;that._updateRootNode(that.root,function(n){that.comparator=function(a,b){if(a<b)return-1;else if(a>b)return 1;else return 0};that.merger=null;if(f!=null)f(that)})})}};Tree.prototype._allocateNode=function(){return new Node};Tree.prototype._diskWrite=function(node,f){nextTick(function(){f(node)})};Tree.prototype._diskRead=function(pointer,f){nextTick(function(){f(pointer)})};Tree.prototype._diskDelete=
function(node,f){nextTick(function(){f()})};Tree.prototype._updateRootNode=function(node,f){f(node)};Tree.prototype.search=function(key,f,checkExists){var node=this.root;var tree=this;tree.__search(tree,key,node,f,checkExists)};Tree.prototype.__search=function(tree,key,node,f,checkExists){var idx=0;while(idx<node.numberActives&&tree.comparator(key,node.keys[idx].key)===1)idx++;if(idx<node.numberActives&&tree.comparator(node.keys[idx].key,key)===0)if(checkExists!=null&&checkExists==true)f(true);else f(node.keys[idx].data);
else if(node.isLeaf===true)f(null);else tree._diskRead(node.children[idx],function(node){tree.__search(tree,key,node,f,checkExists)})};Tree.prototype.walk=function(f,e){this.__walk(this,this.root,f,e)};Tree.prototype.__walk=function(tree,node,f,callback){var max=node.numberActives;var i=0;if(node.isLeaf){for(i=0;i<node.numberActives;i++)f(node.keys[i]);return callback()}else async.whilst(function(){return i<max},function(c){tree._diskRead(node.children[i],function(n){tree.__walk(tree,n,f,function(){tree._diskRead(node.keys[i],
function(n){f(n);i++;c()})})})},function(){tree._diskRead(node.children[max],function(node){tree.__walk(tree,node,f,function(){callback()})})})};Tree.prototype.walkNodes=function(f){this.__walkNodes(this,root,f,function(){})};Tree.prototype.__walkNodes=function(tree,node,f,callback){if(node.isLeaf){f(node);return callback()}else{f(node);var max=node.numberActives;var i=0;async.whilst(function(){return i<max},function(c){tree._diskRead(node.children[i],function(n){tree.__walkNodes(tree,n,f,function(){i++;
c()})})},function(){tree._diskRead(node.children[max],function(n){tree.__walkNodes(tree,n,f,function(){})})})}};Tree.prototype._splitChild=function(parent,index,child,callback){var newChild=this._allocateNode();newChild.isLeaf=child.isLeaf;newChild.level=child.level;newChild.numberActives=this.order-1;var newParentChild=child.keys[this.order-1];child.keys[this.order-1]=null;for(var i=0;i<this.order-1;i++){newChild.keys[i]=child.keys[i+this.order];child.keys[i+this.order]=null;if(!child.isLeaf){newChild.children[i]=
child.children[i+this.order];child.children[i+this.order]=null}}if(!child.isLeaf){newChild.children[i]=child.children[i+this.order];child.children[i+this.order]=null}child.numberActives=this.order-1;for(i=parent.numberActives+1;i>index+1;i--)parent.children[i]=parent.children[i-1];parent.children[index+1]=newChild;for(i=parent.numberActives;i>index;i--)parent.keys[i]=parent.keys[i-1];parent.keys[index]=newParentChild;parent.numberActives++;var that=this;this._diskWrite(newChild,function(newChild){that._diskWrite(parent,
function(parent){parent.children[index+1]=newChild;that._diskWrite(child,function(child){return callback(parent)})})})};Tree.prototype.insert=function(key,data,callback){if(this.root.numberActives===2*this.order-1){var newRoot=this._allocateNode();newRoot.isLeaf=false;newRoot.level=this.root.level+1;newRoot.numberActives=0;newRoot.children[0]=this.root;var that=this;this._splitChild(newRoot,0,this.root,function(updatedParent){newRoot=updatedParent;that.root=newRoot;that._updateRootNode(newRoot,function(newRoot){that._insertNonFull(newRoot,
key,data,callback)})})}else this._insertNonFull(this.root,key,data,callback)};Tree.prototype._insertNonFull=function(node,key,data,callback){var idx=node.numberActives-1;this.__insertNonFull(this,node,idx,key,data,callback)};Tree.prototype.__insertNonFull=function(tree,node,idx,key,data,callback){if(!node.isLeaf){while(idx>=0&&tree.comparator(key,node.keys[idx].key)===-1)idx--;idx++;var that=tree;tree._diskRead(node.children[idx],function(child){if(child.numberActives===2*that.order-1)that._splitChild(node,
idx,child,function(){if(that.comparator(key,node.keys[idx].key)===1)idx++;that._diskRead(node.children[idx],function(node){idx=node.numberActives-1;that.__insertNonFull(tree,node,idx,key,data,callback)})});else that._diskRead(node.children[idx],function(node){idx=node.numberActives-1;that.__insertNonFull(tree,node,idx,key,data,callback)})})}else{while(idx>=0&&tree.comparator(key,node.keys[idx].key)===-1){node.keys[idx+1]=node.keys[idx];idx--}if(idx>=0&&tree.comparator(key,node.keys[idx].key)===0)node.keys[idx]=
{key:key,data:data};else{node.keys[idx+1]={key:key,data:data};node.numberActives++}tree._diskWrite(node,function(node){return callback(node)})}};Tree.prototype.delete=function(key,callback){var node=this.root;Tree.prototype.__deleteSearchNode(this,key,node,callback)};Tree.prototype.__deleteSearchNode=function(tree,key,node,callback){var i=0;if(node.numberActives===0)return callback(false);while(i<node.numberActives&&tree.comparator(key,node.keys[i].key)===1)i++;var idx=i;if(i<node.numberActives&&
tree.comparator(key,node.keys[i].key)===0)return tree.__deleteNodeFound(tree,idx,key,node,callback);if(node.isLeaf===true)return callback(false);var parent=node;tree._diskRead(node.children[i],function(node){if(node===null)return callback(false);var isLsiblingNull=false;var isRsiblingNull=false;var rsiblingIndex=null;var lsiblingIndex=null;if(idx===parent.numberActives){isRsiblingNull=true;lsiblingIndex=parent.children[idx-1];rsiblingIndex=parent.children[idx-1]}else if(idx===0){isLsiblingNull=true;
rsiblingIndex=parent.children[1];lsiblingIndex=parent.children[1]}else{lsiblingIndex=parent.children[idx-1];rsiblingIndex=parent.children[idx+1]}tree._diskRead(lsiblingIndex,function(lsibling){tree._diskRead(rsiblingIndex,function(rsibling){if(isRsiblingNull===true)rsibling=null;if(isLsiblingNull===true)lsibling=null;if(node.numberActives===tree.order-1&&parent!=null)if(rsibling!=null&&rsibling.numberActives>tree.order-1)tree._moveKey(parent,i,left,function(parent){tree.__deleteSearchNode(tree,key,
node,callback)});else if(lsibling!=null&&lsibling.numberActives>tree.order-1)tree._moveKey(parent,i,right,function(parent){tree.__deleteSearchNode(tree,key,node,callback)});else if(lsibling!=null&&lsibling.numberActives===tree.order-1)tree._mergeSiblings(parent,i,left,function(node){tree.__deleteSearchNode(tree,key,node,callback)});else{if(rsibling!=null&&rsibling.numberActives===tree.order-1)tree._mergeSiblings(parent,i,right,function(node){tree.__deleteSearchNode(tree,key,node,callback)})}else tree.__deleteSearchNode(tree,
key,node,callback)})})})};Tree.prototype.__deleteNodeFound=function(tree,idx,key,node,callback){if(node.isLeaf&&node.numberActives>tree.order-1){tree._deleteKeyFromNode(node,idx,function(){callback(true)});return true}if(node.isLeaf&&node===tree.root){tree._deleteKeyFromNode(node,idx,function(){callback(true)});return true}if(node.isLeaf===false)tree._diskRead(node.children[idx],function(tmpNode){if(tmpNode.numberActives>tree.order-1)tree._getMaxKeyPos(tree,tmpNode,function(subNodeIdx){key=subNodeIdx.node.keys[subNodeIdx.index];
node.keys[idx]=key;tree._diskWrite(node,function(node){node=tmpNode;key=key.key;tree.__deleteSearchNode(tree,key,node,callback)})});else tree._diskRead(node.children[idx+1],function(tmpNode2){if(tmpNode2.numberActives>tree.order-1)tree._getMinKeyPos(tree,tmpNode2,function(subNodeIdx){key=subNodeIdx.node.keys[subNodeIdx.index];node.keys[idx]=key;tree._diskWrite(node,function(node){node=tmpNode2;key=key.key;tree.__deleteSearchNode(tree,key,node,callback)})});else if(tmpNode.numberActives===tree.order-
1&&tmpNode2.numberActives===tree.order-1)tree._mergeNodes(tmpNode,node.keys[idx],tmpNode2,function(combNode){node.children[idx]=combNode;idx++;for(var i=idx;i<node.numberActives;i++){node.children[i]=node.children[i+1];node.keys[i-1]=node.keys[i]}node.children[i]=null;node.keys[i-1]=null;node.numberActives--;if(node.numberActives===0&&tree.root===node)tree.root=combNode;tree._diskWrite(node,function(node){tree.__deleteSearchNode(tree,key,combNode,callback)})})})});if(node.isLeaf&&node.numberActives>
tree.order-1)tree._deleteKeyFromNode(node,idx,function(node){tree.__deleteSearchNode(tree,key,node,callback)})};Tree.prototype._moveKey=function(parent,i,position,callback){if(position===right)i--;var that=this;that._diskRead(parent.children[i],function(lchild){that._diskRead(parent.children[i+1],function(rchild){if(position==left){lchild.keys[lchild.numberActives]=parent.keys[i];lchild.children[lchild.numberActives+1]=rchild.children[0];rchild.children[0]=null;lchild.numberActives++;parent.keys[i]=
rchild.keys[0];for(var _i=1;_i<rchild.numberActives;_i++){rchild.keys[_i-1]=rchild.keys[_i];rchild.children[_i-1]=rchild.children[_i]}rchild.children[rchild.numberActives-1]=rchild.children[rchild.numberActives];rchild.numberActives--}else{rchild.children[rchild.numberActives+1]=rchild.children[rchild.numberActives];for(var _i=rchild.numberActives;_i>0;_i--){rchild.children[_i]=rchild.children[_i-1];rchild.keys[_i]=rchild.keys[_i-1]}rchild.keys[0]=null;rchild.children[0]=null;rchild.children[0]=lchild.children[lchild.numberActives];
rchild.keys[0]=parent.keys[i];rchild.numberActives++;lchild.children[lchild.numberActives]=null;parent.keys[i]=lchild.keys[lchild.numberActives-1];lchild.keys[lchild.numberActives-1]=null;lchild.numberActives--}that._diskWrite(lchild,function(lchild){that._diskWrite(rchild,function(rchild){that._diskWrite(parent,function(parent){return callback(parent)})})})})})};Tree.prototype._mergeSiblings=function(parent,index,pos,callback){var i,j;var n1,n2;var tolookn1,tolookn2;if(index===parent.numberActives){index--;
tolookn1=parent.children[parent.numberActives-1];tolookn2=parent.children[parent.numberActives]}else{tolookn1=parent.children[index];tolookn2=parent.children[index+1]}var that=this;that._diskRead(tolookn1,function(n1){that._diskRead(tolookn2,function(n2){var newNode=that._allocateNode();newNode.isLeaf=n1.isLeaf;newNode.level=n1.level;for(j=0;j<that.order-1;j++){newNode.keys[j]=n1.keys[j];newNode.children[j]=n1.children[j]}newNode.keys[that.order-1]=parent.keys[index];newNode.children[that.order-1]=
n1.children[that.order-1];for(j=0;j<that.order-1;j++){newNode.keys[j+that.order]=n2.keys[j];newNode.children[j+that.order]=n2.children[j]}newNode.children[2*that.order-1]=n2.children[that.order-1];parent.children[index]=newNode;for(j=index;j<parent.numberActives;j++){parent.keys[j]=parent.keys[j+1];parent.children[j+1]=parent.children[j+2]}newNode.numberActives=n1.numberActives+n2.numberActives+1;parent.numberActives--;for(i=parent.numberActives;i<2*that.order-1;i++)parent.keys[i]=null;if(parent.numberActives===
0&&that.root===parent){that.root=newNode;if(newNode.level)newNode.isLeaf=false;else newNode.isLeaf=true}that._diskWrite(newNode,function(newNode){that._diskWrite(parent,function(parent){that._diskDelete(n1,function(){that._diskDelete(n2,function(){if(that.root===newNode)that._updateRootNode(that.root,function(){return callback(newNode)});else return callback(newNode)})})})})})})};Tree.prototype._deleteKeyFromNode=function(node,index,callback){var keysMax=2*this.order-1;if(node.numberActives<keysMax)keysMax=
node.numberActives;var i;if(node.isLeaf===false)return false;var key=node.keys[index];for(i=index;i<keysMax-1;i++)node.keys[i]=node.keys[i+1];node.keys.pop();node.numberActives--;this._diskWrite(node,function(node){return callback(node)})};Tree.prototype._mergeNodes=function(n1,key,n2,callback){var newNode;var i;newNode=this._allocateNode();newNode.isLeaf=true;for(i=0;i<n1.numberActives;i++){newNode.keys[i]=n1.keys[i];newNode.children[i]=n1.children[i]}newNode.children[n1.numberActives]=n1.children[n1.numberActives];
newNode.keys[n1.numberActives]=key;for(i=0;i<n2.numberActives;i++){newNode.keys[i+n1.numberActives+1]=n2.keys[i];newNode.children[i+n1.numberActives+1]=n2.children[i]}newNode.children[2*this.order-1]=n2.children[n2.numberActives];newNode.numberActives=n1.numberActives+n2.numberActives+1;newNode.isLeaf=n1.isLeaf;newNode.level=n1.level;var that=this;this._diskWrite(newNode,function(newNode){that._diskDelete(n1,function(){that._diskDelete(n2,function(){return callback(newNode)})})})};Tree.prototype.audit=
function(showOutput){var errors=[];var alreadySeen=[];var that=this;var foundInArray=function(data){for(var i=0;i<alreadySeen.length;i++)if(that.comparator(alreadySeen[i],data)===0){var error=" !!! duplicated key "+data;if(showOutput===true)console.log(error);errors.push(error)}};var length=null;var that=this;this.walkNodes(function(n){if(showOutput===true){console.log("--- Node at "+n.level+" level");console.log(" - leaf? "+n.isLeaf);console.log(" - num actives? "+n.numberActives);console.log(" - keys: ")}for(var i=
n.numberActives;i<n.keys.length;i++)if(n.keys[i]!=null)if(showOutput===true){console.log(" * warning : redundant key data");errors.push(" * warning : redundant key data")}for(var i=n.numberActives+1;i<n.children.length;i++)if(n.children[i]!=null)if(showOutput===true){console.log(" * warning : redundant children data");errors.push(" * warning : redundant key data")}if(n.isLeaf===false)for(var i=0;i<n.numberActives;i++){var maxLeft=this._diskRead(n.children[i]).keys[this._diskRead(n.children[i]).numberActives-
1].key;var minRight=this._diskRead(n.children[i+1]).keys[0].key;if(showOutput===true)console.log("   "+n.keys[i].key+"("+maxLeft+","+minRight+")");if(that.comparator(n.keys[i].key,maxLeft)===-1){var error=" !!! value max left "+maxLeft+" > key "+n.keys[i].key;if(showOutput===true)console.log(error);errors.push(error)}if(that.comparator(n.keys[i].key,minRight)===1){var error=" !!! value min right "+minRight+" < key "+n.keys[i].key;if(showOutput===true)console.log(error);errors.push(error)}foundInArray(n.keys[i].key);
alreadySeen.push(n.keys[i].key)}else{if(length===null)length=n.level;else if(length!=n.level){var error=" !!! Leaf node with wrong level value";if(showOutput===true)console.log(error);errors.push(error)}for(var i=0;i<n.numberActives;i++){if(showOutput===true)console.log(" "+n.keys[i].key);foundInArray(n.keys[i].key);alreadySeen.push(n.keys[i].key)}}if(n!=that.root){if(n.numberActives>2*that.order-1){if(showOutput===true)var error=" !!!! MAX num keys restriction violated ";console.log(error);errors.push(error)}if(n.numberActives<
that.order-1){if(showOutput===true)var error=" !!!! MIN num keys restriction violated ";console.log(error);errors.push(error)}}});return errors};Tree.prototype._getMaxKeyPos=function(tree,node,callback){var node_pos={};if(node===null)return callback(null);if(node.isLeaf===true){node_pos.node=node;node_pos.index=node.numberActives-1;return callback(node_pos)}else{node_pos.node=node;node_pos.index=node.numberActives-1;tree._diskRead(node.children[node.numberActives],function(node){return tree._getMaxKeyPos(tree,
node,callback)})}};Tree.prototype._getMinKeyPos=function(tree,node,callback){var node_pos={};if(node===null)callback(null);if(node.isLeaf===true){node_pos.node=node;node_pos.index=0;return callback(node_pos)}else{node_pos.node=node;node_pos.index=0;tree._diskRead(node.children[0],function(node){return tree._getMinKeyPos(tree,node,callback)})}};var Node=function(){this.numberActives=0;this.isLeaf=null;this.keys=[];this.children=[];this.level=0};module.exports={Tree:Tree,Node:Node}},{"./utils":55}],
39:[function(_dereq_,module,exports){(function(__dirname){var QueryEngine=_dereq_("./query_engine").QueryEngine;var InMemoryQuadBackend=_dereq_("./quad_backend").QuadBackend;var PersistentBackend=_dereq_("./persistent_quad_backend").QuadBackend;var InMemoryLexicon=_dereq_("./lexicon").Lexicon;var PersistentLexicon=_dereq_("./persistent_lexicon").Lexicon;var RDFModel=_dereq_("./rdf_model");var _=_dereq_("./utils");function Store(arg1,arg2){var callback=null;var params=null;if(arguments.length==0)params=
{};else if(arguments.length==1){params={};callback=arg1}else if(arguments.length>1){params=arg1;callback=arg2}else throw"An optional argument map and a callback must be provided";if(params["treeOrder"]==null)params["treeOrder"]=15;this.functionMap={};this.customFns={};this.engine=null;this._buildEngine(params,callback)}Store.prototype._buildEngine=function(params,callback){var Lexicon;var QuadBackend;if(params["persistent"]===true){Lexicon=PersistentLexicon;QuadBackend=PersistentBackend}else{Lexicon=
InMemoryLexicon;QuadBackend=InMemoryQuadBackend}var that=this;var createEngine=function(){that.engine=new QueryEngine(params);callback(null,that)};var createQuadBackend=function(lexicon){new QuadBackend(params,function(backend){params.lexicon=lexicon;params.backend=backend;if(params["overwrite"])backend.clear(createEngine);else createEngine()})};new Lexicon(function(lexicon){if(params["overwrite"]===true)lexicon.clear(createQuadBackend(lexicon));else createQuadBackend(lexicon)},params["name"])};Store.prototype.rdf=
RDFModel.rdf;Store.prototype.rdf.api=RDFModel;Store.prototype.registerCustomFunction=function(name,fn){this.customFns[name]=fn;this.engine.setCustomFunctions(this.customFns)};Store.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(arguments.length===4)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var queryString;var callback;if(arguments.length===1){queryString=arguments[0];var callback=
function(){}}else if(arguments.length===2){queryString=arguments[0];callback=arguments[1]}this.engine.execute(queryString,callback)}};Store.prototype.executeWithEnvironment=function(){var queryString,defaultGraphs,namedGraphs;if(arguments.length===3){queryString=arguments[0];var callback=function(){};defaultGraphs=arguments[1];namedGraphs=arguments[2]}else if(arguments.length===4){queryString=arguments[0];var callback=arguments[3];defaultGraphs=arguments[1];namedGraphs=arguments[2]}defaultGraphs=
_.map(defaultGraphs,function(graph){return{"token":"uri","value":graph}});namedGraphs=_.map(namedGraphs,function(graph){return{"token":"uri","value":graph}});this.engine.execute(queryString,callback,defaultGraphs,namedGraphs)};Store.prototype.graph=function(){var graphUri=null;var callback=null;if(arguments.length===1){callback=arguments[0]||function(){};graphUri=this.engine.lexicon.defaultGraphUri}else if(arguments.length===2){callback=arguments[1]||function(){};graphUri=arguments[0]}else throw"An optional graph URI and a callback function must be provided";
if(this.rdf.resolve(graphUri)!=null)graphUri=this.rdf.resolve(graphUri);this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+graphUri+"> { ?s ?p ?o } }",callback)};Store.prototype.node=function(){var graphUri=null;var callback=null;var nodeUri=null;if(arguments.length===2){nodeUri=arguments[0];callback=arguments[1]||function(){};graphUri=this.engine.lexicon.defaultGraphUri}else if(arguments.length===3){nodeUri=arguments[0];graphUri=arguments[1];callback=arguments[2]||function(){}}else throw"An optional graph URI, node URI and a callback function must be provided";
if(this.rdf.resolve(graphUri)!=null)graphUri=this.rdf.resolve(graphUri);if(this.rdf.resolve(nodeUri)!=null)nodeUri=this.rdf.resolve(nodeUri);this.engine.execute("CONSTRUCT { <"+nodeUri+"> ?p ?o } WHERE { GRAPH <"+graphUri+"> { <"+nodeUri+"> ?p ?o } }",callback)};Store.prototype.startObservingNode=function(){var uri,graphUri,callback;if(arguments.length===2){uri=arguments[0];callback=arguments[1];this.engine.callbacksBackend.observeNode(uri,callback,function(){})}else if(arguments.length===3){uri=
arguments[0];graphUri=arguments[1];callback=arguments[2];this.engine.callbacksBackend.observeNode(uri,graphUri,callback,function(){})}};Store.prototype.stopObservingNode=function(callback){this.engine.callbacksBackend.stopObservingNode(callback)};Store.prototype.startObservingQuery=function(){var query=arguments[0];var callback=arguments[1];var endCallback=arguments[2];if(endCallback!=null)this.engine.callbacksBackend.observeQuery(query,callback,endCallback);else this.engine.callbacksBackend.observeQuery(query,
callback,function(){})};Store.prototype.stopObservingQuery=function(query){this.engine.callbacksBackend.stopObservingQuery(query)};Store.prototype.subscribe=function(s,p,o,g,callback){var that=this;var adapterCb=function(event,triples){var acum=[];var queryEnv={blanks:{},outCache:{}};var bindings=[];_.each(triples,function(triple){var s=RDFModel.buildRDFResource(triple.subject,bindings,that.engine,queryEnv);var p=RDFModel.buildRDFResource(triple.predicate,bindings,that.engine,queryEnv);var o=RDFModel.buildRDFResource(triple.object,
bindings,that.engine,queryEnv);if(s!=null&&p!=null&&o!=null){triple=new RDFModel.Triple(s,p,o);acum.push(triple)}});callback(event,acum)};this.functionMap[callback]=adapterCb;this.engine.callbacksBackend.subscribe(s,p,o,g,adapterCb,function(){})};Store.prototype.unsubscribe=function(callback){var adapterCb=this.functionMap[callback];this.engine.callbacksBackend.unsubscribe(adapterCb);delete this.functionMap[callback]};Store.prototype.setPrefix=function(prefix,uri){this.rdf.setPrefix(prefix,uri)};
Store.prototype.setDefaultPrefix=function(uri){this.rdf.setDefaultPrefix(uri)};Store.prototype.insert=function(){var graph;var triples;var callback;if(arguments.length===1){triples=arguments[0];callback=function(){}}else if(arguments.length===2){triples=arguments[0];callback=arguments[1]||function(){}}else if(arguments.length===3){triples=arguments[0];graph=this.rdf.createNamedNode(arguments[1]);callback=arguments[2]||function(){}}else throw"The triples to insert, an optional graph and callback must be provided";
var query="";var that=this;triples.forEach(function(triple){query=query+that._nodeToQuery(triple.subject)+that._nodeToQuery(triple.predicate)+that._nodeToQuery(triple.object)+"."});if(graph!=null)query="INSERT DATA { GRAPH "+this._nodeToQuery(graph)+" { "+query+" } }";else query="INSERT DATA { "+query+" }";this.engine.execute(query,callback)};Store.prototype._nodeToQuery=function(term){if(term.interfaceName==="NamedNode"){var resolvedUri=this.rdf.resolve(term.valueOf());if(resolvedUri!=null)return"<"+
resolvedUri+">";else return"<"+term.valueOf()+">"}else return term.toString()};Store.prototype.delete=function(){var graph;var triples;var callback;if(arguments.length===1){triples=arguments[0];callback=function(){}}else if(arguments.length===2){triples=arguments[0];callback=arguments[1]||function(){}}else if(arguments.length===3){triples=arguments[0];graph=this.rdf.createNamedNode(arguments[1]);callback=arguments[2]||function(){}}else throw"The triples to delete, an optional graph and callback must be provided";
var query="";var that=this;triples.forEach(function(triple){query=query+that._nodeToQuery(triple.subject)+that._nodeToQuery(triple.predicate)+that._nodeToQuery(triple.object)+"."});if(graph!=null)query="DELETE DATA { GRAPH "+this._nodeToQuery(graph)+" { "+query+" } }";else query="DELETE DATA { "+query+" }";this.engine.execute(query,callback)};Store.prototype.clear=function(){var graph;var callback;if(arguments.length===0){graph=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri);var callback=
function(){}}else if(arguments.length===1){graph=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri);callback=arguments[0]||function(){}}else if(arguments.length===2){graph=this.rdf.createNamedNode(arguments[0]);callback=arguments[1]||function(){}}else throw"The optional graph and a callback must be provided";var query="CLEAR GRAPH "+this._nodeToQuery(graph);this.engine.execute(query,callback)};Store.prototype.setBatchLoadEvents=function(mustFireEvents){this.engine.eventsOnBatchLoad=mustFireEvents};
Store.prototype.registerDefaultNamespace=function(ns,prefix){this.rdf.prefixes.set(ns,prefix);this.engine.registerDefaultNamespace(ns,prefix)};Store.prototype.registerDefaultProfileNamespaces=function(){var defaultNsMap=this.rdf.prefixes.values();for(var p in defaultNsMap)this.registerDefaultNamespace(p,defaultNsMap[p])};Store.prototype.load=function(){var mediaType;var data;var graph;var callback;var options={};if(arguments.length===3){graph=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri);
mediaType=arguments[0];data=arguments[1];callback=arguments[2]||function(){}}else if(arguments.length===4){mediaType=arguments[0];data=arguments[1];options=arguments[2];if(typeof options==="string"){graph=this.rdf.createNamedNode(options);options={}}else{graph=this.rdf.createNamedNode(options.graph||this.engine.lexicon.defaultGraphUri);delete options["graph"]}callback=arguments[3]||function(){}}else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";
if(mediaType==="remote"){data=this.rdf.createNamedNode(data);var query="LOAD <"+data.valueOf()+"> INTO GRAPH <"+graph.valueOf()+">";this.engine.execute(query,callback)}else{var that=this;var parser=this.engine.rdfLoader.parsers[mediaType];if(!parser)return callback(new Error("Cannot find parser for the provided media type:"+mediaType));var cb=function(err,quads){if(err)callback(err,quads);else that.engine.batchLoad(quads,function(success){if(success!=null)callback(null,success);else callback(new Error("Erro batch-loading triples."))})};
var args=[parser,{"token":"uri","value":graph.valueOf()},data,options,cb];if(data&&typeof data==="string"&&data.indexOf("file://")===0)this.engine.rdfLoader.loadFromFile.apply(null,args);else this.engine.rdfLoader.tryToParse.apply(null,args)}};Store.prototype.registerParser=function(mediaType,parser){this.engine.rdfLoader.registerParser(mediaType,parser)};Store.prototype.registeredGraphs=function(callback){this.engine.lexicon.registeredGraphs(true,function(graphs){var graphNodes=_.map(graphs,function(graph){return new RDFModel.NamedNode(graph)});
callback(null,graphNodes)})};Store.prototype.getNetworkTransport=function(){return NetworkTransport};Store.prototype.setNetworkTransport=function(networkTransportImpl){NetworkTransport=networkTransportImpl};Store.prototype.close=function(cb){if(cb==null)cb=function(){};if(this.engine.close)this.engine.close(cb);else cb()};Store.VERSION="0.9.7";var connect=function(){var path,args,callback;if(arguments.length==1){path=__dirname;args={};callback=arguments[0]}else if(arguments.length==2){if(typeof arguments[0]===
"string"){path=arguments[0];args={}}else{path=__dirname+"/index.js";args=arguments[0]}callback=arguments[1]}else{path=arguments[0];args=arguments[1];callback=arguments[2]}callback(new Error("Store#connect is not supported in the 1.x series of the library"))};var create=function(){if(arguments.length==1)return new Store(arguments[0]);else if(arguments.length==2)return new Store(arguments[0],arguments[1]);else return new Store};module.exports.Store=Store;module.exports.create=create;module.exports.connect=
connect}).call(this,"/")},{"./lexicon":42,"./persistent_lexicon":45,"./persistent_quad_backend":46,"./quad_backend":47,"./query_engine":49,"./rdf_model":53,"./utils":55}],40:[function(_dereq_,module,exports){var _=_dereq_("./utils");var async=_dereq_("./utils");var QuadIndex=_dereq_("./quad_index").QuadIndex;var Pattern=_dereq_("./quad_index").Pattern;var RDFModel=_dereq_("./rdf_model");var AbstractQueryTree=_dereq_("./abstract_query_tree").AbstractQueryTree;Callbacks={};Callbacks.ANYTHING={"token":"var",
"value":"_"};Callbacks.added="added";Callbacks.deleted="deleted";Callbacks.eventsFlushed="eventsFlushed";Callbacks.CallbacksBackend=function(){this.aqt=new AbstractQueryTree;this.engine=arguments[0];this.indexMap={};this.observersMap={};this.queriesIndexMap={};this.emptyNotificationsMap={};this.queriesList=[];this.pendingQueries=[];this.matchedQueries=[];this.updateInProgress=null;this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],
GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]};this.callbackCounter=0;this.callbacksMap={};this.callbacksInverseMap={};this.queryCounter=0;this.queriesMap={};this.queriesCallbacksMap={};this.queriesInverseMap={};for(var i=0;i<this.indices.length;i++){var indexKey=this.indices[i];this.indexMap[indexKey]={};this.queriesIndexMap[indexKey]=
{}}};Callbacks.CallbacksBackend.prototype.startGraphModification=function(){if(this.ongoingModification!==true){this.pendingQueries=[].concat(this.queriesList);this.matchedQueries=[];if(this.updateInProgress==null){this.updateInProgress={};this.updateInProgress[Callbacks["added"]]=[];this.updateInProgress[Callbacks["deleted"]]=[]}}};Callbacks.CallbacksBackend.prototype.nextGraphModification=function(event,quad){this.updateInProgress[event].push(quad)};Callbacks.CallbacksBackend.prototype.endGraphModification=
function(callback){if(this.ongoingModification!==true){var that=this;if(this.updateInProgress!=null){var tmp=that.updateInProgress;that.updateInProgress=null;this.sendNotification(Callbacks["deleted"],tmp[Callbacks["deleted"]],function(){that.sendNotification(Callbacks["added"],tmp[Callbacks["added"]],function(){that.sendEmptyNotification(Callbacks["eventsFlushed"],null,function(){that.dispatchQueries(function(){callback(true)})})})})}else callback(true)}else callback(true)};Callbacks.CallbacksBackend.prototype.cancelGraphModification=
function(){if(this.ongoingModification!==true)this.updateInProgress=null};Callbacks.CallbacksBackend.prototype.sendNotification=function(event,quadsPairs,doneCallback){var notificationsMap={};for(var i=0;i<quadsPairs.length;i++){var quadPair=quadsPairs[i];for(var indexKey in this.indexMap){var index=this.indexMap[indexKey];var order=this.componentOrders[indexKey];this._searchCallbacksInIndex(index,order,event,quadPair,notificationsMap);if(this.pendingQueries.length!=0){index=this.queriesIndexMap[indexKey];
this._searchQueriesInIndex(index,order,quadPair)}}}this.dispatchNotifications(notificationsMap);if(doneCallback!=null)doneCallback(true)};Callbacks.CallbacksBackend.prototype.sendEmptyNotification=function(event,value,doneCallback){var callbacks=this.emptyNotificationsMap[event]||[];for(var i=0;i<callbacks.length;i++)callbacks[i](event,value);doneCallback()};Callbacks.CallbacksBackend.prototype.dispatchNotifications=function(notificationsMap){for(var callbackId in notificationsMap){var callback=this.callbacksMap[callbackId];
var deleted=notificationsMap[callbackId][Callbacks["deleted"]];if(deleted!=null)try{callback(Callbacks["deleted"],deleted)}catch(e){}for(var event in notificationsMap[callbackId])if(event!=Callbacks["deleted"])try{callback(event,notificationsMap[callbackId][event])}catch(e){}}};Callbacks.CallbacksBackend.prototype._searchCallbacksInIndex=function(index,order,event,quadPair,notificationsMap){var quadPairNomalized=quadPair[1];var quadPair=quadPair[0];for(var i=0;i<order.length+1;i++){var matched=index["_"]||
[];var filteredIds=[];for(var j=0;j<matched.length;j++){var callbackId=matched[j];if(this.callbacksMap[callbackId]!=null){notificationsMap[callbackId]=notificationsMap[callbackId]||{};notificationsMap[callbackId][event]=notificationsMap[callbackId][event]||[];notificationsMap[callbackId][event].push(quadPair);filteredIds.push(callbackId)}}index["_"]=filteredIds;var component=order[i];if(index[""+quadPairNomalized[component]]!=null)index=index[""+quadPairNomalized[component]];else break}};Callbacks.CallbacksBackend.prototype.subscribeEmpty=
function(event,callback){var callbacks=this.emptyNotificationsMap[event]||[];callbacks.push(callback);this.emptyNotificationsMap[event]=callbacks};Callbacks.CallbacksBackend.prototype.unsubscribeEmpty=function(event,callback){var callbacks=this.emptyNotificationsMap[event];if(callbacks!=null)callbacks=_.reject(callbacks,function(cb){return cb===callback});this.emptyNotificationsMap[event]=callbacks};Callbacks.CallbacksBackend.prototype.subscribe=function(s,p,o,g,callback,doneCallback){var quad=this._tokenizeComponents(s,
p,o,g);var queryEnv={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,queryEnv);var that=this;this.engine.normalizeQuad(quad,queryEnv,true,function(normalized){var pattern=new Pattern(normalized);var indexKey=that._indexForPattern(pattern);var indexOrder=that.componentOrders[indexKey];var index=that.indexMap[indexKey];for(var i=0;i<indexOrder.length;i++){var component=indexOrder[i];var quadValue=normalized[component];if(quadValue==="_"){if(index["_"]==null)index["_"]=[];that.callbackCounter++;
index["_"].push(that.callbackCounter);that.callbacksMap[that.callbackCounter]=callback;that.callbacksInverseMap[callback]=that.callbackCounter;break}else if(i===indexOrder.length-1){index[quadValue]=index[quadValue]||{"_":[]};that.callbackCounter++;index[quadValue]["_"].push(that.callbackCounter);that.callbacksMap[that.callbackCounter]=callback;that.callbacksInverseMap[callback]=that.callbackCounter}else{index[quadValue]=index[quadValue]||{};index=index[quadValue]}}if(doneCallback!=null)doneCallback(true)})};
Callbacks.CallbacksBackend.prototype.unsubscribe=function(callback){var id=this.callbacksInverseMap[callback];if(id!=null){delete this.callbacksInverseMap[callback];delete this.callbacksMap[id]}};Callbacks.CallbacksBackend.prototype._tokenizeComponents=function(s,p,o,g){var pattern={};if(s==null)pattern["subject"]=Callbacks.ANYTHING;else if(s.indexOf("_:")==0)pattern["subject"]={"token":"blank","value":s};else pattern["subject"]={"token":"uri","value":s};if(p==null)pattern["predicate"]=Callbacks.ANYTHING;
else pattern["predicate"]={"token":"uri","value":p};if(o==null)pattern["object"]=Callbacks.ANYTHING;else pattern["object"]={"token":"uri","value":o};if(g==null)pattern["graph"]=Callbacks.ANYTHING;else pattern["graph"]={"token":"uri","value":g};return pattern};Callbacks.CallbacksBackend.prototype._indexForPattern=function(pattern){var indexKey=pattern.indexKey;var matchingIndices=this.indices;for(var i=0;i<matchingIndices.length;i++){var index=matchingIndices[i];var indexComponents=this.componentOrders[index];
for(var j=0;j<indexComponents.length;j++){if(_.include(indexKey,indexComponents[j])===false)break;if(j==indexKey.length-1)return index}}return"SPOG"};Callbacks.CallbacksBackend.prototype.observeNode=function(){var uri,graphUri,callback,doneCallback;if(arguments.length===4){uri=arguments[0];graphUri=arguments[1];callback=arguments[2];doneCallback=arguments[3]}else{uri=arguments[0];graphUri=this.engine.lexicon.defaultGraphUri;callback=arguments[1];doneCallback=arguments[2]}var query="CONSTRUCT { <"+
uri+"> ?p ?o } WHERE { GRAPH <"+graphUri+"> { <"+uri+"> ?p ?o } }";var that=this;var queryEnv={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,queryEnv);var bindings=[];this.engine.execute(query,function(err,graph){if(!err){var node=graph;var mustFlush=false;var observer=function(event,triples){if(event==="eventsFlushed"&&mustFlush){mustFlush=false;try{callback(node)}catch(e){}}else if(event!=="eventsFlushed"){mustFlush=true;for(var i=0;i<triples.length;i++){var triple=triples[i];
var s=RDFModel.buildRDFResource(triple.subject,bindings,that.engine,queryEnv);var p=RDFModel.buildRDFResource(triple.predicate,bindings,that.engine,queryEnv);var o=RDFModel.buildRDFResource(triple.object,bindings,that.engine,queryEnv);if(s!=null&&p!=null&&o!=null){triple=new RDFModel.Triple(s,p,o);if(event===Callbacks["added"])node.add(triple);else if(event===Callbacks["deleted"])node.remove(triple)}}}};that.observersMap[callback]=observer;that.subscribeEmpty(Callbacks["eventsFlushed"],observer);
that.subscribe(uri,null,null,null,observer,function(){try{callback(node)}catch(e){}if(doneCallback)doneCallback(true)})}else if(doneCallback)doneCallback(false)})};Callbacks.CallbacksBackend.prototype.stopObservingNode=function(callback){var observer=this.observersMap[callback];if(observer){this.unsubscribe(observer);this.unsubscribeEmpty(Callbacks["eventsFlushed"],observer);return true}else return false};Callbacks.CallbacksBackend.prototype.observeQuery=function(query,callback,endCallback){var queryParsed=
this.aqt.parseQueryString(query);var parsedTree=this.aqt.parseSelect(queryParsed.units[0]);var patterns=this.aqt.collectBasicTriples(parsedTree);var that=this;var queryEnv={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,queryEnv);var counter=this.queryCounter;this.queryCounter++;this.queriesMap[counter]=query;this.queriesInverseMap[query]=counter;this.queriesList.push(counter);this.queriesCallbacksMap[counter]=callback;async.eachSeries(patterns,function(quad,k){if(quad.graph==null)quad.graph=
that.engine.lexicon.defaultGraphUriTerm;that.engine.normalizeQuad(quad,queryEnv,true,function(normalized){var pattern=new Pattern(normalized);var indexKey=that._indexForPattern(pattern);var indexOrder=that.componentOrders[indexKey];var index=that.queriesIndexMap[indexKey];for(var j=0;j<indexOrder.length;j++){var component=indexOrder[j];var quadValue=normalized[component];if(typeof quadValue==="string"){if(index["_"]==null)index["_"]=[];index["_"].push(counter);break}else if(j===indexOrder.length-
1){index[quadValue]=index[quadValue]||{"_":[]};index[quadValue]["_"].push(counter)}else{index[quadValue]=index[quadValue]||{};index=index[quadValue]}}k()})},function(){that.engine.execute(query,function(err,results){if(!err)callback(results);else console.log("ERROR in query callback "+results)});if(endCallback!=null)endCallback()})};Callbacks.CallbacksBackend.prototype.stopObservingQuery=function(query){var id=this.queriesInverseMap[query];if(id!=null){delete this.queriesInverseMap[query];delete this.queriesMap[id];
this.queriesList=_.reject(this.queriesList,function(queryId){return queryId===id})}};Callbacks.CallbacksBackend.prototype._searchQueriesInIndex=function(index,order,quadPair){var quadPairNomalized=quadPair[1];var quadPair=quadPair[0];for(var i=0;i<order.length+1;i++){var matched=index["_"]||[];var filteredIds=[];for(var j=0;j<matched.length;j++){var queryId=matched[j];if(_.include(this.pendingQueries,queryId)){_.remove(this.pendingQueries,function(pendingQueryId){return pendingQueryId===queryId});
this.matchedQueries.push(queryId)}if(this.queriesMap[queryId]!=null)filteredIds.push(queryId)}index["_"]=filteredIds;var component=order[i];if(index[""+quadPairNomalized[component]]!=null)index=index[""+quadPairNomalized[component]];else break}};Callbacks.CallbacksBackend.prototype.dispatchQueries=function(callback){var that=this;var query,queryCallback;var toDispatchMap={};async.eachSeries(this.matchedQueries,function(queryId,k){if(toDispatchMap[queryId]==null){toDispatchMap[queryId]=true;query=
that.queriesMap[queryId];queryCallback=that.queriesCallbacksMap[queryId];that.engine.execute(query,function(err,results){if(!err)try{queryCallback(results)}catch(e){}k()})}else k()},function(){callback()})};Callbacks.CallbacksBackend.added=Callbacks.added;Callbacks.CallbacksBackend.deleted=Callbacks.deleted;Callbacks.CallbacksBackend.eventsFlushed=Callbacks.eventsFlushed;module.exports=Callbacks},{"./abstract_query_tree":37,"./quad_index":48,"./rdf_model":53,"./utils":55}],41:[function(_dereq_,module,
exports){var jsonld=_dereq_("jsonld");var toTriples=function(input,graph,cb){var rval=null;jsonld.normalize(input,{},function(err,normalized){if(err)cb(err);else{var parseTerm=function(term){if(term.type==="blank node")return{"blank":term.value};else if(term.type==="IRI")return{"token":"uri","value":term.value};else if(term.type==="literal")if(term.datatype!==null)return{"literal":'"'+term.value+'"^^<'+term.datatype+">"};else if(term.language!=null)return{"literal":'"'+term.value+'"@'+term.language};
else return{"literal":'"'+term.value+'"'}};rval=[];var callback=function(s,p,o){rval.push({"subject":parseTerm(s),"predicate":parseTerm(p),"object":parseTerm(o),"graph":graph})};var quit=false;for(var p in normalized){var triples=normalized[p];for(var i=0;i<triples.length;i++){var triple=triples[i];callback(triple.subject,triple.predicate,triple.object)}}cb(null,rval)}})};exports.JSONLDParser={};var JSONLDParser=exports.JSONLDParser;JSONLDParser.parser={async:true,parse:function(data,graph,options,
callback){try{if(typeof data==="string")data=JSON.parse(data);toTriples(data,graph,callback)}catch(error){callback(error)}}};module.exports={JSONLDParser:JSONLDParser}},{"jsonld":32}],42:[function(_dereq_,module,exports){var async=_dereq_("./utils");var Tree=_dereq_("./btree").Tree;Lexicon=function(callback){var that=this;this.defaultGraphOid=0;this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph";this.defaultGraphUriTerm={"token":"uri","prefix":null,"suffix":null,"value":this.defaultGraphUri};
this.oidCounter=1;async.seq(function(k){new Tree(2,function(tree){that.uris=tree;k()})},function(k){new Tree(2,function(tree){that.literals=tree;k()})},function(k){new Tree(2,function(tree){that.knownGraphs=tree;k()})},function(k){new Tree(2,function(tree){that.oidUris=tree;k()})},function(k){new Tree(2,function(tree){that.oidLiterals=tree;k()})},function(k){new Tree(2,function(tree){that.oidBlanks=tree;k()})})(function(){if(callback!=null)callback(that)})};Lexicon.prototype.registerGraph=function(oid,
uriToken,callback){if(oid!=this.defaultGraphOid)this.knownGraphs.insert(oid,uriToken,function(){callback()});else callback()};Lexicon.prototype.registeredGraphs=function(returnUris,callback){var graphs=[];this.knownGraphs.walk(function(node){if(returnUris===true)graphs.push(node.data);else graphs.push(node.key)},function(){callback(graphs)})};Lexicon.prototype.registerUri=function(uri,callback){var that=this;if(uri===this.defaultGraphUri)callback(this.defaultGraphOid);else this.uris.search(uri,function(oidData){if(oidData==
null){var oid=that.oidCounter;var oidStr="u"+oid;that.oidCounter++;async.seq(function(k){that.uris.insert(uri,[oid,0],function(){k()})},function(k){that.oidUris.insert(oidStr,uri,function(){k()})})(function(){callback(oid)})}else{oid=oidData[0];oidData[1]=oidData[1]+1;callback(oid)}})};Lexicon.prototype.resolveUri=function(uri,callback){if(uri===this.defaultGraphUri)callback(this.defaultGraphOid);else this.uris.search(uri,function(oidData){if(oidData!=null)callback(oidData[0]);else callback(-1)})};
Lexicon.prototype.resolveUriCost=function(uri,callback){if(uri===this.defaultGraphUri)callback(0);else this.uris.search(uri,function(oidData){if(oidData!=null)callback(oidData[1]);else callback(-1)})};Lexicon.prototype.registerBlank=function(callback){var oid=this.oidCounter;this.oidCounter++;var oidStr=""+oid;this.oidBlanks.insert(oidStr,oidStr,function(){callback(oid)})};Lexicon.prototype.resolveBlank=function(label,callback){var that=this;this.oidBlanks.search(label,function(oidData){if(oidData!=
null)callback(oidData);else{var oid=that.oidCounter;this.oidCounter++;callback(""+oid)}})};Lexicon.prototype.resolveBlankCost=function(label,callback){callback(0)};Lexicon.prototype.registerLiteral=function(literal,callback){var that=this;this.literals.search(literal,function(oidData){if(oidData==null){var oid=that.oidCounter;var oidStr="l"+oid;that.oidCounter++;async.seq(function(k){that.literals.insert(literal,[oid,0],function(){k()})},function(k){that.oidLiterals.insert(oidStr,literal,function(){k()})})(function(){callback(oid)})}else{var oid=
oidData[0];oidData[1]=oidData[1]+1;callback(oid)}})};Lexicon.prototype.resolveLiteral=function(literal,callback){this.literals.search(literal,function(oidData){if(oidData!=null)callback(oidData[0]);else callback(-1)})};Lexicon.prototype.resolveLiteralCost=function(literal,callback){this.literals.search(literal,function(oidData){if(oidData!=null)callback(oidData[1]);else callback(-1)})};Lexicon.prototype.parseLiteral=function(literalString){var parts=literalString.lastIndexOf("@");if(parts!=-1&&literalString[parts-
1]==='"'&&literalString.substring(parts,literalString.length).match(/^@[a-zA-Z\-]+$/g)!=null){var value=literalString.substring(1,parts-1);var lang=literalString.substring(parts+1,literalString.length);return{token:"literal",value:value,lang:lang}}var parts=literalString.lastIndexOf("^^");if(parts!=-1&&literalString[parts-1]==='"'&&literalString[parts+2]==="<"&&literalString[literalString.length-1]===">"){var value=literalString.substring(1,parts-1);var type=literalString.substring(parts+3,literalString.length-
1);return{token:"literal",value:value,type:type}}var value=literalString.substring(1,literalString.length-1);return{token:"literal",value:value}};Lexicon.prototype.parseUri=function(uriString){return{token:"uri",value:uriString}};Lexicon.prototype.retrieve=function(oid,callback){var that=this;if(oid===this.defaultGraphOid)callback({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:true});else async.seq(function(found,k){that.oidUris.search("u"+oid,function(maybeUri){if(maybeUri!=
null)k(null,that.parseUri(maybeUri));else k(null,null)})},function(found,k){if(found==null)that.oidLiterals.search("l"+oid,function(maybeLiteral){if(maybeLiteral!=null)k(null,that.parseLiteral(maybeLiteral));else k(null,null)});else k(null,found)},function(found,k){if(found==null)that.oidBlanks.search(""+oid,function(maybeBlank){if(maybeBlank!=null)k(null,{token:"blank",value:"_:"+oid});else k(null,null)});else k(null,found)})(null,function(_,found){callback(found)})};Lexicon.prototype.clear=function(callback){var that=
this;this.defaultGraphOid=0;this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph";this.defaultGraphUriTerm={"token":"uri","prefix":null,"suffix":null,"value":this.defaultGraphUri};this.oidCounter=1;async.seq(function(k){new Tree(2,function(tree){that.uris=tree;k()})},function(k){new Tree(2,function(tree){that.literals=tree;k()})},function(k){new Tree(2,function(tree){that.knownGraphs=tree;k()})},function(k){new Tree(2,function(tree){that.oidUris=tree;k()})},function(k){new Tree(2,
function(tree){that.oidLiterals=tree;k()})},function(k){new Tree(2,function(tree){that.oidBlanks=tree;k()})})(function(){if(callback!=null)callback()})};Lexicon.prototype.unregister=function(quad,key,callback){var that=this;async.seq(function(k){that._unregisterTerm(quad.subject.token,key.subject,k)},function(k){that._unregisterTerm(quad.predicate.token,key.predicate,k)},function(k){that._unregisterTerm(quad.object.token,key.object,k)},function(k){if(quad.graph!=null)that._unregisterTerm(quad.graph.token,
key.graph,k);else k()})(function(){callback(true)})};Lexicon.prototype._unregisterTerm=function(kind,oid,callback){var that=this;if(kind==="uri")if(oid!=this.defaultGraphOid){var oidStr="u"+oid;that.oidUris.search(oidStr,function(uri){that.uris.search(uri,function(oidData){var counter=oidData[1];if(""+oidData[0]===""+oid)if(counter===0)async.seq(function(k){that.oidUris.delete(oidStr,function(){k()})},function(k){that.uris.delete(uri,function(){k()})},function(k){that.knownGraphs.delete(oid,function(){k()})})(function(){callback()});
else that.uris.insert(uri,[oid,counter-1],function(){callback()});else callback()})})}else callback();else if(kind==="literal"){this.oidCounter++;var oidStr="l"+oid;that.oidLiterals.search(oidStr,function(literal){that.literals.search(literal,function(oidData){var counter=oidData[1];if(""+oidData[0]===""+oid)if(counter===0)async.seq(function(k){that.oidLiterals.delete(oidStr,function(){k()})},function(k){that.literals.delete(literal,function(){k()})})(function(){callback()});else that.literals.insert(literal,
[oid,counter-1],function(){callback()});else callback()})})}else if(kind==="blank")that.oidBlanks.delete(""+oid,function(){callback()});else callback()};module.exports={Lexicon:Lexicon}},{"./btree":38,"./utils":55}],43:[function(_dereq_,module,exports){var http=_dereq_("http");var https=_dereq_("https");var url=_dereq_("url");NetworkTransport={load:function(uri,accept,callback,redirect){var redirection=redirect==null?3:redirect;var parts=url.parse(uri,true,true);var params={"host":parts.host,"hostname":parts.hostname,
"method":"GET","path":parts.path,"headers":{"host":parts.hostname,"Accept":accept}};var client=null;if(parts.protocol==="http:"){params.port=parts.port||80;client=http}else if(parts.protocol==="https:"){params.port=parts.port||443;client=https}var request=client.request(params,function(response){var headers=response.headers;var data="";if((""+response.statusCode)[0]=="2"){response.on("end",function(){callback(null,{headers:headers,data:data})});response.on("data",function(chunk){data=data+chunk})}else if((""+
response.statusCode)[0]=="3")if(redirection==0)callback(new Error("Too many redirections"));else{var location=headers["Location"]||headers["location"];if(location!=null)NetworkTransport.load(location,accept,callback,redirection-1);else callback(new Error("Redirection without location header"))}else callback(new Error("HTTP error: "+response.statusCode))});request.on("error",callback);request.end()}};module.exports={NetworkTransport:NetworkTransport}},{"http":6,"https":10,"url":28}],44:[function(_dereq_,
module,exports){module.exports=function(){function peg$subclass(child,parent){function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor}function SyntaxError(message,expected,found,offset,line,column){this.message=message;this.expected=expected;this.found=found;this.offset=offset;this.line=line;this.column=column;this.name="SyntaxError"}peg$subclass(SyntaxError,Error);function parse(input){var options=arguments.length>1?arguments[1]:{},peg$FAILED={},peg$startRuleIndices=
{DOCUMENT:0},peg$startRuleIndex=0,peg$consts=[{type:"other",description:"[1] QueryUnit"},{type:"other",description:"[2] Query"},peg$FAILED,function(p,q,v){return{token:"query",kind:"query",prologue:p,units:[q],inlineData:v}},{type:"other",description:"[3] Prologue"},null,[],function(b,pfx){return{token:"prologue",base:b,prefixes:pfx}},{type:"other",description:"[4] BaseDecl"},"BASE",{type:"literal",value:"BASE",description:'"BASE"'},"base",{type:"literal",value:"base",description:'"base"'},function(i){registerDefaultPrefix(i);
var base={};base.token="base";base.value=i;return base},{type:"other",description:"[5] PrefixDecl"},"PREFIX",{type:"literal",value:"PREFIX",description:'"PREFIX"'},"prefix",{type:"literal",value:"prefix",description:'"prefix"'},function(p,l){registerPrefix(p,l);var prefix={};prefix.token="prefix";prefix.prefix=p;prefix.local=l;return prefix},{type:"other",description:"[6] SelectQuery"},function(s,gs,w,sm){var dataset={"named":[],"implicit":[]};for(var i=0;i<gs.length;i++){var g=gs[i];if(g.kind===
"default")dataset["implicit"].push(g.graph);else dataset["named"].push(g.graph)}if(dataset["named"].length===0&&dataset["implicit"].length===0)dataset["implicit"].push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var query={};query.kind="select";query.token="executableunit";query.dataset=dataset;query.projection=s.vars;query.modifier=s.modifier;query.pattern=w;if(sm!=null&&sm.limit!=null)query.limit=sm.limit;if(sm!=null&&sm.offset!=null)query.offset=
sm.offset;if(sm!=null&&(sm.order!=null&&sm.order!=""))query.order=sm.order;if(sm!=null&&sm.group!=null)query.group=sm.group;return query},{type:"other",description:"[7] SubSelect"},function(s,w,sm){var query={};query.kind="select";query.token="subselect";query.projection=s.vars;query.modifier=s.modifier;query.pattern=w;if(sm!=null&&sm.limit!=null)query.limit=sm.limit;if(sm!=null&&sm.offset!=null)query.offset=sm.offset;if(sm!=null&&(sm.order!=null&&sm.order!=""))query.order=sm.order;if(sm!=null&&sm.group!=
null)query.group=sm.group;return query},{type:"other",description:"[8] SelectClause"},"SELECT",{type:"literal",value:"SELECT",description:'"SELECT"'},"select",{type:"literal",value:"select",description:'"select"'},"DISTINCT",{type:"literal",value:"DISTINCT",description:'"DISTINCT"'},"distinct",{type:"literal",value:"distinct",description:'"distinct"'},"REDUCED",{type:"literal",value:"REDUCED",description:'"REDUCED"'},"reduced",{type:"literal",value:"reduced",description:'"reduced"'},"(",{type:"literal",
value:"(",description:'"("'},"AS",{type:"literal",value:"AS",description:'"AS"'},"as",{type:"literal",value:"as",description:'"as"'},")",{type:"literal",value:")",description:'")"'},"*",{type:"literal",value:"*",description:'"*"'},function(mod,proj){var vars=[];if(proj.length===3&&proj[1]==="*")return{vars:[{token:"variable",kind:"*"}],modifier:arrayToString(mod)};for(var i=0;i<proj.length;i++){var aVar=proj[i];if(aVar.length===3)vars.push({token:"variable",kind:"var",value:aVar[1]});else vars.push({token:"variable",
kind:"aliased",expression:aVar[3],alias:aVar[7]})}return{vars:vars,modifier:arrayToString(mod)}},{type:"other",description:"[9] ConstructQuery"},"CONSTRUCT",{type:"literal",value:"CONSTRUCT",description:'"CONSTRUCT"'},"construct",{type:"literal",value:"construct",description:'"construct"'},function(t,gs,w,sm){var dataset={"named":[],"implicit":[]};for(var i=0;i<gs.length;i++){var g=gs[i];if(g.kind==="default")dataset["implicit"].push(g.graph);else dataset["named"].push(g.graph)}if(dataset["named"].length===
0&&dataset["implicit"].length===0)dataset["implicit"].push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var query={};query.kind="construct";query.token="executableunit";query.dataset=dataset;query.template=t;query.pattern=w;if(sm!=null&&sm.limit!=null)query.limit=sm.limit;if(sm!=null&&sm.offset!=null)query.offset=sm.offset;if(sm!=null&&(sm.order!=null&&sm.order!=""))query.order=sm.order;return query},"WHERE",{type:"literal",value:"WHERE",
description:'"WHERE"'},"where",{type:"literal",value:"where",description:'"where"'},"{",{type:"literal",value:"{",description:'"{"'},"}",{type:"literal",value:"}",description:'"}"'},function(gs,t,sm){var dataset={"named":[],"implicit":[]};for(var i=0;i<gs.length;i++){var g=gs[i];if(g.kind==="default")dataset["implicit"].push(g.graph);else dataset["named"].push(g.graph)}if(dataset["named"].length===0&&dataset["implicit"].length===0)dataset["implicit"].push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});
var query={};query.kind="construct";query.token="executableunit";query.dataset=dataset;query.template=t;query.pattern={token:"basicgraphpattern",triplesContext:t.triplesContext};if(sm!=null&&sm.limit!=null)query.limit=sm.limit;if(sm!=null&&sm.offset!=null)query.offset=sm.offset;if(sm!=null&&(sm.order!=null&&sm.order!=""))query.order=sm.order;return query},{type:"other",description:"[10] DescribeQuery"},"DESCRIBE",{type:"literal",value:"DESCRIBE",description:'"DESCRIBE"'},{type:"other",description:"[11] AskQuery"},
"ASK",{type:"literal",value:"ASK",description:'"ASK"'},"ask",{type:"literal",value:"ask",description:'"ask"'},function(gs,w){var dataset={"named":[],"implicit":[]};for(var i=0;i<gs.length;i++){var g=gs[i];if(g.kind==="implicit")dataset["implicit"].push(g.graph);else dataset["named"].push(g.graph)}if(dataset["named"].length===0&&dataset["implicit"].length===0)dataset["implicit"].push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var query=
{};query.kind="ask";query.token="executableunit";query.dataset=dataset;query.pattern=w;return query},{type:"other",description:"[12] DatasetClause"},"FROM",{type:"literal",value:"FROM",description:'"FROM"'},"from",{type:"literal",value:"from",description:'"from"'},function(gs){return gs},{type:"other",description:"[13] DefaultGraphClause"},function(s){return{graph:s,kind:"default",token:"graphClause"}},{type:"other",description:"[14] NamedGraphClause"},"NAMED",{type:"literal",value:"NAMED",description:'"NAMED"'},
"named",{type:"literal",value:"named",description:'"named"'},function(s){return{graph:s,kind:"named",token:"graphCluase"}},{type:"other",description:"[15] SourceSelector"},{type:"other",description:"[16] WhereClause"},function(g){return g},{type:"other",description:"[17] SolutionModifier"},function(gc,oc,lo){var acum={};if(lo!=null){if(lo.limit!=null)acum.limit=lo.limit;if(lo.offset!=null)acum.offset=lo.offset}if(gc!=null)acum.group=gc;acum.order=oc;return acum},{type:"other",description:"[18] GroupClause"},
"GROUP",{type:"literal",value:"GROUP",description:'"GROUP"'},"group",{type:"literal",value:"group",description:'"group"'},"BY",{type:"literal",value:"BY",description:'"BY"'},"by",{type:"literal",value:"by",description:'"by"'},function(conds){return conds},{type:"other",description:"[19] GroupCondition"},function(b){return b},function(f){return f},function(e,alias){if(alias.length!=0)return{token:"aliased_expression",expression:e,alias:alias[2]};else return e},function(v){return v},{type:"other",description:"[20] HavingClause"},
"HAVING",{type:"literal",value:"HAVING",description:'"HAVING"'},{type:"other",description:"[21] HavingCondition"},{type:"other",description:"[22] OrderClause"},"ORDER",{type:"literal",value:"ORDER",description:'"ORDER"'},"order",{type:"literal",value:"order",description:'"order"'},function(os){return os},{type:"other",description:"[23] OrderCondition"},"ASC",{type:"literal",value:"ASC",description:'"ASC"'},"asc",{type:"literal",value:"asc",description:'"asc"'},"DESC",{type:"literal",value:"DESC",
description:'"DESC"'},"desc",{type:"literal",value:"desc",description:'"desc"'},function(direction,e){return{direction:direction.toUpperCase(),expression:e}},function(e){if(e.token==="var")var e={token:"expression",expressionType:"atomic",primaryexpression:"var",value:e};return{direction:"ASC",expression:e}},{type:"other",description:"[24] LimitOffsetClauses"},function(cls){var acum={};for(var i=0;i<cls.length;i++){var cl=cls[i];if(cl!=null&&cl.limit!=null)acum["limit"]=cl.limit;else if(cl!=null&&
cl.offset!=null)acum["offset"]=cl.offset}return acum},{type:"other",description:"[25] LimitClause"},"LIMIT",{type:"literal",value:"LIMIT",description:'"LIMIT"'},"limit",{type:"literal",value:"limit",description:'"limit"'},function(i){return{limit:parseInt(i.value)}},{type:"other",description:"[26] OffsetClause"},"OFFSET",{type:"literal",value:"OFFSET",description:'"OFFSET"'},"offset",{type:"literal",value:"offset",description:'"offset"'},function(i){return{offset:parseInt(i.value)}},{type:"other",
description:"[27] BindingsClause"},"BINDINGS",{type:"literal",value:"BINDINGS",description:'"BINDINGS"'},{type:"other",description:"[28] BindingValue"},"UNDEF",{type:"literal",value:"UNDEF",description:'"UNDEF"'},{type:"other",description:"[28]  \tValuesClause\t  ::=  \t( 'VALUES' DataBlock )?"},"VALUES",{type:"literal",value:"VALUES",description:'"VALUES"'},"values",{type:"literal",value:"values",description:'"values"'},function(b){if(b!=null)return b[1];else return null},{type:"other",description:"[29] UpdateUnit"},
{type:"other",description:"[30] Update"},";",{type:"literal",value:";",description:'";"'},function(p,u,us){var query={};query.token="query";query.kind="update";query.prologue=p;var units=[u];if(us!=null&&us.length!=null&&us[3]!=null&&us[3].units!=null)units=units.concat(us[3].units);query.units=units;return query},{type:"other",description:"[31] Update1"},{type:"other",description:"[32] Load"},"LOAD",{type:"literal",value:"LOAD",description:'"LOAD"'},"load",{type:"literal",value:"load",description:'"load"'},
"INTO",{type:"literal",value:"INTO",description:'"INTO"'},"into",{type:"literal",value:"into",description:'"into"'},function(sg,dg){var query={};query.kind="load";query.token="executableunit";query.sourceGraph=sg;if(dg!=null)query.destinyGraph=dg[2];return query},{type:"other",description:"[33] Clear"},"CLEAR",{type:"literal",value:"CLEAR",description:'"CLEAR"'},"clear",{type:"literal",value:"clear",description:'"clear"'},"SILENT",{type:"literal",value:"SILENT",description:'"SILENT"'},"silent",{type:"literal",
value:"silent",description:'"silent"'},function(ref){var query={};query.kind="clear";query.token="executableunit";query.destinyGraph=ref;return query},{type:"other",description:"[34] Drop"},"DROP",{type:"literal",value:"DROP",description:'"DROP"'},"drop",{type:"literal",value:"drop",description:'"drop"'},function(ref){var query={};query.kind="drop";query.token="executableunit";query.destinyGraph=ref;return query},{type:"other",description:"[35] Create"},"CREATE",{type:"literal",value:"CREATE",description:'"CREATE"'},
"create",{type:"literal",value:"create",description:'"create"'},function(ref){var query={};query.kind="create";query.token="executableunit";query.destinyGraph=ref;return query},{type:"other",description:"[36] InsertData"},"INSERT",{type:"literal",value:"INSERT",description:'"INSERT"'},"insert",{type:"literal",value:"insert",description:'"insert"'},"DATA",{type:"literal",value:"DATA",description:'"DATA"'},"data",{type:"literal",value:"data",description:'"data"'},function(qs){var query={};query.kind=
"insertdata";query.token="executableunit";query.quads=qs;return query},{type:"other",description:"[37] DeleteData"},"DELETE",{type:"literal",value:"DELETE",description:'"DELETE"'},"delete",{type:"literal",value:"delete",description:'"delete"'},function(qs){var query={};query.kind="deletedata";query.token="executableunit";query.quads=qs;return query},{type:"other",description:"[38] DeleteWhere"},function(p){var query={};query.kind="modify";query.pattern=p;query.with=null;query.using=null;var quads=
[];var patternsCollection=p.patterns[0];if(patternsCollection.triplesContext==null&&patternsCollection.patterns!=null)patternsCollection=patternsCollection.patterns[0].triplesContext;else patternsCollection=patternsCollection.triplesContext;for(var i=0;i<patternsCollection.length;i++){var quad={};var contextQuad=patternsCollection[i];quad["subject"]=contextQuad["subject"];quad["predicate"]=contextQuad["predicate"];quad["object"]=contextQuad["object"];quad["graph"]=contextQuad["graph"];quads.push(quad)}query.delete=
quads;return query},{type:"other",description:"[39] Modify"},"WITH",{type:"literal",value:"WITH",description:'"WITH"'},"with",{type:"literal",value:"with",description:'"with"'},function(wg,dic,uc,p){var query={};query.kind="modify";if(wg!=""&&wg!=null)query.with=wg[2];else query.with=null;if(dic.length===3&&(dic[2]===""||dic[2]==null)){query.delete=dic[0];query.insert=null}else if(dic.length===3&&dic[0].length!=null&&dic[1].length!=null&&dic[2].length!=null){query.delete=dic[0];query.insert=dic[2]}else{query.insert=
dic;query.delete=null}if(uc!="")query.using=uc;query.pattern=p;return query},{type:"other",description:"[40] DeleteClause"},function(q){return q},{type:"other",description:"[41] InsertClause"},{type:"other",description:"[42] UsingClause"},"USING",{type:"literal",value:"USING",description:'"USING"'},"using",{type:"literal",value:"using",description:'"using"'},function(g){if(g.length!=null)return{kind:"named",uri:g[2]};else return{kind:"default",uri:g}},{type:"other",description:"[43] GraphRef"},"GRAPH",
{type:"literal",value:"GRAPH",description:'"GRAPH"'},"graph",{type:"literal",value:"graph",description:'"graph"'},function(i){return i},{type:"other",description:"[44] GraphRefAll"},"DEFAULT",{type:"literal",value:"DEFAULT",description:'"DEFAULT"'},"default",{type:"literal",value:"default",description:'"default"'},function(){return"default"},function(){return"named"},"ALL",{type:"literal",value:"ALL",description:'"ALL"'},"all",{type:"literal",value:"all",description:'"all"'},function(){return"all"},
{type:"other",description:"[45] QuadPattern"},function(qs){return qs.quadsContext},{type:"other",description:"[46] QuadData"},{type:"other",description:"[47] Quads"},".",{type:"literal",value:".",description:'"."'},function(ts,qs){var quads=[];if(ts!=null&&ts.triplesContext!=null)for(var i=0;i<ts.triplesContext.length;i++){var triple=ts.triplesContext[i];triple.graph=null;quads.push(triple)}if(qs&&qs.length>0&&qs[0].length>0){quads=quads.concat(qs[0][0].quadsContext);if(qs[0][2]!=null&&qs[0][2].triplesContext!=
null)for(var i=0;i<qs[0][2].triplesContext.length;i++){var triple=qs[0][2].triplesContext[i];triple.graph=null;quads.push(triple)}}return{token:"quads",quadsContext:quads}},{type:"other",description:"[48] QuadsNotTriples"},function(g,ts){var quads=[];if(ts!=null)for(var i=0;i<ts.triplesContext.length;i++){var triple=ts.triplesContext[i];triple.graph=g;quads.push(triple)}return{token:"quadsnottriples",quadsContext:quads}},{type:"other",description:"[49] TriplesTemplate"},function(b,bs){var triples=
b.triplesContext;if(bs!=null&&typeof bs==="object")if(bs.length!=null)if(bs[3]!=null&&bs[3].triplesContext!=null)triples=triples.concat(bs[3].triplesContext);return{token:"triplestemplate",triplesContext:triples}},{type:"other",description:"[50] GroupGraphPattern"},function(p){return p},{type:"other",description:"[51] GroupGraphPatternSub"},function(tb,tbs){var subpatterns=[];if(tb!=null&&tb!=[])subpatterns.push(tb);for(var i=0;i<tbs.length;i++)for(var j=0;j<tbs[i].length;j++)if(tbs[i][j]!=null&&
tbs[i][j].token!=null)subpatterns.push(tbs[i][j]);var compactedSubpatterns=[];var currentBasicGraphPatterns=[];var currentFilters=[];for(var i=0;i<subpatterns.length;i++)if(subpatterns[i].token!="triplespattern"&&subpatterns[i].token!="filter"){if(currentBasicGraphPatterns.length!=0||currentFilters.length!=0){var triplesContext=[];for(var j=0;j<currentBasicGraphPatterns.length;j++)triplesContext=triplesContext.concat(currentBasicGraphPatterns[j].triplesContext);if(triplesContext.length>0)compactedSubpatterns.push({token:"basicgraphpattern",
triplesContext:triplesContext});currentBasicGraphPatterns=[]}compactedSubpatterns.push(subpatterns[i])}else if(subpatterns[i].token==="triplespattern")currentBasicGraphPatterns.push(subpatterns[i]);else currentFilters.push(subpatterns[i]);if(currentBasicGraphPatterns.length!=0||currentFilters.length!=0){var triplesContext=[];for(var j=0;j<currentBasicGraphPatterns.length;j++)triplesContext=triplesContext.concat(currentBasicGraphPatterns[j].triplesContext);if(triplesContext.length>0)compactedSubpatterns.push({token:"basicgraphpattern",
triplesContext:triplesContext})}return{token:"groupgraphpattern",patterns:compactedSubpatterns,filters:currentFilters}},{type:"other",description:"[54] TriplesBlock"},function(b,bs){var triples=b.triplesContext;if(bs!=null&&typeof bs==="object")if(bs!=null&&bs.length!=null)if(bs[2]!=null&&bs[2].triplesContext!=null)triples=triples.concat(bs[2].triplesContext);return{token:"triplespattern",triplesContext:triples}},{type:"other",description:"[53] GraphPatternNotTriples"},{type:"other",description:"[54] OptionalGraphPattern"},
"OPTIONAL",{type:"literal",value:"OPTIONAL",description:'"OPTIONAL"'},"optional",{type:"literal",value:"optional",description:'"optional"'},function(v){return{token:"optionalgraphpattern",value:v}},{type:"other",description:"[55] GraphGraphPattern"},function(g,gg){for(var i=0;i<gg.patterns.length;i++){var quads=[];var ts=gg.patterns[i];for(var j=0;j<ts.triplesContext.length;j++){var triple=ts.triplesContext[j];triple.graph=g}}gg.token="groupgraphpattern";return gg},{type:"other",description:"[56] ServiceGraphPattern"},
"SERVICE",{type:"literal",value:"SERVICE",description:'"SERVICE"'},function(v,ts){return{token:"servicegraphpattern",status:"todo",value:[v,ts]}},{type:"other",description:"[57] MinusGraphPattern"},"MINUS",{type:"literal",value:"MINUS",description:'"MINUS"'},"minus",{type:"literal",value:"minus",description:'"minus"'},function(ts){return{token:"minusgraphpattern",status:"todo",value:ts}},{type:"other",description:"[58] GroupOrUnionGraphPattern"},"UNION",{type:"literal",value:"UNION",description:'"UNION"'},
"union",{type:"literal",value:"union",description:'"union"'},function(a,b){if(b.length===0)return a;else{var lastToken={token:"graphunionpattern",value:[a]};for(var i=0;i<b.length;i++)if(i==b.length-1)lastToken.value.push(b[i][3]);else{lastToken.value.push(b[i][3]);var newToken={token:"graphunionpattern",value:[lastToken]};lastToken=newToken}return lastToken}},{type:"other",description:"[59] Filter"},"FILTER",{type:"literal",value:"FILTER",description:'"FILTER"'},"filter",{type:"literal",value:"filter",
description:'"filter"'},function(c){return{token:"filter",value:c}},{type:"other",description:"[60] Bind"},"BIND",{type:"literal",value:"BIND",description:'"BIND"'},"bind",{type:"literal",value:"bind",description:'"bind"'},function(ex,v){return{token:"bind",expresision:ex,as:v}},{type:"other",description:"[60] Constraint"},{type:"other",description:"[61] InlineData"},function(d){return d},{type:"other",description:"[62] DataBlock"},{type:"other",description:"[63] InlineDataOneVar"},function(v,d){var result=
{token:"inlineData",values:[{"var":v,"value":d}]};return result},{type:"other",description:"[64] InlineDataFull"},function(vars,vals){var result={token:"inlineData",values:[],todo:true};return result},{type:"other",description:"[65] DataBlockValue"},{type:"other",description:"[61] FunctionCall"},function(i,args){var fcall={};fcall.token="expression";fcall.expressionType="irireforfunction";fcall.iriref=i;fcall.args=args.value;return fcall},{type:"other",description:"[62] ArgList"},function(){var args=
{};args.token="args";args.value=[];return args},",",{type:"literal",value:",",description:'","'},function(d,e,es){var cleanEx=[];for(var i=0;i<es.length;i++)cleanEx.push(es[i][1]);var args={};args.token="args";args.value=[e].concat(cleanEx);if(d!=null&&d.toUpperCase()==="DISTINCT")args.distinct=true;else args.distinct=false;return args},{type:"other",description:"[63] ExpressionList"},function(e,es){var cleanEx=[];for(var i=0;i<es.length;i++)cleanEx.push(es[i][1]);var args={};args.token="args";args.value=
[e].concat(cleanEx);return args},{type:"other",description:"[64] ConstructTemplate"},function(ts){return ts},{type:"other",description:"[65] ConstructTriples"},function(b,bs){var triples=b.triplesContext;var toTest=null;if(bs!=null&&typeof bs==="object")if(bs.length!=null)if(bs[3]!=null&&bs[3].triplesContext!=null)triples=triples.concat(bs[3].triplesContext);return{token:"triplestemplate",triplesContext:triples}},{type:"other",description:"[66] TriplesSameSubject"},function(s,pairs){var triplesContext=
pairs.triplesContext;var subject=s;if(pairs.pairs)for(var i=0;i<pairs.pairs.length;i++){var pair=pairs.pairs[i];var triple=null;if(pair[1].length!=null)pair[1]=pair[1][0];if(subject.token&&subject.token==="triplesnodecollection"){triple={subject:subject.chainSubject[0],predicate:pair[0],object:pair[1]};triplesContext.push(triple);triplesContext=triplesContext.concat(subject.triplesContext)}else{triple={subject:subject,predicate:pair[0],object:pair[1]};triplesContext.push(triple)}}var token={};token.token=
"triplessamesubject";token.triplesContext=triplesContext;token.chainSubject=subject;return token},function(tn,pairs){var triplesContext=tn.triplesContext;var subject=tn.chainSubject;if(pairs.pairs)for(var i=0;i<pairs.pairs.length;i++){var pair=pairs.pairs[i];if(pair[1].length!=null)pair[1]=pair[1][0];if(tn.token==="triplesnodecollection")for(var j=0;j<subject.length;j++){var subj=subject[j];if(subj.triplesContext!=null){var triple={subject:subj.chainSubject,predicate:pair[0],object:pair[1]};triplesContext.concat(subj.triplesContext)}else{var triple=
{subject:subject[j],predicate:pair[0],object:pair[1]};triplesContext.push(triple)}}else{var triple={subject:subject,predicate:pair[0],object:pair[1]};triplesContext.push(triple)}}var token={};token.token="triplessamesubject";token.triplesContext=triplesContext;token.chainSubject=subject;return token},{type:"other",description:"[83] PropertyListPathNotEmpty"},function(v,ol,rest){var token={};token.token="propertylist";var triplesContext=[];var pairs=[];var test=[];for(var i=0;i<ol.length;i++)if(ol[i].triplesContext!=
null){triplesContext=triplesContext.concat(ol[i].triplesContext);if(ol[i].token==="triplesnodecollection"&&ol[i].chainSubject.length!=null)pairs.push([v,ol[i].chainSubject[0]]);else pairs.push([v,ol[i].chainSubject])}else pairs.push([v,ol[i]]);for(var i=0;i<rest.length;i++){var tok=rest[i][3];var newVerb=tok[0];var newObjsList=tok[2]||[];for(var j=0;j<newObjsList.length;j++)if(newObjsList[j].triplesContext!=null){triplesContext=triplesContext.concat(newObjsList[j].triplesContext);pairs.push([newVerb,
newObjsList[j].chainSubject])}else pairs.push([newVerb,newObjsList[j]])}token.pairs=pairs;token.triplesContext=triplesContext;return token},{type:"other",description:"[67] PropertyListNotEmpty"},function(v,ol,rest){var token={};token.token="propertylist";var triplesContext=[];var pairs=[];var test=[];for(var i=0;i<ol.length;i++)if(ol[i].triplesContext!=null){triplesContext=triplesContext.concat(ol[i].triplesContext);if(ol[i].token==="triplesnodecollection"&&ol[i].chainSubject.length!=null)pairs.push([v,
ol[i].chainSubject[0]]);else pairs.push([v,ol[i].chainSubject])}else pairs.push([v,ol[i]]);for(var i=0;i<rest.length;i++){var tok=rest[i][3];var newVerb=tok[0];var newObjsList=tok[2]||[];for(var j=0;j<newObjsList.length;j++)if(newObjsList[j].triplesContext!=null){triplesContext=triplesContext.concat(newObjsList[j].triplesContext);pairs.push([newVerb,newObjsList[j].chainSubject])}else pairs.push([newVerb,newObjsList[j]])}token.pairs=pairs;token.triplesContext=triplesContext;return token},{type:"other",
description:"[68] PropertyList"},{type:"other",description:"[86] ObjectListPath"},function(obj,objs){var toReturn=[];toReturn.push(obj);for(var i=0;i<objs.length;i++)for(var j=0;j<objs[i].length;j++)if(typeof objs[i][j]=="object"&&objs[i][j].token!=null)toReturn.push(objs[i][j]);return toReturn},{type:"other",description:"[69] ObjectList"},function(obj,objs){var toReturn=[];toReturn.push(obj);for(var i=0;i<objs.length;i++)for(var j=0;j<objs[i].length;j++)if(typeof objs[i][j]=="object"&&objs[i][j].token!=
null)toReturn.push(objs[i][j]);return toReturn},{type:"other",description:"[87] ObjectPath"},{type:"other",description:"[70] Object"},{type:"other",description:"[71] Verb"},"a",{type:"literal",value:"a",description:'"a"'},function(){return{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}},{type:"other",description:"[72] TriplesSameSubjectPath"},function(s,pairs){var triplesContext=pairs.triplesContext;var subject=s;if(pairs.pairs)for(var i=0;i<pairs.pairs.length;i++){var pair=
pairs.pairs[i];var triple=null;if(pair[1].length!=null)pair[1]=pair[1][0];if(subject.token&&subject.token==="triplesnodecollection"){triple={subject:subject.chainSubject[0],predicate:pair[0],object:pair[1]};if(triple.predicate.token==="path"&&triple.predicate.kind==="element")triple.predicate=triple.predicate.value;triplesContext.push(triple);triplesContext=triplesContext.concat(subject.triplesContext)}else{triple={subject:subject,predicate:pair[0],object:pair[1]};if(triple.predicate.token==="path"&&
triple.predicate.kind==="element")triple.predicate=triple.predicate.value;triplesContext.push(triple)}}var token={};token.token="triplessamesubject";token.triplesContext=triplesContext;token.chainSubject=subject;return token},function(tn,pairs){var triplesContext=tn.triplesContext;var subject=tn.chainSubject;if(pairs!=null&&pairs.pairs!=null)for(var i=0;i<pairs.pairs.length;i++){var pair=pairs.pairs[i];if(pair[1].length!=null)pair[1]=pair[1][0];if(tn.token==="triplesnodecollection")for(var j=0;j<
subject.length;j++){var subj=subject[j];if(subj.triplesContext!=null){var triple={subject:subj.chainSubject,predicate:pair[0],object:pair[1]};triplesContext.concat(subj.triplesContext)}else{var triple={subject:subject[j],predicate:pair[0],object:pair[1]};triplesContext.push(triple)}}else{var triple={subject:subject,predicate:pair[0],object:pair[1]};triplesContext.push(triple)}}var token={};token.token="triplessamesubject";token.triplesContext=triplesContext;token.chainSubject=subject;return token},
{type:"other",description:"[73] PropertyListNotEmptyPath"},function(v,ol,rest){token={};token.token="propertylist";var triplesContext=[];var pairs=[];var test=[];for(var i=0;i<ol.length;i++)if(ol[i].triplesContext!=null){triplesContext=triplesContext.concat(ol[i].triplesContext);if(ol[i].token==="triplesnodecollection"&&ol[i].chainSubject.length!=null)pairs.push([v,ol[i].chainSubject[0]]);else pairs.push([v,ol[i].chainSubject])}else pairs.push([v,ol[i]]);for(var i=0;i<rest.length;i++){var tok=rest[i][3];
var newVerb=tok[0];var newObjsList=tok[1]||[];for(var j=0;j<newObjsList.length;j++)if(newObjsList[j].triplesContext!=null){triplesContext=triplesContext.concat(newObjsList[j].triplesContext);pairs.push([newVerb,newObjsList[j].chainSubject])}else pairs.push([newVerb,newObjsList[j]])}token.pairs=pairs;token.triplesContext=triplesContext;return token},{type:"other",description:"[74] PropertyListPath"},{type:"other",description:"[75]"},function(p){var path={};path.token="path";path.kind="element";path.value=
p;return p},{type:"other",description:"[76] VerbSimple"},{type:"other",description:"[77] Path"},{type:"other",description:"[78] PathAlternative"},"|",{type:"literal",value:"|",description:'"|"'},function(first,rest){if(rest==null||rest.length===0)return first;else{var acum=[];for(var i=0;i<rest.length;i++)acum.push(rest[1]);var path={};path.token="path";path.kind="alternative";path.value=acum;return path}},{type:"other",description:"[79] PathSequence"},"/",{type:"literal",value:"/",description:'"/"'},
function(first,rest){if(rest==null||rest.length===0)return first;else{var acum=[first];for(var i=0;i<rest.length;i++)acum.push(rest[i][1]);var path={};path.token="path";path.kind="sequence";path.value=acum;return path}},{type:"other",description:"[88] PathElt"},function(p,mod){if(p.token&&p.token!="path"&&mod=="")return p;else if(p.token&&p.token!=path&&mod!=""){var path={};path.token="path";path.kind="element";path.value=p;path.modifier=mod;return path}else{p.modifier=mod;return p}},{type:"other",
description:"[81] PathEltOrInverse"},"^",{type:"literal",value:"^",description:'"^"'},function(elt){var path={};path.token="path";path.kind="inversePath";path.value=elt;return path},{type:"other",description:"[82] PathMod"},"?",{type:"literal",value:"?",description:'"?"'},"+",{type:"literal",value:"+",description:'"+"'},{type:"other",description:"[83] PathPrimary"},"!",{type:"literal",value:"!",description:'"!"'},{type:"other",description:"[85] PathOneInPropertySet"},{type:"other",description:"[86] Integer"},
{type:"other",description:"[100] TriplesNodePath"},function(c){var triplesContext=[];var chainSubject=[];var triple=null;for(var i=0;i<c.length;i++){GlobalBlankNodeCounter++;var nextObject=null;if(c[i].chainSubject==null&&c[i].triplesContext==null)nextObject=c[i];else{nextObject=c[i].chainSubject;triplesContext=triplesContext.concat(c[i].triplesContext)}triple={subject:{token:"blank",value:"_:"+GlobalBlankNodeCounter},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},
object:nextObject};if(i==0)chainSubject.push(triple.subject);triplesContext.push(triple);if(i===c.length-1)triple={subject:{token:"blank",value:"_:"+GlobalBlankNodeCounter},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}};else triple={subject:{token:"blank",value:"_:"+GlobalBlankNodeCounter},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},
object:{token:"blank",value:"_:"+(GlobalBlankNodeCounter+1)}};triplesContext.push(triple)}return{token:"triplesnodecollection",triplesContext:triplesContext,chainSubject:chainSubject}},{type:"other",description:"[87] TriplesNode"},function(c){var triplesContext=[];var chainSubject=[];var triple=null;for(var i=0;i<c.length;i++){GlobalBlankNodeCounter++;var nextObject=null;if(c[i].chainSubject==null&&c[i].triplesContext==null)nextObject=c[i];else{nextObject=c[i].chainSubject;triplesContext=triplesContext.concat(nextObject.triplesContext)}triple=
{subject:{token:"blank",value:"_:"+GlobalBlankNodeCounter},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:nextObject};if(i==0)chainSubject.push(triple.subject);triplesContext.push(triple);if(i===c.length-1)triple={subject:{token:"blank",value:"_:"+GlobalBlankNodeCounter},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}};
else triple={subject:{token:"blank",value:"_:"+GlobalBlankNodeCounter},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(GlobalBlankNodeCounter+1)}};triplesContext.push(triple)}return{token:"triplesnodecollection",triplesContext:triplesContext,chainSubject:chainSubject}},{type:"other",description:"[101] BlankNodePropertyListPath"},"[",{type:"literal",value:"[",description:'"["'},"]",{type:"literal",value:"]",description:'"]"'},
function(pl){GlobalBlankNodeCounter++;var subject={token:"blank",value:"_:"+GlobalBlankNodeCounter};var newTriples=[];for(var i=0;i<pl.pairs.length;i++){var pair=pl.pairs[i];var triple={};triple.subject=subject;triple.predicate=pair[0];if(pair[1].length!=null)pair[1]=pair[1][0];triple.object=pair[1];newTriples.push(triple)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:pl.triplesContext.concat(newTriples),chainSubject:subject}},{type:"other",description:"[88] BlankNodePropertyList"},
function(pl){GlobalBlankNodeCounter++;var subject={token:"blank",value:"_:"+GlobalBlankNodeCounter};var newTriples=[];for(var i=0;i<pl.pairs.length;i++){var pair=pl.pairs[i];var triple={};triple.subject=subject;triple.predicate=pair[0];if(pair[1].length!=null)pair[1]=pair[1][0];triple.object=pair[1];newTriples.push(triple)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:pl.triplesContext.concat(newTriples),chainSubject:subject}},{type:"other",description:"[103] CollectionPath"},
function(gn){return gn},{type:"other",description:"[89] Collection"},{type:"other",description:"[105] GraphNodePath"},function(gn){return gn[1]},{type:"other",description:"[90] GraphNode"},{type:"other",description:"[91] VarOrTerm"},{type:"other",description:"[92] VarOrIRIref"},{type:"other",description:"[93] Var"},function(v){var term={};term.token="var";term.value=v;return term},{type:"other",description:"[94] GraphTerm"},{type:"other",description:"[95] Expression"},{type:"other",description:"[96] ConditionalOrExpression"},
"||",{type:"literal",value:"||",description:'"||"'},function(v,vs){if(vs.length===0)return v;var exp={};exp.token="expression";exp.expressionType="conditionalor";var ops=[v];for(var i=0;i<vs.length;i++)ops.push(vs[i][3]);exp.operands=ops;return exp},{type:"other",description:"[97] ConditionalAndExpression"},"&&",{type:"literal",value:"&&",description:'"&&"'},function(v,vs){if(vs.length===0)return v;var exp={};exp.token="expression";exp.expressionType="conditionaland";var ops=[v];for(var i=0;i<vs.length;i++)ops.push(vs[i][3]);
exp.operands=ops;return exp},{type:"other",description:"[98] ValueLogical"},{type:"other",description:"[99] RelationalExpression"},"=",{type:"literal",value:"=",description:'"="'},"!=",{type:"literal",value:"!=",description:'"!="'},"<",{type:"literal",value:"<",description:'"<"'},">",{type:"literal",value:">",description:'">"'},"<=",{type:"literal",value:"<=",description:'"<="'},">=",{type:"literal",value:">=",description:'">="'},"I",{type:"literal",value:"I",description:'"I"'},"i",{type:"literal",
value:"i",description:'"i"'},"N",{type:"literal",value:"N",description:'"N"'},"n",{type:"literal",value:"n",description:'"n"'},"O",{type:"literal",value:"O",description:'"O"'},"o",{type:"literal",value:"o",description:'"o"'},"T",{type:"literal",value:"T",description:'"T"'},"t",{type:"literal",value:"t",description:'"t"'},function(op1,op2){if(op2.length===0)return op1;else if(op2[0][1]==="i"||op2[0][1]==="I"||op2[0][1]==="n"||op2[0][1]==="N"){var exp={};if(op2[0][1]==="i"||op2[0][1]==="I"){var operator=
"=";exp.expressionType="conditionalor"}else{var operator="!=";exp.expressionType="conditionaland"}var lop=op1;var rops=[];for(var opi=0;opi<op2[0].length;opi++)if(op2[0][opi].token==="args"){rops=op2[0][opi].value;break}exp.token="expression";exp.operands=[];for(var i=0;i<rops.length;i++){var nextOperand={};nextOperand.token="expression";nextOperand.expressionType="relationalexpression";nextOperand.operator=operator;nextOperand.op1=lop;nextOperand.op2=rops[i];exp.operands.push(nextOperand)}return exp}else{var exp=
{};exp.expressionType="relationalexpression";exp.operator=op2[0][1];exp.op1=op1;exp.op2=op2[0][3];exp.token="expression";return exp}},{type:"other",description:"[100] NumericExpression"},{type:"other",description:"[101] AdditiveExpression"},"-",{type:"literal",value:"-",description:'"-"'},function(op1,ops){if(ops.length===0)return op1;var ex={};ex.token="expression";ex.expressionType="additiveexpression";ex.summand=op1;ex.summands=[];for(var i=0;i<ops.length;i++){var summand=ops[i];var sum={};if(summand.length==
4&&typeof summand[1]==="string"){sum.operator=summand[1];sum.expression=summand[3]}else{var subexp={};var firstFactor=sum[0];var operator=sum[1][1];var secondFactor=sum[1][3];var operator=null;if(firstFactor.value<0){sum.operator="-";firstFactor.value=-firstFactor.value}else sum.operator="+";subexp.token="expression";subexp.expressionType="multiplicativeexpression";subexp.operator=firstFactor;subexp.factors=[{operator:operator,expression:secondFactor}];sum.expression=subexp}ex.summands.push(sum)}return ex},
{type:"other",description:"[102] MultiplicativeExpression"},function(exp,exps){if(exps.length===0)return exp;var ex={};ex.token="expression";ex.expressionType="multiplicativeexpression";ex.factor=exp;ex.factors=[];for(var i=0;i<exps.length;i++){var factor=exps[i];var fact={};fact.operator=factor[1];fact.expression=factor[3];ex.factors.push(fact)}return ex},{type:"other",description:"[103] UnaryExpression"},function(e){var ex={};ex.token="expression";ex.expressionType="unaryexpression";ex.unaryexpression=
"!";ex.expression=e;return ex},function(v){var ex={};ex.token="expression";ex.expressionType="unaryexpression";ex.unaryexpression="+";ex.expression=v;return ex},function(v){var ex={};ex.token="expression";ex.expressionType="unaryexpression";ex.unaryexpression="-";ex.expression=v;return ex},{type:"other",description:"[104] PrimaryExpression"},function(v){var ex={};ex.token="expression";ex.expressionType="atomic";ex.primaryexpression="rdfliteral";ex.value=v;return ex},function(v){var ex={};ex.token=
"expression";ex.expressionType="atomic";ex.primaryexpression="numericliteral";ex.value=v;return ex},function(v){var ex={};ex.token="expression";ex.expressionType="atomic";ex.primaryexpression="booleanliteral";ex.value=v;return ex},function(v){var ex={};ex.token="expression";ex.expressionType="atomic";ex.primaryexpression="var";ex.value=v;return ex},{type:"other",description:"[105] BrackettedExpression"},function(e){return e},{type:"other",description:"[106] BuiltInCall"},"STR",{type:"literal",value:"STR",
description:'"STR"'},"str",{type:"literal",value:"str",description:'"str"'},function(e){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="str";ex.args=[e];return ex},"LANG",{type:"literal",value:"LANG",description:'"LANG"'},"lang",{type:"literal",value:"lang",description:'"lang"'},function(e){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="lang";ex.args=[e];return ex},"LANGMATCHES",{type:"literal",value:"LANGMATCHES",description:'"LANGMATCHES"'},
"langmatches",{type:"literal",value:"langmatches",description:'"langmatches"'},function(e1,e2){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="langmatches";ex.args=[e1,e2];return ex},"DATATYPE",{type:"literal",value:"DATATYPE",description:'"DATATYPE"'},"datatype",{type:"literal",value:"datatype",description:'"datatype"'},function(e){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="datatype";ex.args=[e];return ex},"BOUND",{type:"literal",
value:"BOUND",description:'"BOUND"'},"bound",{type:"literal",value:"bound",description:'"bound"'},function(v){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="bound";ex.args=[v];return ex},"IRI",{type:"literal",value:"IRI",description:'"IRI"'},"iri",{type:"literal",value:"iri",description:'"iri"'},function(e){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="iri";ex.args=[e];return ex},"URI",{type:"literal",value:"URI",description:'"URI"'},
"uri",{type:"literal",value:"uri",description:'"uri"'},function(e){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="uri";ex.args=[e];return ex},"BNODE",{type:"literal",value:"BNODE",description:'"BNODE"'},"bnode",{type:"literal",value:"bnode",description:'"bnode"'},function(arg){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="bnode";if(arg.length===5)ex.args=[arg[2]];else ex.args=null;return ex},"COALESCE",{type:"literal",value:"COALESCE",
description:'"COALESCE"'},"coalesce",{type:"literal",value:"coalesce",description:'"coalesce"'},function(args){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="coalesce";ex.args=args;return ex},"IF",{type:"literal",value:"IF",description:'"IF"'},"if",{type:"literal",value:"if",description:'"if"'},function(test,trueCond,falseCond){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="if";ex.args=[test,trueCond,falseCond];return ex},"ISLITERAL",
{type:"literal",value:"ISLITERAL",description:'"ISLITERAL"'},"isliteral",{type:"literal",value:"isliteral",description:'"isliteral"'},function(arg){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="isliteral";ex.args=[arg];return ex},"ISBLANK",{type:"literal",value:"ISBLANK",description:'"ISBLANK"'},"isblank",{type:"literal",value:"isblank",description:'"isblank"'},function(arg){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="isblank";
ex.args=[arg];return ex},"SAMETERM",{type:"literal",value:"SAMETERM",description:'"SAMETERM"'},"sameterm",{type:"literal",value:"sameterm",description:'"sameterm"'},function(e1,e2){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="sameterm";ex.args=[e1,e2];return ex},"ISURI",{type:"literal",value:"ISURI",description:'"ISURI"'},"isuri",{type:"literal",value:"isuri",description:'"isuri"'},"ISIRI",{type:"literal",value:"ISIRI",description:'"ISIRI"'},"isiri",{type:"literal",
value:"isiri",description:'"isiri"'},function(arg){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="isuri";ex.args=[arg];return ex},"custom:",{type:"literal",value:"custom:",description:'"custom:"'},"CUSTOM:",{type:"literal",value:"CUSTOM:",description:'"CUSTOM:"'},/^[a-zA-Z0-9_]/,{type:"class",value:"[a-zA-Z0-9_]",description:"[a-zA-Z0-9_]"},function(fnname,alter,finalarg){var ex={};ex.token="expression";ex.expressionType="custom";ex.name=fnname.join("");var acum=[];
for(var i=0;i<alter.length;i++)acum.push(alter[i][1]);acum.push(finalarg);ex.args=acum;return ex},{type:"other",description:"[107] RegexExpression"},"REGEX",{type:"literal",value:"REGEX",description:'"REGEX"'},"regex",{type:"literal",value:"regex",description:'"regex"'},function(e1,e2,eo){var regex={};regex.token="expression";regex.expressionType="regex";regex.text=e1;regex.pattern=e2;regex.flags=eo[2];return regex},{type:"other",description:"[108] ExistsFunc"},"EXISTS",{type:"literal",value:"EXISTS",
description:'"EXISTS"'},"exists",{type:"literal",value:"exists",description:'"exists"'},function(ggp){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="exists";ex.args=[ggp];return ex},{type:"other",description:"[109] NotExistsFunc"},"NOT",{type:"literal",value:"NOT",description:'"NOT"'},"not",{type:"literal",value:"not",description:'"not"'},function(ggp){var ex={};ex.token="expression";ex.expressionType="builtincall";ex.builtincall="notexists";ex.args=[ggp];return ex},
{type:"other",description:"[110] Aggregate"},"COUNT",{type:"literal",value:"COUNT",description:'"COUNT"'},"count",{type:"literal",value:"count",description:'"count"'},function(d,e){var exp={};exp.token="expression";exp.expressionType="aggregate";exp.aggregateType="count";exp.distinct=d!=""?"DISTINCT":d;exp.expression=e;return exp},"GROUP_CONCAT",{type:"literal",value:"GROUP_CONCAT",description:'"GROUP_CONCAT"'},"group_concat",{type:"literal",value:"group_concat",description:'"group_concat"'},"SEPARATOR",
{type:"literal",value:"SEPARATOR",description:'"SEPARATOR"'},function(d,e,s){var exp={};exp.token="expression";exp.expressionType="aggregate";exp.aggregateType="group_concat";exp.distinct=d!=""?"DISTINCT":d;exp.expression=e;exp.separator=s;return exp},"SUM",{type:"literal",value:"SUM",description:'"SUM"'},"sum",{type:"literal",value:"sum",description:'"sum"'},function(d,e){var exp={};exp.token="expression";exp.expressionType="aggregate";exp.aggregateType="sum";exp.distinct=d!=""?"DISTINCT":d;exp.expression=
e;return exp},"MIN",{type:"literal",value:"MIN",description:'"MIN"'},"min",{type:"literal",value:"min",description:'"min"'},function(d,e){var exp={};exp.token="expression";exp.expressionType="aggregate";exp.aggregateType="min";exp.distinct=d!=""?"DISTINCT":d;exp.expression=e;return exp},"MAX",{type:"literal",value:"MAX",description:'"MAX"'},"max",{type:"literal",value:"max",description:'"max"'},function(d,e){var exp={};exp.token="expression";exp.expressionType="aggregate";exp.aggregateType="max";
exp.distinct=d!=""?"DISTINCT":d;exp.expression=e;return exp},"AVG",{type:"literal",value:"AVG",description:'"AVG"'},"avg",{type:"literal",value:"avg",description:'"avg"'},function(d,e){var exp={};exp.token="expression";exp.expressionType="aggregate";exp.aggregateType="avg";exp.distinct=d!=""?"DISTINCT":d;exp.expression=e;return exp},{type:"other",description:"[117] IRIrefOrFunction"},function(i,args){var fcall={};fcall.token="expression";fcall.expressionType="irireforfunction";fcall.iriref=i;fcall.args=
args.value;return fcall},{type:"other",description:"[112] RDFLiteral"},"^^",{type:"literal",value:"^^",description:'"^^"'},function(s,e){if(typeof e==="string"&&e.length>0)return{token:"literal",value:s.value,lang:e.slice(1),type:null};else if(e!=null&&typeof e==="object"){e.shift();return{token:"literal",value:s.value,lang:null,type:e[0]}}else return{token:"literal",value:s.value,lang:null,type:null}},{type:"other",description:"[113] NumericLiteral"},{type:"other",description:"[114] NumericLiteralUnsigned"},
{type:"other",description:"[115] NumericLiteralPositive"},{type:"other",description:"[116] NumericLiteralNegative"},{type:"other",description:"[117] BooleanLiteral"},"TRUE",{type:"literal",value:"TRUE",description:'"TRUE"'},"true",{type:"literal",value:"true",description:'"true"'},function(){var lit={};lit.token="literal";lit.lang=null;lit.type="http://www.w3.org/2001/XMLSchema#boolean";lit.value=true;return lit},"FALSE",{type:"literal",value:"FALSE",description:'"FALSE"'},"false",{type:"literal",
value:"false",description:'"false"'},function(){var lit={};lit.token="literal";lit.lang=null;lit.type="http://www.w3.org/2001/XMLSchema#boolean";lit.value=false;return lit},{type:"other",description:"[118] String"},function(s){return{token:"string",value:s}},{type:"other",description:"[119] IRIref"},function(iri){return{token:"uri",prefix:null,suffix:null,value:iri}},function(p){return p},{type:"other",description:"[120] PrefixedName"},function(p){return{token:"uri",prefix:p[0],suffix:p[1],value:null}},
function(p){return{token:"uri",prefix:p,suffix:"",value:null}},{type:"other",description:"[121] BlankNode"},function(l){return{token:"blank",value:l}},function(){GlobalBlankNodeCounter++;return{token:"blank",value:"_:"+GlobalBlankNodeCounter}},{type:"other",description:"[122] IRI_REF"},/^[^<>"{}|\^`\\]/,{type:"class",value:'[^<>"{}|\\^`\\\\]',description:'[^<>"{}|\\^`\\\\]'},function(iri_ref){return iri_ref.join("")},{type:"other",description:"[123] PNAME_NS"},":",{type:"literal",value:":",description:'":"'},
{type:"other",description:"[124] PNAME_LN"},function(p,s){return[p,s]},{type:"other",description:"[125] BLANK_NODE_LABEL"},"_:",{type:"literal",value:"_:",description:'"_:"'},function(l){return l},{type:"other",description:"[126] VAR1"},function(v){return v},{type:"other",description:"[127] VAR2"},"$",{type:"literal",value:"$",description:'"$"'},{type:"other",description:"[128] LANGTAG"},"@",{type:"literal",value:"@",description:'"@"'},/^[a-zA-Z]/,{type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},
/^[a-zA-Z0-9]/,{type:"class",value:"[a-zA-Z0-9]",description:"[a-zA-Z0-9]"},function(a,b){if(b.length===0)return("@"+a.join("")).toLowerCase();else return("@"+a.join("")+"-"+b[0][1].join("")).toLowerCase()},{type:"other",description:"[129] INTEGER"},/^[0-9]/,{type:"class",value:"[0-9]",description:"[0-9]"},function(d){var lit={};lit.token="literal";lit.lang=null;lit.type="http://www.w3.org/2001/XMLSchema#integer";lit.value=flattenString(d);return lit},{type:"other",description:"[130] DECIMAL"},function(a,
b,c){var lit={};lit.token="literal";lit.lang=null;lit.type="http://www.w3.org/2001/XMLSchema#decimal";lit.value=flattenString([a,b,c]);return lit},function(a,b){var lit={};lit.token="literal";lit.lang=null;lit.type="http://www.w3.org/2001/XMLSchema#decimal";lit.value=flattenString([a,b]);return lit},{type:"other",description:"[131] DOUBLE"},function(a,b,c,e){var lit={};lit.token="literal";lit.lang=null;lit.type="http://www.w3.org/2001/XMLSchema#double";lit.value=flattenString([a,b,c,e]);return lit},
function(a,b,c){var lit={};lit.token="literal";lit.lang=null;lit.type="http://www.w3.org/2001/XMLSchema#double";lit.value=flattenString([a,b,c]);return lit},function(a,b){var lit={};lit.token="literal";lit.lang=null;lit.type="http://www.w3.org/2001/XMLSchema#double";lit.value=flattenString([a,b]);return lit},{type:"other",description:"[132] INTEGER_POSITIVE"},function(d){d.value="+"+d.value;return d},{type:"other",description:"[133] DECIMAL_POSITIVE"},function(d){d.value="+"+d.value;return d},{type:"other",
description:"[134] DOUBLE_POSITIVE"},{type:"other",description:"[135] INTEGER_NEGATIVE"},function(d){d.value="-"+d.value;return d},{type:"other",description:"[136] DECIMAL_NEGATIVE"},{type:"other",description:"[137] DOUBLE_NEGATIVE"},{type:"other",description:"[138] EXPONENT"},/^[eE]/,{type:"class",value:"[eE]",description:"[eE]"},/^[+\-]/,{type:"class",value:"[+\\-]",description:"[+\\-]"},function(a,b,c){return flattenString([a,b,c])},{type:"other",description:"[139] STRING_LITERAL1"},"'",{type:"literal",
value:"'",description:'"\'"'},/^[^'\\\n\r]/,{type:"class",value:"[^'\\\\\\n\\r]",description:"[^'\\\\\\n\\r]"},function(content){return flattenString(content)},{type:"other",description:"[140] STRING_LITERAL2"},'"',{type:"literal",value:'"',description:'"\\""'},/^[^"\\\n\r]/,{type:"class",value:'[^"\\\\\\n\\r]',description:'[^"\\\\\\n\\r]'},{type:"other",description:"[141] STRING_LITERAL_LONG1"},"'''",{type:"literal",value:"'''",description:"\"'''\""},/^[^'\\]/,{type:"class",value:"[^'\\\\]",description:"[^'\\\\]"},
{type:"other",description:"[142] STRING_LITERAL_LONG2"},'"""',{type:"literal",value:'"""',description:'"\\"\\"\\""'},/^[^"\\]/,{type:"class",value:'[^"\\\\]',description:'[^"\\\\]'},{type:"other",description:"[143] ECHAR"},"\\",{type:"literal",value:"\\",description:'"\\\\"'},/^[tbnrf"']/,{type:"class",value:"[tbnrf\"']",description:"[tbnrf\"']"},{type:"other",description:"[144] NIL"},function(){return{token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}},
{type:"other",description:"[145] WS"},/^[ ]/,{type:"class",value:"[ ]",description:"[ ]"},/^[\t]/,{type:"class",value:"[\\t]",description:"[\\t]"},/^[\r]/,{type:"class",value:"[\\r]",description:"[\\r]"},/^[\n]/,{type:"class",value:"[\\n]",description:"[\\n]"},{type:"other",description:" COMMENT"},"#",{type:"literal",value:"#",description:'"#"'},/^[^\n\r]/,{type:"class",value:"[^\\n\\r]",description:"[^\\n\\r]"},{type:"other",description:"[146] ANON"},{type:"other",description:"[147] PN_CHARS_BASE"},
/^[A-Z]/,{type:"class",value:"[A-Z]",description:"[A-Z]"},/^[a-z]/,{type:"class",value:"[a-z]",description:"[a-z]"},/^[\xC0-\xD6]/,{type:"class",value:"[\\xC0-\\xD6]",description:"[\\xC0-\\xD6]"},/^[\xD8-\xF6]/,{type:"class",value:"[\\xD8-\\xF6]",description:"[\\xD8-\\xF6]"},/^[\xF8-\u02FF]/,{type:"class",value:"[\\xF8-\\u02FF]",description:"[\\xF8-\\u02FF]"},/^[\u0370-\u037D]/,{type:"class",value:"[\\u0370-\\u037D]",description:"[\\u0370-\\u037D]"},/^[\u037F-\u1FFF]/,{type:"class",value:"[\\u037F-\\u1FFF]",
description:"[\\u037F-\\u1FFF]"},/^[\u200C-\u200D]/,{type:"class",value:"[\\u200C-\\u200D]",description:"[\\u200C-\\u200D]"},/^[\u2070-\u218F]/,{type:"class",value:"[\\u2070-\\u218F]",description:"[\\u2070-\\u218F]"},/^[\u2C00-\u2FEF]/,{type:"class",value:"[\\u2C00-\\u2FEF]",description:"[\\u2C00-\\u2FEF]"},/^[\u3001-\uD7FF]/,{type:"class",value:"[\\u3001-\\uD7FF]",description:"[\\u3001-\\uD7FF]"},/^[\uF900-\uFDCF]/,{type:"class",value:"[\\uF900-\\uFDCF]",description:"[\\uF900-\\uFDCF]"},/^[\uFDF0-\uFFFD]/,
{type:"class",value:"[\\uFDF0-\\uFFFD]",description:"[\\uFDF0-\\uFFFD]"},/^[\u1000-\uEFFF]/,{type:"class",value:"[\\u1000-\\uEFFF]",description:"[\\u1000-\\uEFFF]"},{type:"other",description:"[148] PN_CHARS_U"},"_",{type:"literal",value:"_",description:'"_"'},{type:"other",description:"[149] VARNAME"},/^[\xB7]/,{type:"class",value:"[\\xB7]",description:"[\\xB7]"},/^[\u0300-\u036F]/,{type:"class",value:"[\\u0300-\\u036F]",description:"[\\u0300-\\u036F]"},/^[\u203F-\u2040]/,{type:"class",value:"[\\u203F-\\u2040]",
description:"[\\u203F-\\u2040]"},function(init,rpart){return init+rpart.join("")},{type:"other",description:"[150] PN_CHARS"},{type:"other",description:"[151] PN_PREFIX"},function(base,rest){if(rest[rest.length-1]==".")throw new Error("Wrong PN_PREFIX, cannot finish with '.'");else return base+rest.join("")},{type:"other",description:"[152] PN_LOCAL"},function(base,rest){return base+(rest||[]).join("")},{type:"other",description:"[170] PLX"},{type:"other",description:"[171] PERCENT"},"%",{type:"literal",
value:"%",description:'"%"'},function(h){return h.join("")},{type:"other",description:"[172] HEX"},/^[A-F]/,{type:"class",value:"[A-F]",description:"[A-F]"},/^[a-f]/,{type:"class",value:"[a-f]",description:"[a-f]"},{type:"other",description:"[173] PN_LOCAL_ESC"},"~",{type:"literal",value:"~",description:'"~"'},"&",{type:"literal",value:"&",description:'"&"'},function(c){return"\\"+c}],peg$bytecode=[peg$decode("7!"),peg$decode('7"*# "7?'),peg$decode('87#9*" 3 '),peg$decode('8!7$+P$7\'*/ "7**) "7+*# "7,+4%7>+*%4#6###"! %$## "$"# ""# "9*" 3!'),
peg$decode('8!7%*# " %+M$ &7\u00c0,#&7\u00c0"+;% &7&,#&7&"+)%4#6\'#"" %$## "$"# ""# "9*" 3$'),peg$decode('8! &7\u00c0,#&7\u00c0"+`$.)""2)3**) ".+""2+3,+D% &7\u00c0,#&7\u00c0"+2%7\u00a9+(%4$6-$! %$$# "$## "$"# ""# "9*" 3('),peg$decode('8! &7\u00c0,#&7\u00c0"+}$./""2/30*) ".1""2132+a% &7\u00c0,#&7\u00c0"+O%7\u00aa+E% &7\u00c0,#&7\u00c0"+3%7\u00a9+)%4&63&"" %$&# "$%# "$$# "$## "$"# ""# "9*" 3.'),peg$decode('8!7)+\u00a3$ &7\u00c0,#&7\u00c0"+\u0091% &7-,#&7-"+\u007f% &7\u00c0,#&7\u00c0"+m%71+c% &7\u00c0,#&7\u00c0"+Q%72+G% &7\u00c0,#&7\u00c0"+5%7<++%4)65)$(&$"%$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 34'),
peg$decode('8!7)+>$71+4%72+*%4#67##"! %$## "$"# ""# "9*" 36'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u02db$.9""293:*) ".;""2;3<+\u02bf% &7\u00c0,#&7\u00c0"+\u02ad%.=""2=3>*) ".?""2?3@*5 ".A""2A3B*) ".C""2C3D*# " %+\u0273% &7\u00c0,#&7\u00c0"+\u0261% &! &7\u00c0,#&7\u00c0"+?$7\u008c+5% &7\u00c0,#&7\u00c0"+#%\'#%$## "$"# ""# "*\u00e0 "! &7\u00c0,#&7\u00c0"+\u00cd$.E""2E3F+\u00bd% &7\u00c0,#&7\u00c0"+\u00ab%7\u008e+\u00a1% &7\u00c0,#&7\u00c0"+\u008f%.G""2G3H*) ".I""2I3J+s% &7\u00c0,#&7\u00c0"+a%7\u008c+W% &7\u00c0,#&7\u00c0"+E%.K""2K3L+5% &7\u00c0,#&7\u00c0"+#%\'+%$+# "$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "+\u0118$,\u0115&! &7\u00c0,#&7\u00c0"+?$7\u008c+5% &7\u00c0,#&7\u00c0"+#%\'#%$## "$"# ""# "*\u00e0 "! &7\u00c0,#&7\u00c0"+\u00cd$.E""2E3F+\u00bd% &7\u00c0,#&7\u00c0"+\u00ab%7\u008e+\u00a1% &7\u00c0,#&7\u00c0"+\u008f%.G""2G3H*) ".I""2I3J+s% &7\u00c0,#&7\u00c0"+a%7\u008c+W% &7\u00c0,#&7\u00c0"+E%.K""2K3L+5% &7\u00c0,#&7\u00c0"+#%\'+%$+# "$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# """" "*X "! &7\u00c0,#&7\u00c0"+E$.M""2M3N+5% &7\u00c0,#&7\u00c0"+#%\'#%$## "$"# ""# "+)%4&6O&"" %$&# "$%# "$$# "$## "$"# ""# "9*" 38'),
peg$decode('8! &7\u00c0,#&7\u00c0"+\u00bf$.Q""2Q3R*) ".S""2S3T+\u00a3% &7\u00c0,#&7\u00c0"+\u0091%7h+\u0087% &7\u00c0,#&7\u00c0"+u% &7-,#&7-"+c% &7\u00c0,#&7\u00c0"+Q%71+G% &7\u00c0,#&7\u00c0"+5%72++%4*6U*$&$" %$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u012d "! &7\u00c0,#&7\u00c0"+\u011a$.Q""2Q3R*) ".S""2S3T+\u00fe% &7\u00c0,#&7\u00c0"+\u00ec% &7-,#&7-"+\u00da% &7\u00c0,#&7\u00c0"+\u00c8%.V""2V3W*) ".X""2X3Y+\u00ac% &7\u00c0,#&7\u00c0"+\u009a%.Z""2Z3[+\u008a% &7\u00c0,#&7\u00c0"+x%7S*# " %+h% &7\u00c0,#&7\u00c0"+V%.\\""2\\3]+F% &7\u00c0,#&7\u00c0"+4%72+*%4.6^.#*$ %$.# "$-# "$,# "$+# "$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3P'),
peg$decode('8!.`""2`3a+t$ &7\u008b+&$,#&7\u008b""" "*) ".M""2M3N+O% &7-,#&7-"+=%71*# " %+-%72+#%\'%%$%# "$$# "$## "$"# ""# "9*" 3_'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u0085$.c""2c3d*) ".e""2e3f+i% &7\u00c0,#&7\u00c0"+W% &7-,#&7-"+E% &7\u00c0,#&7\u00c0"+3%71+)%4&6g&"" %$&# "$%# "$$# "$## "$"# ""# "9*" 3b'),peg$decode('8!.i""2i3j*) ".k""2k3l+\\$ &7\u00c0,#&7\u00c0"+J%7.*# "7/+:% &7\u00c0,#&7\u00c0"+(%4$6m$!!%$$# "$## "$"# ""# "9*" 3h'),peg$decode('8! &7\u00c0,#&7\u00c0"+2$70+(%4"6o"! %$"# ""# "9*" 3n'),
peg$decode('8!.q""2q3r*) ".s""2s3t+D$ &7\u00c0,#&7\u00c0"+2%70+(%4#6u#! %$## "$"# ""# "9*" 3p'),peg$decode('87\u00a69*" 3v'),peg$decode('8!.V""2V3W*) ".X""2X3Y*# " %+V$ &7\u00c0,#&7\u00c0"+D%7T+:% &7\u00c0,#&7\u00c0"+(%4$6x$!!%$$# "$## "$"# ""# "9*" 3w'),peg$decode('8!73*# " %+Z$75*# " %+J%77*# " %+:%79*# " %+*%4$6z$##! %$$# "$## "$"# ""# "9*" 3y'),peg$decode('8!.|""2|3}*) ".~""2~3\u007f+\u0081$ &7\u00c0,#&7\u00c0"+o%.\u0080""2\u00803\u0081*) ".\u0082""2\u00823\u0083+S% &7\u00c0,#&7\u00c0"+A% &74+&$,#&74""" "+(%4%6\u0084%! %$%# "$$# "$## "$"# ""# "9*" 3{'),
peg$decode('8! &7\u00c0,#&7\u00c0"+D$7\u0099+:% &7\u00c0,#&7\u00c0"+(%4#6\u0086#!!%$## "$"# ""# "*\u016b "! &7\u00c0,#&7\u00c0"+D$7e+:% &7\u00c0,#&7\u00c0"+(%4#6\u0087#!!%$## "$"# ""# "*\u0131 "! &7\u00c0,#&7\u00c0"+\u00e4$.E""2E3F+\u00d4% &7\u00c0,#&7\u00c0"+\u00c2%7\u008e+\u00b8% &7\u00c0,#&7\u00c0"+\u00a6%!.G""2G3H*) ".I""2I3J+?$ &7\u00c0,#&7\u00c0"+-%7\u008c+#%\'#%$## "$"# ""# "*# " %+]% &7\u00c0,#&7\u00c0"+K%.K""2K3L+;% &7\u00c0,#&7\u00c0"+)%4)6\u0088)"%#%$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*W "! &7\u00c0,#&7\u00c0"+D$7\u008c+:% &7\u00c0,#&7\u00c0"+(%4#6\u0089#!!%$## "$"# ""# "9*" 3\u0085'),
peg$decode('8!.\u008b""2\u008b3\u008c+<$ &76+&$,#&76""" "+#%\'"%$"# ""# "9*" 3\u008a'),peg$decode('87_9*" 3\u008d'),peg$decode('8!.\u008f""2\u008f3\u0090*) ".\u0091""2\u00913\u0092+\u0093$ &7\u00c0,#&7\u00c0"+\u0081%.\u0080""2\u00803\u0081*) ".\u0082""2\u00823\u0083+e% &7\u00c0,#&7\u00c0"+S% &78+&$,#&78""" "+:% &7\u00c0,#&7\u00c0"+(%4&6\u0093&!!%$&# "$%# "$$# "$## "$"# ""# "9*" 3\u008e'),peg$decode('8!.\u0095""2\u00953\u0096*A ".\u0097""2\u00973\u0098*5 ".\u0099""2\u00993\u009a*) ".\u009b""2\u009b3\u009c+W$ &7\u00c0,#&7\u00c0"+E%7\u0098+;% &7\u00c0,#&7\u00c0"+)%4$6\u009d$"#!%$$# "$## "$"# ""# "*K "!7_*# "7\u008c+:$ &7\u00c0,#&7\u00c0"+(%4"6\u009e"!!%$"# ""# "9*" 3\u0094'),
peg$decode('8!!7:+3$7;*# " %+#%\'"%$"# ""# "*> "!7;+3$7:*# " %+#%\'"%$"# ""# "+\' 4!6\u00a0!! %9*" 3\u009f'),peg$decode('8!.\u00a2""2\u00a23\u00a3*) ".\u00a4""2\u00a43\u00a5+V$ &7\u00c0,#&7\u00c0"+D%7\u00b0+:% &7\u00c0,#&7\u00c0"+(%4$6\u00a6$!!%$$# "$## "$"# ""# "9*" 3\u00a1'),peg$decode('8!.\u00a8""2\u00a83\u00a9*) ".\u00aa""2\u00aa3\u00ab+V$ &7\u00c0,#&7\u00c0"+D%7\u00b0+:% &7\u00c0,#&7\u00c0"+(%4$6\u00ac$!!%$$# "$## "$"# ""# "9*" 3\u00a7'),peg$decode('8!.\u00ae""2\u00ae3\u00af+\u00e7$ &7\u008c,#&7\u008c"+\u00d5%.Z""2Z3[+\u00c5% &!.E""2E3F+L$ &7=+&$,#&7=""" "+3%.K""2K3L+#%\'#%$## "$"# ""# "*# "7\u00bf,c&!.E""2E3F+L$ &7=+&$,#&7=""" "+3%.K""2K3L+#%\'#%$## "$"# ""# "*# "7\u00bf"+3%.\\""2\\3]+#%\'%%$%# "$$# "$## "$"# ""# "*# " %9*" 3\u00ad'),
peg$decode('87\u00a6*; "7\u009f*5 "7\u00a0*/ "7\u00a4*) ".\u00b1""2\u00b13\u00b29*" 3\u00b0'),peg$decode('8!!.\u00b4""2\u00b43\u00b5*) ".\u00b6""2\u00b63\u00b7+-$7a+#%\'"%$"# ""# "*# " %+\' 4!6\u00b8!! %9*" 3\u00b3'),peg$decode('87@9*" 3\u00b9'),peg$decode('8!7$+\u009b$ &7\u00c0,#&7\u00c0"+\u0089%7A+\u007f%! &7\u00c0,#&7\u00c0"+U$.\u00bb""2\u00bb3\u00bc+E% &7\u00c0,#&7\u00c0"+3%7@*# " %+#%\'$%$$# "$## "$"# ""# "*# " %+*%4$6\u00bd$##! %$$# "$## "$"# ""# "9*" 3\u00ba'),peg$decode('87B*G "7C*A "7D*; "7E*5 "7F*/ "7G*) "7H*# "7I9*" 3\u00be'),
peg$decode('8!.\u00c0""2\u00c03\u00c1*) ".\u00c2""2\u00c23\u00c3+\u00a0$ &7\u00c0,#&7\u00c0"+\u008e%7\u00a6+\u0084% &7\u00c0,#&7\u00c0"+r%!.\u00c4""2\u00c43\u00c5*) ".\u00c6""2\u00c63\u00c7+?$ &7\u00c0,#&7\u00c0"+-%7M+#%\'#%$## "$"# ""# "*# " %+)%4%6\u00c8%"" %$%# "$$# "$## "$"# ""# "9*" 3\u00bf'),peg$decode('8!.\u00ca""2\u00ca3\u00cb*) ".\u00cc""2\u00cc3\u00cd+x$ &7\u00c0,#&7\u00c0"+f%.\u00ce""2\u00ce3\u00cf*) ".\u00d0""2\u00d03\u00d1*# " %+D% &7\u00c0,#&7\u00c0"+2%7N+(%4%6\u00d2%! %$%# "$$# "$## "$"# ""# "9*" 3\u00c9'),
peg$decode('8!.\u00d4""2\u00d43\u00d5*) ".\u00d6""2\u00d63\u00d7+x$ &7\u00c0,#&7\u00c0"+f%.\u00ce""2\u00ce3\u00cf*) ".\u00d0""2\u00d03\u00d1*# " %+D% &7\u00c0,#&7\u00c0"+2%7N+(%4%6\u00d8%! %$%# "$$# "$## "$"# ""# "9*" 3\u00d3'),peg$decode('8!.\u00da""2\u00da3\u00db*) ".\u00dc""2\u00dc3\u00dd+x$ &7\u00c0,#&7\u00c0"+f%.\u00ce""2\u00ce3\u00cf*) ".\u00d0""2\u00d03\u00d1*# " %+D% &7\u00c0,#&7\u00c0"+2%7M+(%4%6\u00de%! %$%# "$$# "$## "$"# ""# "9*" 3\u00d9'),peg$decode('8!.\u00e0""2\u00e03\u00e1*) ".\u00e2""2\u00e23\u00e3+r$ &7\u00c0,#&7\u00c0"+`%.\u00e4""2\u00e43\u00e5*) ".\u00e6""2\u00e63\u00e7+D% &7\u00c0,#&7\u00c0"+2%7P+(%4%6\u00e8%! %$%# "$$# "$## "$"# ""# "9*" 3\u00df'),
peg$decode('8!.\u00ea""2\u00ea3\u00eb*) ".\u00ec""2\u00ec3\u00ed+`$ &7\u00c0,#&7\u00c0"+N%.\u00e4""2\u00e43\u00e5*) ".\u00e6""2\u00e63\u00e7+2%7P+(%4$6\u00ee$! %$$# "$## "$"# ""# "9*" 3\u00e9'),peg$decode('8!.\u00ea""2\u00ea3\u00eb*) ".\u00ec""2\u00ec3\u00ed+r$ &7\u00c0,#&7\u00c0"+`%.V""2V3W*) ".X""2X3Y+D% &7\u00c0,#&7\u00c0"+2%7T+(%4%6\u00f0%! %$%# "$$# "$## "$"# ""# "9*" 3\u00ef'),peg$decode('8!!.\u00f2""2\u00f23\u00f3*) ".\u00f4""2\u00f43\u00f5+?$ &7\u00c0,#&7\u00c0"+-%7\u00a6+#%\'#%$## "$"# ""# "*# " %+\u00fa$ &7\u00c0,#&7\u00c0"+\u00e8%!7J+E$ &7\u00c0,#&7\u00c0"+3%7K*# " %+#%\'#%$## "$"# ""# "*# "7K+\u00ab% &7\u00c0,#&7\u00c0"+\u0099% &7L,#&7L"+\u0087% &7\u00c0,#&7\u00c0"+u%.V""2V3W*) ".X""2X3Y+Y% &7\u00c0,#&7\u00c0"+G%7T+=% &7\u00c0,#&7\u00c0"++%4*6\u00f6*$)\'%!%$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u00f1'),
peg$decode('8!.\u00ea""2\u00ea3\u00eb*) ".\u00ec""2\u00ec3\u00ed+2$7O+(%4"6\u00f8"! %$"# ""# "9*" 3\u00f7'),peg$decode('8!.\u00e0""2\u00e03\u00e1*) ".\u00e2""2\u00e23\u00e3+2$7O+(%4"6\u00f8"! %$"# ""# "9*" 3\u00f9'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u009f$.\u00fb""2\u00fb3\u00fc*) ".\u00fd""2\u00fd3\u00fe+\u0083% &7\u00c0,#&7\u00c0"+q%7\u00a6*\\ "!.q""2q3r*) ".s""2s3t+?$ &7\u00c0,#&7\u00c0"+-%7\u00a6+#%\'#%$## "$"# ""# "+(%4$6\u00ff$! %$$# "$## "$"# ""# "9*" 3\u00fa'),peg$decode('8!.\u0101""2\u01013\u0102*) ".\u0103""2\u01033\u0104+D$ &7\u00c0,#&7\u00c0"+2%7\u00a6+(%4#6\u0105#! %$## "$"# ""# "9*" 3\u0100'),
peg$decode('8!7M+\' 4!6x!! %*\u0086 "!.\u0107""2\u01073\u0108*) ".\u0109""2\u01093\u010a+& 4!6\u010b! %*c "!.q""2q3r*) ".s""2s3t+& 4!6\u010c! %*@ "!.\u010d""2\u010d3\u010e*) ".\u010f""2\u010f3\u0110+& 4!6\u0111! %9*" 3\u0106'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u0088$.Z""2Z3[+x% &7\u00c0,#&7\u00c0"+f%7Q+\\% &7\u00c0,#&7\u00c0"+J%.\\""2\\3]+:% &7\u00c0,#&7\u00c0"+(%4\'6\u0113\'!#%$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u0112'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u0088$.Z""2Z3[+x% &7\u00c0,#&7\u00c0"+f%7Q+\\% &7\u00c0,#&7\u00c0"+J%.\\""2\\3]+:% &7\u00c0,#&7\u00c0"+(%4\'6\u0113\'!#%$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u0114'),
peg$decode('8!7S*# " %+\u009d$ &!7R+I$.\u0116""2\u01163\u0117*# " %+3%7S*# " %+#%\'#%$## "$"# ""# ",T&!7R+I$.\u0116""2\u01163\u0117*# " %+3%7S*# " %+#%\'#%$## "$"# ""# ""+)%4"6\u0118""! %$"# ""# "9*" 3\u0115'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u00d9$.\u0101""2\u01013\u0102*) ".\u0103""2\u01033\u0104+\u00bd% &7\u00c0,#&7\u00c0"+\u00ab%7\u008b+\u00a1% &7\u00c0,#&7\u00c0"+\u008f%.Z""2Z3[+\u007f% &7\u00c0,#&7\u00c0"+m%7S*# " %+]% &7\u00c0,#&7\u00c0"+K%.\\""2\\3]+;% &7\u00c0,#&7\u00c0"+)%4+6\u011a+"\'#%$+# "$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u0119'),
peg$decode('8!7j+~$! &7\u00c0,#&7\u00c0"+U$.\u0116""2\u01163\u0117+E% &7\u00c0,#&7\u00c0"+3%7S*# " %+#%\'$%$$# "$## "$"# ""# "*# " %+)%4"6\u011c""! %$"# ""# "9*" 3\u011b'),peg$decode('8!.Z""2Z3[+f$ &7\u00c0,#&7\u00c0"+T%7(+J% &7\u00c0,#&7\u00c0"+8%.\\""2\\3]+(%4%6\u011e%!"%$%# "$$# "$## "$"# ""# "*w "!.Z""2Z3[+f$ &7\u00c0,#&7\u00c0"+T%7U+J% &7\u00c0,#&7\u00c0"+8%.\\""2\\3]+(%4%6\u011e%!"%$%# "$$# "$## "$"# ""# "9*" 3\u011d'),peg$decode('8!7V*# " %+\u00f7$ &7\u00c0,#&7\u00c0"+\u00e5% &!7W+m$ &7\u00c0,#&7\u00c0"+[%.\u0116""2\u01163\u0117*# " %+E% &7\u00c0,#&7\u00c0"+3%7V*# " %+#%\'%%$%# "$$# "$## "$"# ""# ",x&!7W+m$ &7\u00c0,#&7\u00c0"+[%.\u0116""2\u01163\u0117*# " %+E% &7\u00c0,#&7\u00c0"+3%7V*# " %+#%\'%%$%# "$$# "$## "$"# ""# ""+)%4#6\u0120#"" %$## "$"# ""# "9*" 3\u011f'),
peg$decode('8!7s+l$! &7\u00c0,#&7\u00c0"+C$.\u0116""2\u01163\u0117+3%7V*# " %+#%\'#%$## "$"# ""# "*# " %+)%4"6\u0122""! %$"# ""# "9*" 3\u0121'),peg$decode('87\\*G "7X*A "7[*; "7Y*5 "7Z*/ "7]*) "7^*# "7`9*" 3\u0123'),peg$decode('8! &7\u00c0,#&7\u00c0"+`$.\u0125""2\u01253\u0126*) ".\u0127""2\u01273\u0128+D% &7\u00c0,#&7\u00c0"+2%7T+(%4$6\u0129$! %$$# "$## "$"# ""# "9*" 3\u0124'),peg$decode('8! &7\u00c0,#&7\u00c0"+}$.\u0101""2\u01013\u0102*) ".\u0103""2\u01033\u0104+a% &7\u00c0,#&7\u00c0"+O%7\u008b+E% &7\u00c0,#&7\u00c0"+3%7T+)%4&6\u012b&"" %$&# "$%# "$$# "$## "$"# ""# "9*" 3\u012a'),
peg$decode('8!.\u012d""2\u012d3\u012e+=$7\u008b+3%7T+)%4#6\u012f#"! %$## "$"# ""# "9*" 3\u012c'),peg$decode('8!.\u0131""2\u01313\u0132*) ".\u0133""2\u01333\u0134+D$ &7\u00c0,#&7\u00c0"+2%7T+(%4#6\u0135#! %$## "$"# ""# "9*" 3\u0130'),peg$decode('8!7T+\u00d1$ &! &7\u00c0,#&7\u00c0"+[$.\u0137""2\u01373\u0138*) ".\u0139""2\u01393\u013a+?% &7\u00c0,#&7\u00c0"+-%7T+#%\'$%$$# "$## "$"# ""# ",n&! &7\u00c0,#&7\u00c0"+[$.\u0137""2\u01373\u0138*) ".\u0139""2\u01393\u013a+?% &7\u00c0,#&7\u00c0"+-%7T+#%\'$%$$# "$## "$"# ""# ""+)%4"6\u013b""! %$"# ""# "9*" 3\u0136'),
peg$decode('8! &7\u00c0,#&7\u00c0"+`$.\u013d""2\u013d3\u013e*) ".\u013f""2\u013f3\u0140+D% &7\u00c0,#&7\u00c0"+2%7_+(%4$6\u0141$! %$$# "$## "$"# ""# "9*" 3\u013c'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u00ef$.\u0143""2\u01433\u0144*) ".\u0145""2\u01453\u0146+\u00d3% &7\u00c0,#&7\u00c0"+\u00c1%.E""2E3F+\u00b1% &7\u00c0,#&7\u00c0"+\u009f%7\u008e+\u0095% &7\u00c0,#&7\u00c0"+\u0083%.I""2I3J*) ".G""2G3H+g% &7\u00c0,#&7\u00c0"+U%7\u008c+K% &7\u00c0,#&7\u00c0"+9%.K""2K3L+)%4,6\u0147,"&"%$,# "$+# "$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u0142'),
peg$decode('87\u0098*) "7\u0099*# "7e9*" 3\u0148'),peg$decode('8! &7\u00c0,#&7\u00c0"+`$.\u00b4""2\u00b43\u00b5*) ".\u00b6""2\u00b63\u00b7+D% &7\u00c0,#&7\u00c0"+2%7a+(%4$6\u014a$! %$$# "$## "$"# ""# "9*" 3\u0149'),peg$decode('87b*# "7c9*" 3\u014b'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u0089$7\u008c+\u007f% &7\u00c0,#&7\u00c0"+m%.Z""2Z3[+]% &7\u00c0,#&7\u00c0"+K% &7d,#&7d"+9%.\\""2\\3]+)%4\'6\u014d\'"%!%$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u014c'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u01fa$7\u00bf*z "!.E""2E3F+i$ &7\u00c0,#&7\u00c0"+W% &7\u008c,#&7\u008c"+E% &7\u00c0,#&7\u00c0"+3%.K""2K3L+#%\'%%$%# "$$# "$## "$"# ""# "+\u0193% &7\u00c0,#&7\u00c0"+\u0181%.Z""2Z3[+\u0171% &7\u00c0,#&7\u00c0"+\u015f% &! &7\u00c0,#&7\u00c0"+\u008b$.E""2E3F+{% &7\u00c0,#&7\u00c0"+i% &7d,#&7d"+W% &7\u00c0,#&7\u00c0"+E%.K""2K3L+5% &7\u00c0,#&7\u00c0"+#%\'\'%$\'# "$&# "$%# "$$# "$## "$"# ""# "*# "7\u00bf,\u00a4&! &7\u00c0,#&7\u00c0"+\u008b$.E""2E3F+{% &7\u00c0,#&7\u00c0"+i% &7d,#&7d"+W% &7\u00c0,#&7\u00c0"+E%.K""2K3L+5% &7\u00c0,#&7\u00c0"+#%\'\'%$\'# "$&# "$%# "$$# "$## "$"# ""# "*# "7\u00bf"+K% &7\u00c0,#&7\u00c0"+9%.\\""2\\3]+)%4(6\u014f("&"%$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u014e'),
peg$decode('8! &7\u00c0,#&7\u00c0"+b$7\u00a9*; "7\u009f*5 "7\u00a0*/ "7\u00a4*) ".\u00b1""2\u00b13\u00b2+:% &7\u00c0,#&7\u00c0"+(%4#6\u0089#!!%$## "$"# ""# "9*" 3\u0150'),peg$decode('8!7\u00a6+3$7f+)%4"6\u0152""! %$"# ""# "9*" 3\u0151'),peg$decode('8!7\u00bf+& 4!6\u0154! %*\u00bf "!.E""2E3F+\u00ae$.=""2=3>*) ".?""2?3@*# " %+\u008c%7\u008e+\u0082% &!.\u0155""2\u01553\u0156+-$7\u008e+#%\'"%$"# ""# ",>&!.\u0155""2\u01553\u0156+-$7\u008e+#%\'"%$"# ""# ""+:%.K""2K3L+*%4%6\u0157%##"!%$%# "$$# "$## "$"# ""# "9*" 3\u0153'),
peg$decode('8!7\u00bf+& 4!6\u0154! %*\u00ae "!.E""2E3F+\u009d$7\u00a6*# "7\u008e+\u008d% &!.\u0155""2\u01553\u0156+3$7\u00a6*# "7\u008e+#%\'"%$"# ""# ",D&!.\u0155""2\u01553\u0156+3$7\u00a6*# "7\u008e+#%\'"%$"# ""# ""+9%.K""2K3L+)%4$6\u0159$""!%$$# "$## "$"# ""# "9*" 3\u0158'),peg$decode('8!.Z""2Z3[+l$ &7\u00c0,#&7\u00c0"+Z%7i*# " %+J% &7\u00c0,#&7\u00c0"+8%.\\""2\\3]+(%4%6\u015b%!"%$%# "$$# "$## "$"# ""# "9*" 3\u015a'),peg$decode('8!7j+~$! &7\u00c0,#&7\u00c0"+U$.\u0116""2\u01163\u0117+E% &7\u00c0,#&7\u00c0"+3%7i*# " %+#%\'$%$$# "$## "$"# ""# "*# " %+)%4"6\u015d""! %$"# ""# "9*" 3\u015c'),
peg$decode('8! &7\u00c0,#&7\u00c0"+O$7\u008a+E% &7\u00c0,#&7\u00c0"+3%7l+)%4$6\u015f$"" %$$# "$## "$"# ""# "*b "! &7\u00c0,#&7\u00c0"+O$7\u0083+E% &7\u00c0,#&7\u00c0"+3%7m+)%4$6\u0160$"" %$$# "$## "$"# ""# "9*" 3\u015e'),peg$decode('8!7v*# "7w+\u013c$ &7\u00c0,#&7\u00c0"+\u012a%7n+\u0120% &! &7\u00c0,#&7\u00c0"+\u0082$.\u00bb""2\u00bb3\u00bc+r% &7\u00c0,#&7\u00c0"+`%!7v*# "7w+?$ &7\u00c0,#&7\u00c0"+-%7o+#%\'#%$## "$"# ""# "*# " %+#%\'$%$$# "$## "$"# ""# ",\u0095&! &7\u00c0,#&7\u00c0"+\u0082$.\u00bb""2\u00bb3\u00bc+r% &7\u00c0,#&7\u00c0"+`%!7v*# "7w+?$ &7\u00c0,#&7\u00c0"+-%7o+#%\'#%$## "$"# ""# "*# " %+#%\'$%$$# "$## "$"# ""# ""+*%4$6\u0162$##! %$$# "$## "$"# ""# "9*" 3\u0161'),
peg$decode('8!7r+\u0130$ &7\u00c0,#&7\u00c0"+\u011e%7o+\u0114% &! &7\u00c0,#&7\u00c0"+|$.\u00bb""2\u00bb3\u00bc+l% &7\u00c0,#&7\u00c0"+Z%!7r+?$ &7\u00c0,#&7\u00c0"+-%7o+#%\'#%$## "$"# ""# "*# " %+#%\'$%$$# "$## "$"# ""# ",\u008f&! &7\u00c0,#&7\u00c0"+|$.\u00bb""2\u00bb3\u00bc+l% &7\u00c0,#&7\u00c0"+Z%!7r+?$ &7\u00c0,#&7\u00c0"+-%7o+#%\'#%$## "$"# ""# "*# " %+#%\'$%$$# "$## "$"# ""# ""+*%4$6\u0164$##! %$$# "$## "$"# ""# "9*" 3\u0163'),peg$decode('87l*# " %9*" 3\u0165'),peg$decode('8!7p+\u00a7$ &7\u00c0,#&7\u00c0"+\u0095% &!.\u0155""2\u01553\u0156+?$ &7\u00c0,#&7\u00c0"+-%7p+#%\'#%$## "$"# ""# ",P&!.\u0155""2\u01553\u0156+?$ &7\u00c0,#&7\u00c0"+-%7p+#%\'#%$## "$"# ""# ""+)%4#6\u0167#"" %$## "$"# ""# "9*" 3\u0166'),
peg$decode('8!7q+\u00a7$ &7\u00c0,#&7\u00c0"+\u0095% &!.\u0155""2\u01553\u0156+?$ &7\u00c0,#&7\u00c0"+-%7q+#%\'#%$## "$"# ""# ",P&!.\u0155""2\u01553\u0156+?$ &7\u00c0,#&7\u00c0"+-%7q+#%\'#%$## "$"# ""# ""+)%4#6\u0169#"" %$## "$"# ""# "9*" 3\u0168'),peg$decode('87\u00889*" 3\u016a'),peg$decode('87\u00899*" 3\u016b'),peg$decode('87\u008b*4 "!.\u016d""2\u016d3\u016e+& 4!6\u016f! %9*" 3\u016c'),peg$decode('8! &7\u00c0,#&7\u00c0"+O$7\u008a+E% &7\u00c0,#&7\u00c0"+3%7t+)%4$6\u0171$"" %$$# "$## "$"# ""# "*b "! &7\u00c0,#&7\u00c0"+O$7\u0082+E% &7\u00c0,#&7\u00c0"+3%7u+)%4$6\u0172$"" %$$# "$## "$"# ""# "9*" 3\u0170'),
peg$decode('8!7v*# "7w+\u0118$ &7\u00c0,#&7\u00c0"+\u0106%7n+\u00fc% &! &7\u00c0,#&7\u00c0"+p$.\u00bb""2\u00bb3\u00bc+`% &7\u00c0,#&7\u00c0"+N%!7v*# "7w+-$7o+#%\'"%$"# ""# "*# " %+#%\'$%$$# "$## "$"# ""# ",\u0083&! &7\u00c0,#&7\u00c0"+p$.\u00bb""2\u00bb3\u00bc+`% &7\u00c0,#&7\u00c0"+N%!7v*# "7w+-$7o+#%\'"%$"# ""# "*# " %+#%\'$%$$# "$## "$"# ""# ""+*%4$6\u0174$##! %$$# "$## "$"# ""# "9*" 3\u0173'),peg$decode('87k*# " %9*" 3\u0175'),peg$decode("8!7x+' 4!6\u0177!! %9*\" 3\u0176"),peg$decode('87\u008c9*" 3\u0178'),
peg$decode('87y9*" 3\u0179'),peg$decode('8!7z+q$ &!.\u017b""2\u017b3\u017c+-$7z+#%\'"%$"# ""# ",>&!.\u017b""2\u017b3\u017c+-$7z+#%\'"%$"# ""# ""+)%4"6\u017d""! %$"# ""# "9*" 3\u017a'),peg$decode('8!7|+q$ &!.\u017f""2\u017f3\u0180+-$7|+#%\'"%$"# ""# ",>&!.\u017f""2\u017f3\u0180+-$7|+#%\'"%$"# ""# ""+)%4"6\u0181""! %$"# ""# "9*" 3\u017e'),peg$decode('8!7~+9$7}*# " %+)%4"6\u0183""! %$"# ""# "9*" 3\u0182'),peg$decode('87{*C "!.\u0185""2\u01853\u0186+2$7{+(%4"6\u0187"! %$"# ""# "9*" 3\u0184'),peg$decode('8.M""2M3N*\u00ea ".\u0189""2\u01893\u018a*\u00de ".\u018b""2\u018b3\u018c*\u00d2 "!.Z""2Z3[+\u00c1$!7\u0081+{$!.\u0155""2\u01553\u0156+T$.\\""2\\3]*> "!7\u0081+3$.\\""2\\3]+#%\'"%$"# ""# "+#%\'"%$"# ""# "*) ".\\""2\\3]+#%\'"%$"# ""# "*N "!.\u0155""2\u01553\u0156+=$7\u0081+3%.\\""2\\3]+#%\'#%$## "$"# ""# "+#%\'"%$"# ""# "9*" 3\u0188'),
peg$decode('87\u00a6*\u008b "!.\u016d""2\u016d3\u016e+& 4!6\u016f! %*t "!.\u018e""2\u018e3\u018f+-$7\u007f+#%\'"%$"# ""# "*S "!.E""2E3F+B$7x+8%.K""2K3L+(%4#6\u011e#!!%$## "$"# ""# "9*" 3\u018d'),peg$decode('7\u0080*\u00a7 "!.E""2E3F+\u0096$!7\u0080+k$ &!.\u017b""2\u017b3\u017c+-$7\u0080+#%\'"%$"# ""# ",>&!.\u017b""2\u017b3\u017c+-$7\u0080+#%\'"%$"# ""# ""+#%\'"%$"# ""# "*# " %+3%.K""2K3L+#%\'#%$## "$"# ""# "'),peg$decode('87\u00a6*V ".\u016d""2\u016d3\u016e*J "!.\u0185""2\u01853\u0186+9$7\u00a6*) ".\u016d""2\u016d3\u016e+#%\'"%$"# ""# "9*" 3\u0190'),
peg$decode('87\u00b09*" 3\u0191'),peg$decode('8!7\u0086+\' 4!6\u0193!! %*# "7\u00849*" 3\u0192'),peg$decode('8!7\u0087+\' 4!6\u0195!! %*# "7\u00859*" 3\u0194'),peg$decode('8! &7\u00c0,#&7\u00c0"+v$.\u0197""2\u01973\u0198+f% &7\u00c0,#&7\u00c0"+T%7t+J%.\u0199""2\u01993\u019a+:% &7\u00c0,#&7\u00c0"+(%4&6\u019b&!"%$&# "$%# "$$# "$## "$"# ""# "9*" 3\u0196'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u0088$.\u0197""2\u01973\u0198+x% &7\u00c0,#&7\u00c0"+f%7l+\\% &7\u00c0,#&7\u00c0"+J%.\u0199""2\u01993\u019a+:% &7\u00c0,#&7\u00c0"+(%4\'6\u019d\'!#%$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u019c'),
peg$decode('8! &7\u00c0,#&7\u00c0"+\u0097$.E""2E3F+\u0087% &7\u00c0,#&7\u00c0"+u% &7\u0088+&$,#&7\u0088""" "+\\% &7\u00c0,#&7\u00c0"+J%.K""2K3L+:% &7\u00c0,#&7\u00c0"+(%4\'6\u019f\'!#%$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u019e'),peg$decode('8! &7\u00c0,#&7\u00c0"+\u0097$.E""2E3F+\u0087% &7\u00c0,#&7\u00c0"+u% &7\u0089+&$,#&7\u0089""" "+\\% &7\u00c0,#&7\u00c0"+J%.K""2K3L+:% &7\u00c0,#&7\u00c0"+(%4\'6\u019f\'!#%$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u01a0'),peg$decode('8!! &7\u00c0,#&7\u00c0"+?$7\u008a+5% &7\u00c0,#&7\u00c0"+#%\'#%$## "$"# ""# "*R "! &7\u00c0,#&7\u00c0"+?$7\u0082+5% &7\u00c0,#&7\u00c0"+#%\'#%$## "$"# ""# "+\' 4!6\u01a2!! %9*" 3\u01a1'),
peg$decode('8!! &7\u00c0,#&7\u00c0"+?$7\u008a+5% &7\u00c0,#&7\u00c0"+#%\'#%$## "$"# ""# "*R "! &7\u00c0,#&7\u00c0"+?$7\u0083+5% &7\u00c0,#&7\u00c0"+#%\'#%$## "$"# ""# "+\' 4!6\u01a2!! %9*" 3\u01a3'),peg$decode('87\u008c*# "7\u008d9*" 3\u01a4'),peg$decode('87\u008c*# "7\u00a69*" 3\u01a5'),peg$decode('8! &7\u00c0,#&7\u00c0"+J$7\u00ad*# "7\u00ae+:% &7\u00c0,#&7\u00c0"+(%4#6\u01a7#!!%$## "$"# ""# "9*" 3\u01a6'),peg$decode('87\u00a6*; "7\u009f*5 "7\u00a0*/ "7\u00a4*) "7\u00a8*# "7\u00bf9*" 3\u01a8'),peg$decode('87\u008f9*" 3\u01a9'),
peg$decode('8!7\u0090+\u00b9$ &! &7\u00c0,#&7\u00c0"+O$.\u01ab""2\u01ab3\u01ac+?% &7\u00c0,#&7\u00c0"+-%7\u0090+#%\'$%$$# "$## "$"# ""# ",b&! &7\u00c0,#&7\u00c0"+O$.\u01ab""2\u01ab3\u01ac+?% &7\u00c0,#&7\u00c0"+-%7\u0090+#%\'$%$$# "$## "$"# ""# ""+)%4"6\u01ad""! %$"# ""# "9*" 3\u01aa'),peg$decode('8!7\u0091+\u00b9$ &! &7\u00c0,#&7\u00c0"+O$.\u01af""2\u01af3\u01b0+?% &7\u00c0,#&7\u00c0"+-%7\u0091+#%\'$%$$# "$## "$"# ""# ",b&! &7\u00c0,#&7\u00c0"+O$.\u01af""2\u01af3\u01b0+?% &7\u00c0,#&7\u00c0"+-%7\u0091+#%\'$%$$# "$## "$"# ""# ""+)%4"6\u01b1""! %$"# ""# "9*" 3\u01ae'),
peg$decode('87\u00929*" 3\u01b2'),peg$decode('8!7\u0093+\u05eb$ &! &7\u00c0,#&7\u00c0"+O$.\u01b4""2\u01b43\u01b5+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u02b6 "! &7\u00c0,#&7\u00c0"+O$.\u01b6""2\u01b63\u01b7+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u0271 "! &7\u00c0,#&7\u00c0"+O$.\u01b8""2\u01b83\u01b9+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u022c "! &7\u00c0,#&7\u00c0"+O$.\u01ba""2\u01ba3\u01bb+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u01e7 "! &7\u00c0,#&7\u00c0"+O$.\u01bc""2\u01bc3\u01bd+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u01a2 "! &7\u00c0,#&7\u00c0"+O$.\u01be""2\u01be3\u01bf+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u015d "! &7\u00c0,#&7\u00c0"+w$.\u01c0""2\u01c03\u01c1*) ".\u01c2""2\u01c23\u01c3+[%.\u01c4""2\u01c43\u01c5*) ".\u01c6""2\u01c63\u01c7+?% &7\u00c0,#&7\u00c0"+-%7g+#%\'%%$%# "$$# "$## "$"# ""# "*\u00f0 "! &7\u00c0,#&7\u00c0"+\u00dd$.\u01c4""2\u01c43\u01c5*) ".\u01c6""2\u01c63\u01c7+\u00c1%.\u01c8""2\u01c83\u01c9*) ".\u01ca""2\u01ca3\u01cb+\u00a5%.\u01cc""2\u01cc3\u01cd*) ".\u01ce""2\u01ce3\u01cf+\u0089% &7\u00c0,#&7\u00c0"+w%.\u01c0""2\u01c03\u01c1*) ".\u01c2""2\u01c23\u01c3+[%.\u01c4""2\u01c43\u01c5*) ".\u01c6""2\u01c63\u01c7+?% &7\u00c0,#&7\u00c0"+-%7g+#%\')%$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# ",\u02fb&! &7\u00c0,#&7\u00c0"+O$.\u01b4""2\u01b43\u01b5+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u02b6 "! &7\u00c0,#&7\u00c0"+O$.\u01b6""2\u01b63\u01b7+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u0271 "! &7\u00c0,#&7\u00c0"+O$.\u01b8""2\u01b83\u01b9+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u022c "! &7\u00c0,#&7\u00c0"+O$.\u01ba""2\u01ba3\u01bb+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u01e7 "! &7\u00c0,#&7\u00c0"+O$.\u01bc""2\u01bc3\u01bd+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u01a2 "! &7\u00c0,#&7\u00c0"+O$.\u01be""2\u01be3\u01bf+?% &7\u00c0,#&7\u00c0"+-%7\u0093+#%\'$%$$# "$## "$"# ""# "*\u015d "! &7\u00c0,#&7\u00c0"+w$.\u01c0""2\u01c03\u01c1*) ".\u01c2""2\u01c23\u01c3+[%.\u01c4""2\u01c43\u01c5*) ".\u01c6""2\u01c63\u01c7+?% &7\u00c0,#&7\u00c0"+-%7g+#%\'%%$%# "$$# "$## "$"# ""# "*\u00f0 "! &7\u00c0,#&7\u00c0"+\u00dd$.\u01c4""2\u01c43\u01c5*) ".\u01c6""2\u01c63\u01c7+\u00c1%.\u01c8""2\u01c83\u01c9*) ".\u01ca""2\u01ca3\u01cb+\u00a5%.\u01cc""2\u01cc3\u01cd*) ".\u01ce""2\u01ce3\u01cf+\u0089% &7\u00c0,#&7\u00c0"+w%.\u01c0""2\u01c03\u01c1*) ".\u01c2""2\u01c23\u01c3+[%.\u01c4""2\u01c43\u01c5*) ".\u01c6""2\u01c63\u01c7+?% &7\u00c0,#&7\u00c0"+-%7g+#%\')%$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# ""+)%4"6\u01d0""! %$"# ""# "9*" 3\u01b3'),
peg$decode('87\u00949*" 3\u01d1'),peg$decode('8!7\u0095+\u0299$ &! &7\u00c0,#&7\u00c0"+O$.\u018b""2\u018b3\u018c+?% &7\u00c0,#&7\u00c0"+-%7\u0095+#%\'$%$$# "$## "$"# ""# "*\u010d "! &7\u00c0,#&7\u00c0"+O$.\u01d3""2\u01d33\u01d4+?% &7\u00c0,#&7\u00c0"+-%7\u0095+#%\'$%$$# "$## "$"# ""# "*\u00c8 "!7\u00a3*# "7\u00a3+\u00b7$! &7\u00c0,#&7\u00c0"+O$.M""2M3N+?% &7\u00c0,#&7\u00c0"+-%7\u0096+#%\'$%$$# "$## "$"# ""# "*b "! &7\u00c0,#&7\u00c0"+O$.\u017f""2\u017f3\u0180+?% &7\u00c0,#&7\u00c0"+-%7\u0096+#%\'$%$$# "$## "$"# ""# "*# " %+#%\'"%$"# ""# ",\u0152&! &7\u00c0,#&7\u00c0"+O$.\u018b""2\u018b3\u018c+?% &7\u00c0,#&7\u00c0"+-%7\u0095+#%\'$%$$# "$## "$"# ""# "*\u010d "! &7\u00c0,#&7\u00c0"+O$.\u01d3""2\u01d33\u01d4+?% &7\u00c0,#&7\u00c0"+-%7\u0095+#%\'$%$$# "$## "$"# ""# "*\u00c8 "!7\u00a3*# "7\u00a3+\u00b7$! &7\u00c0,#&7\u00c0"+O$.M""2M3N+?% &7\u00c0,#&7\u00c0"+-%7\u0096+#%\'$%$$# "$## "$"# ""# "*b "! &7\u00c0,#&7\u00c0"+O$.\u017f""2\u017f3\u0180+?% &7\u00c0,#&7\u00c0"+-%7\u0096+#%\'$%$$# "$## "$"# ""# "*# " %+#%\'"%$"# ""# ""+)%4"6\u01d5""! %$"# ""# "9*" 3\u01d2'),
peg$decode('8!7\u0096+\u0143$ &! &7\u00c0,#&7\u00c0"+O$.M""2M3N+?% &7\u00c0,#&7\u00c0"+-%7\u0096+#%\'$%$$# "$## "$"# ""# "*b "! &7\u00c0,#&7\u00c0"+O$.\u017f""2\u017f3\u0180+?% &7\u00c0,#&7\u00c0"+-%7\u0096+#%\'$%$$# "$## "$"# ""# ",\u00a7&! &7\u00c0,#&7\u00c0"+O$.M""2M3N+?% &7\u00c0,#&7\u00c0"+-%7\u0096+#%\'$%$$# "$## "$"# ""# "*b "! &7\u00c0,#&7\u00c0"+O$.\u017f""2\u017f3\u0180+?% &7\u00c0,#&7\u00c0"+-%7\u0096+#%\'$%$$# "$## "$"# ""# ""+)%4"6\u01d7""! %$"# ""# "9*" 3\u01d6'),peg$decode('8!.\u018e""2\u018e3\u018f+D$ &7\u00c0,#&7\u00c0"+2%7\u0097+(%4#6\u01d9#! %$## "$"# ""# "*\u0093 "!.\u018b""2\u018b3\u018c+D$ &7\u00c0,#&7\u00c0"+2%7\u0097+(%4#6\u01da#! %$## "$"# ""# "*[ "!.\u01d3""2\u01d33\u01d4+D$ &7\u00c0,#&7\u00c0"+2%7\u0097+(%4#6\u01db#! %$## "$"# ""# "*# "7\u00979*" 3\u01d8'),
peg$decode('87\u0098*w "7\u0099*q "7\u009e*k "!7\u009f+\' 4!6\u01dd!! %*Y "!7\u00a0+\' 4!6\u01de!! %*G "!7\u00a4+\' 4!6\u01df!! %*5 "7\u009d*/ "!7\u008c+\' 4!6\u01e0!! %9*" 3\u01dc'),peg$decode('8!.E""2E3F+f$ &7\u00c0,#&7\u00c0"+T%7\u008e+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4%6\u01e2%!"%$%# "$$# "$## "$"# ""# "9*" 3\u01e1'),peg$decode('8!.\u01e4""2\u01e43\u01e5*) ".\u01e6""2\u01e63\u01e7+\u0088$ &7\u00c0,#&7\u00c0"+v%.E""2E3F+f% &7\u00c0,#&7\u00c0"+T%7\u008e+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4\'6\u01e8\'!"%$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u0913 "!.\u01e9""2\u01e93\u01ea*) ".\u01eb""2\u01eb3\u01ec+\u0088$ &7\u00c0,#&7\u00c0"+v%.E""2E3F+f% &7\u00c0,#&7\u00c0"+T%7\u008e+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4\'6\u01ed\'!"%$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u088b "!.\u01ee""2\u01ee3\u01ef*) ".\u01f0""2\u01f03\u01f1+\u00c7$ &7\u00c0,#&7\u00c0"+\u00b5%.E""2E3F+\u00a5% &7\u00c0,#&7\u00c0"+\u0093%7\u008e+\u0089% &7\u00c0,#&7\u00c0"+w%.\u0155""2\u01553\u0156+g% &7\u00c0,#&7\u00c0"+U%7\u008e+K% &7\u00c0,#&7\u00c0"+9%.K""2K3L+)%4+6\u01f2+"&"%$+# "$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u07c4 "!.\u01f3""2\u01f33\u01f4*) ".\u01f5""2\u01f53\u01f6+\u0088$ &7\u00c0,#&7\u00c0"+v%.E""2E3F+f% &7\u00c0,#&7\u00c0"+T%7\u008e+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4\'6\u01f7\'!"%$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u073c "!.\u01f8""2\u01f83\u01f9*) ".\u01fa""2\u01fa3\u01fb+\u0088$ &7\u00c0,#&7\u00c0"+v%.E""2E3F+f% &7\u00c0,#&7\u00c0"+T%7\u008c+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4\'6\u01fc\'!"%$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u06b4 "!.\u01fd""2\u01fd3\u01fe*) ".\u01ff""2\u01ff3\u0200+\u0088$ &7\u00c0,#&7\u00c0"+v%.E""2E3F+f% &7\u00c0,#&7\u00c0"+T%7\u008e+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4\'6\u0201\'!"%$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u062c "!.\u0202""2\u02023\u0203*) ".\u0204""2\u02043\u0205+\u0088$ &7\u00c0,#&7\u00c0"+v%.E""2E3F+f% &7\u00c0,#&7\u00c0"+T%7\u008e+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4\'6\u0206\'!"%$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u05a4 "!.\u0207""2\u02073\u0208*) ".\u0209""2\u02093\u020a+\u0099$ &7\u00c0,#&7\u00c0"+\u0087%!.E""2E3F+a$ &7\u00c0,#&7\u00c0"+O%7\u008e+E% &7\u00c0,#&7\u00c0"+3%.K""2K3L+#%\'%%$%# "$$# "$## "$"# ""# "*# "7\u00bf+(%4#6\u020b#! %$## "$"# ""# "*\u050b "!.\u020c""2\u020c3\u020d*) ".\u020e""2\u020e3\u020f+D$ &7\u00c0,#&7\u00c0"+2%7g+(%4#6\u0210#! %$## "$"# ""# "*\u04c7 "!.\u0211""2\u02113\u0212*) ".\u0213""2\u02133\u0214+\u0106$ &7\u00c0,#&7\u00c0"+\u00f4%.E""2E3F+\u00e4% &7\u00c0,#&7\u00c0"+\u00d2%7\u008e+\u00c8% &7\u00c0,#&7\u00c0"+\u00b6%.\u0155""2\u01553\u0156+\u00a6% &7\u00c0,#&7\u00c0"+\u0094%7\u008e+\u008a% &7\u00c0,#&7\u00c0"+x%.\u0155""2\u01553\u0156+h% &7\u00c0,#&7\u00c0"+V%7\u008e+L% &7\u00c0,#&7\u00c0"+:%.K""2K3L+*%4/6\u0215/#*&"%$/# "$.# "$-# "$,# "$+# "$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u03c1 "!.\u0216""2\u02163\u0217*) ".\u0218""2\u02183\u0219+\u0088$ &7\u00c0,#&7\u00c0"+v%.E""2E3F+f% &7\u00c0,#&7\u00c0"+T%7\u008e+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4\'6\u021a\'!"%$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u0339 "!.\u021b""2\u021b3\u021c*) ".\u021d""2\u021d3\u021e+\u0088$ &7\u00c0,#&7\u00c0"+v%.E""2E3F+f% &7\u00c0,#&7\u00c0"+T%7\u008e+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4\'6\u021f\'!"%$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u02b1 "!.\u0220""2\u02203\u0221*) ".\u0222""2\u02223\u0223+\u00c7$ &7\u00c0,#&7\u00c0"+\u00b5%.E""2E3F+\u00a5% &7\u00c0,#&7\u00c0"+\u0093%7\u008e+\u0089% &7\u00c0,#&7\u00c0"+w%.\u0155""2\u01553\u0156+g% &7\u00c0,#&7\u00c0"+U%7\u008e+K% &7\u00c0,#&7\u00c0"+9%.K""2K3L+)%4+6\u0224+"&"%$+# "$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u01ea "!.\u0225""2\u02253\u0226*A ".\u0227""2\u02273\u0228*5 ".\u0229""2\u02293\u022a*) ".\u022b""2\u022b3\u022c+\u0088$ &7\u00c0,#&7\u00c0"+v%.E""2E3F+f% &7\u00c0,#&7\u00c0"+T%7\u008e+J% &7\u00c0,#&7\u00c0"+8%.K""2K3L+(%4\'6\u022d\'!"%$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u014a "!.\u022e""2\u022e3\u022f*) ".\u0230""2\u02303\u0231+\u011b$ &0\u0232""1!3\u0233+,$,)&0\u0232""1!3\u0233""" "+\u00f6% &7\u00c0,#&7\u00c0"+\u00e4%.E""2E3F+\u00d4% &! &7\u00c0,#&7\u00c0"+=$7\u008e+3%.\u0155""2\u01553\u0156+#%\'#%$## "$"# ""# ",P&! &7\u00c0,#&7\u00c0"+=$7\u008e+3%.\u0155""2\u01553\u0156+#%\'#%$## "$"# ""# ""+h% &7\u00c0,#&7\u00c0"+V%7\u008e+L% &7\u00c0,#&7\u00c0"+:%.K""2K3L+*%4)6\u0234)#\'$"%$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*/ "7\u009a*) "7\u009b*# "7\u009c9*" 3\u01e3'),
peg$decode('8!.\u0236""2\u02363\u0237*) ".\u0238""2\u02383\u0239+\u0117$ &7\u00c0,#&7\u00c0"+\u0105%.E""2E3F+\u00f5% &7\u00c0,#&7\u00c0"+\u00e3%7\u008e+\u00d9% &7\u00c0,#&7\u00c0"+\u00c7%.\u0155""2\u01553\u0156+\u00b7% &7\u00c0,#&7\u00c0"+\u00a5%7\u008e+\u009b% &7\u00c0,#&7\u00c0"+\u0089%!.\u0155""2\u01553\u0156+?$ &7\u00c0,#&7\u00c0"+-%7\u008e+#%\'#%$## "$"# ""# "*# " %+L% &7\u00c0,#&7\u00c0"+:%.K""2K3L+*%4-6\u023a-#($"%$-# "$,# "$+# "$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u0235'),
peg$decode('8!.\u023c""2\u023c3\u023d*) ".\u023e""2\u023e3\u023f+D$ &7\u00c0,#&7\u00c0"+2%7T+(%4#6\u0240#! %$## "$"# ""# "9*" 3\u023b'),peg$decode('8!.\u0242""2\u02423\u0243*) ".\u0244""2\u02443\u0245+r$ &7\u00c0,#&7\u00c0"+`%.\u023c""2\u023c3\u023d*) ".\u023e""2\u023e3\u023f+D% &7\u00c0,#&7\u00c0"+2%7T+(%4%6\u0246%! %$%# "$$# "$## "$"# ""# "9*" 3\u0241'),peg$decode('8!.\u0248""2\u02483\u0249*) ".\u024a""2\u024a3\u024b+\u00db$ &7\u00c0,#&7\u00c0"+\u00c9%.E""2E3F+\u00b9% &7\u00c0,#&7\u00c0"+\u00a7%.=""2=3>*) ".?""2?3@*# " %+\u0085% &7\u00c0,#&7\u00c0"+s%.M""2M3N*# "7\u008e+]% &7\u00c0,#&7\u00c0"+K%.K""2K3L+;% &7\u00c0,#&7\u00c0"+)%4*6\u024c*"%#%$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u04aa "!.\u024d""2\u024d3\u024e*) ".\u024f""2\u024f3\u0250+\u0151$ &7\u00c0,#&7\u00c0"+\u013f%.E""2E3F+\u012f% &7\u00c0,#&7\u00c0"+\u011d%.=""2=3>*) ".?""2?3@*# " %+\u00fb% &7\u00c0,#&7\u00c0"+\u00e9%7\u008e+\u00df%!.\u00bb""2\u00bb3\u00bc+\u0095$ &7\u00c0,#&7\u00c0"+\u0083%.\u0251""2\u02513\u0252+s% &7\u00c0,#&7\u00c0"+a%.\u01b4""2\u01b43\u01b5+Q% &7\u00c0,#&7\u00c0"+?%7\u00a5+5% &7\u00c0,#&7\u00c0"+#%\'(%$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*# " %+L%.K""2K3L+<% &7\u00c0,#&7\u00c0"+*%4*6\u0253*#%#"%$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u0359 "!.\u0254""2\u02543\u0255*) ".\u0256""2\u02563\u0257+\u00cf$ &7\u00c0,#&7\u00c0"+\u00bd%.E""2E3F+\u00ad% &7\u00c0,#&7\u00c0"+\u009b%.=""2=3>*) ".?""2?3@*# " %+y% &7\u00c0,#&7\u00c0"+g%7\u008e+]% &7\u00c0,#&7\u00c0"+K%.K""2K3L+;% &7\u00c0,#&7\u00c0"+)%4*6\u0258*"%#%$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u028a "!.\u0259""2\u02593\u025a*) ".\u025b""2\u025b3\u025c+\u00cf$ &7\u00c0,#&7\u00c0"+\u00bd%.E""2E3F+\u00ad% &7\u00c0,#&7\u00c0"+\u009b%.=""2=3>*) ".?""2?3@*# " %+y% &7\u00c0,#&7\u00c0"+g%7\u008e+]% &7\u00c0,#&7\u00c0"+K%.K""2K3L+;% &7\u00c0,#&7\u00c0"+)%4*6\u025d*"%#%$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u01bb "!.\u025e""2\u025e3\u025f*) ".\u0260""2\u02603\u0261+\u00cf$ &7\u00c0,#&7\u00c0"+\u00bd%.E""2E3F+\u00ad% &7\u00c0,#&7\u00c0"+\u009b%.=""2=3>*) ".?""2?3@*# " %+y% &7\u00c0,#&7\u00c0"+g%7\u008e+]% &7\u00c0,#&7\u00c0"+K%.K""2K3L+;% &7\u00c0,#&7\u00c0"+)%4*6\u0262*"%#%$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "*\u00ec "!.\u0263""2\u02633\u0264*) ".\u0265""2\u02653\u0266+\u00cf$ &7\u00c0,#&7\u00c0"+\u00bd%.E""2E3F+\u00ad% &7\u00c0,#&7\u00c0"+\u009b%.=""2=3>*) ".?""2?3@*# " %+y% &7\u00c0,#&7\u00c0"+g%7\u008e+]% &7\u00c0,#&7\u00c0"+K%.K""2K3L+;% &7\u00c0,#&7\u00c0"+)%4*6\u0267*"%#%$*# "$)# "$(# "$\'# "$&# "$%# "$$# "$## "$"# ""# "9*" 3\u0247'),
peg$decode('8!7\u00a6+9$7f*# " %+)%4"6\u0269""! %$"# ""# "9*" 3\u0268'),peg$decode('8!7\u00a5+Z$7\u00af*> "!.\u026b""2\u026b3\u026c+-$7\u00a6+#%\'"%$"# ""# "*# " %+)%4"6\u026d""! %$"# ""# "9*" 3\u026a'),peg$decode('87\u00a1*) "7\u00a2*# "7\u00a39*" 3\u026e'),peg$decode('87\u00b2*) "7\u00b1*# "7\u00b09*" 3\u026f'),peg$decode('87\u00b5*) "7\u00b4*# "7\u00b39*" 3\u0270'),peg$decode('87\u00b8*) "7\u00b7*# "7\u00b69*" 3\u0271'),peg$decode('8!.\u0273""2\u02733\u0274*) ".\u0275""2\u02753\u0276+& 4!6\u0277! %*@ "!.\u0278""2\u02783\u0279*) ".\u027a""2\u027a3\u027b+& 4!6\u027c! %9*" 3\u0272'),
peg$decode("8!7\u00bc+' 4!6\u027e!! %*S \"!7\u00bd+' 4!6\u027e!! %*A \"!7\u00ba+' 4!6\u027e!! %*/ \"!7\u00bb+' 4!6\u027e!! %9*\" 3\u027d"),peg$decode("8!7\u00a9+' 4!6\u0280!! %*/ \"!7\u00a7+' 4!6\u0281!! %9*\" 3\u027f"),peg$decode("8!7\u00ab+' 4!6\u0283!! %*/ \"!7\u00aa+' 4!6\u0284!! %9*\" 3\u0282"),peg$decode('8!7\u00ac+\' 4!6\u0286!! %*. "!7\u00c2+& 4!6\u0287! %9*" 3\u0285'),peg$decode('8!.\u01b8""2\u01b83\u01b9+V$ &0\u0289""1!3\u028a,)&0\u0289""1!3\u028a"+8%.\u01ba""2\u01ba3\u01bb+(%4#6\u028b#!!%$## "$"# ""# "9*" 3\u0288'),
peg$decode('8!7\u00c7*# " %+8$.\u028d""2\u028d3\u028e+(%4"6\u0281"!!%$"# ""# "9*" 3\u028c'),peg$decode('8!7\u00aa+3$7\u00c8+)%4"6\u0290""! %$"# ""# "9*" 3\u028f'),peg$decode('8!.\u0292""2\u02923\u0293+2$7\u00c8+(%4"6\u0294"! %$"# ""# "9*" 3\u0291'),peg$decode('8!.\u0189""2\u01893\u018a+2$7\u00c5+(%4"6\u0296"! %$"# ""# "9*" 3\u0295'),peg$decode('8!.\u0298""2\u02983\u0299+2$7\u00c5+(%4"6\u0296"! %$"# ""# "9*" 3\u0297'),peg$decode('8!.\u029b""2\u029b3\u029c+\u00cc$ &0\u029d""1!3\u029e+,$,)&0\u029d""1!3\u029e""" "+\u00a7% &!.\u01d3""2\u01d33\u01d4+H$ &0\u029f""1!3\u02a0+,$,)&0\u029f""1!3\u02a0""" "+#%\'"%$"# ""# ",Y&!.\u01d3""2\u01d33\u01d4+H$ &0\u029f""1!3\u02a0+,$,)&0\u029f""1!3\u02a0""" "+#%\'"%$"# ""# ""+)%4#6\u02a1#"! %$## "$"# ""# "9*" 3\u029a'),
peg$decode('8! &0\u02a3""1!3\u02a4+,$,)&0\u02a3""1!3\u02a4""" "+\' 4!6\u02a5!! %9*" 3\u02a2'),peg$decode('8! &0\u02a3""1!3\u02a4+,$,)&0\u02a3""1!3\u02a4""" "+X$.\u0116""2\u01163\u0117+H% &0\u02a3""1!3\u02a4,)&0\u02a3""1!3\u02a4"+*%4#6\u02a7##"! %$## "$"# ""# "*_ "!.\u0116""2\u01163\u0117+N$ &0\u02a3""1!3\u02a4+,$,)&0\u02a3""1!3\u02a4""" "+)%4"6\u02a8""! %$"# ""# "9*" 3\u02a6'),peg$decode('8! &0\u02a3""1!3\u02a4+,$,)&0\u02a3""1!3\u02a4""" "+c$.\u0116""2\u01163\u0117+S% &0\u02a3""1!3\u02a4,)&0\u02a3""1!3\u02a4"+5%7\u00b9++%4$6\u02aa$$#"! %$$# "$## "$"# ""# "*\u00a6 "!.\u0116""2\u01163\u0117+Y$ &0\u02a3""1!3\u02a4+,$,)&0\u02a3""1!3\u02a4""" "+4%7\u00b9+*%4#6\u02ab##"! %$## "$"# ""# "*Y "! &0\u02a3""1!3\u02a4+,$,)&0\u02a3""1!3\u02a4""" "+3$7\u00b9+)%4"6\u02ac""! %$"# ""# "9*" 3\u02a9'),
peg$decode('8!.\u018b""2\u018b3\u018c+2$7\u00b0+(%4"6\u02ae"! %$"# ""# "9*" 3\u02ad'),peg$decode('8!.\u018b""2\u018b3\u018c+2$7\u00b1+(%4"6\u02b0"! %$"# ""# "9*" 3\u02af'),peg$decode('8!.\u018b""2\u018b3\u018c+2$7\u00b2+(%4"6\u02b0"! %$"# ""# "9*" 3\u02b1'),peg$decode('8!.\u01d3""2\u01d33\u01d4+2$7\u00b0+(%4"6\u02b3"! %$"# ""# "9*" 3\u02b2'),peg$decode('8!.\u01d3""2\u01d33\u01d4+2$7\u00b1+(%4"6\u02b3"! %$"# ""# "9*" 3\u02b4'),peg$decode('8!.\u01d3""2\u01d33\u01d4+2$7\u00b2+(%4"6\u02b3"! %$"# ""# "9*" 3\u02b5'),
peg$decode('8!0\u02b7""1!3\u02b8+e$0\u02b9""1!3\u02ba*# " %+O% &0\u02a3""1!3\u02a4+,$,)&0\u02a3""1!3\u02a4""" "+*%4#6\u02bb##"! %$## "$"# ""# "9*" 3\u02b6'),peg$decode('8!.\u02bd""2\u02bd3\u02be+b$ &0\u02bf""1!3\u02c0*# "7\u00be,/&0\u02bf""1!3\u02c0*# "7\u00be"+8%.\u02bd""2\u02bd3\u02be+(%4#6\u02c1#!!%$## "$"# ""# "9*" 3\u02bc'),peg$decode('8!.\u02c3""2\u02c33\u02c4+b$ &0\u02c5""1!3\u02c6*# "7\u00be,/&0\u02c5""1!3\u02c6*# "7\u00be"+8%.\u02c3""2\u02c33\u02c4+(%4#6\u02c1#!!%$## "$"# ""# "9*" 3\u02c2'),
peg$decode('8!.\u02c8""2\u02c83\u02c9+b$ &0\u02ca""1!3\u02cb*# "7\u00be,/&0\u02ca""1!3\u02cb*# "7\u00be"+8%.\u02c8""2\u02c83\u02c9+(%4#6\u02c1#!!%$## "$"# ""# "9*" 3\u02c7'),peg$decode('8!.\u02cd""2\u02cd3\u02ce+b$ &0\u02cf""1!3\u02d0*# "7\u00be,/&0\u02cf""1!3\u02d0*# "7\u00be"+8%.\u02cd""2\u02cd3\u02ce+(%4#6\u02c1#!!%$## "$"# ""# "9*" 3\u02cc'),peg$decode('8!.\u02d2""2\u02d23\u02d3+3$0\u02d4""1!3\u02d5+#%\'"%$"# ""# "9*" 3\u02d1'),peg$decode('8!.E""2E3F+I$ &7\u00c0,#&7\u00c0"+7%.K""2K3L+\'%4#6\u02d7# %$## "$"# ""# "9*" 3\u02d6'),
peg$decode('80\u02d9""1!3\u02da*G "0\u02db""1!3\u02dc*; "0\u02dd""1!3\u02de*/ "0\u02df""1!3\u02e0*# "7\u00c19*" 3\u02d8'),peg$decode('8!.\u02e2""2\u02e23\u02e3+A$ &0\u02e4""1!3\u02e5,)&0\u02e4""1!3\u02e5"+#%\'"%$"# ""# "9*" 3\u02e1'),peg$decode('8!.\u0197""2\u01973\u0198+E$ &7\u00c0,#&7\u00c0"+3%.\u0199""2\u01993\u019a+#%\'#%$## "$"# ""# "9*" 3\u02e6'),peg$decode('80\u02e8""1!3\u02e9*\u00b9 "0\u02ea""1!3\u02eb*\u00ad "0\u02ec""1!3\u02ed*\u00a1 "0\u02ee""1!3\u02ef*\u0095 "0\u02f0""1!3\u02f1*\u0089 "0\u02f2""1!3\u02f3*} "0\u02f4""1!3\u02f5*q "0\u02f6""1!3\u02f7*e "0\u02f8""1!3\u02f9*Y "0\u02fa""1!3\u02fb*M "0\u02fc""1!3\u02fd*A "0\u02fe""1!3\u02ff*5 "0\u0300""1!3\u0301*) "0\u0302""1!3\u03039*" 3\u02e7'),
peg$decode('87\u00c3*) ".\u0305""2\u03053\u03069*" 3\u0304'),peg$decode('8!7\u00c4*) "0\u02a3""1!3\u02a4+\u009b$ &7\u00c4*M "0\u02a3""1!3\u02a4*A "0\u0308""1!3\u0309*5 "0\u030a""1!3\u030b*) "0\u030c""1!3\u030d,S&7\u00c4*M "0\u02a3""1!3\u02a4*A "0\u0308""1!3\u0309*5 "0\u030a""1!3\u030b*) "0\u030c""1!3\u030d"+)%4"6\u030e""! %$"# ""# "9*" 3\u0307'),peg$decode('87\u00c4*Y ".\u01d3""2\u01d33\u01d4*M "0\u02a3""1!3\u02a4*A "0\u0308""1!3\u0309*5 "0\u030a""1!3\u030b*) "0\u030c""1!3\u030d9*" 3\u030f'),peg$decode('8!7\u00c3+S$ &7\u00c6*) ".\u0116""2\u01163\u0117,/&7\u00c6*) ".\u0116""2\u01163\u0117"+)%4"6\u0311""! %$"# ""# "9*" 3\u0310'),
peg$decode('8!7\u00c4*; "0\u02a3""1!3\u02a4*/ ".\u028d""2\u028d3\u028e*# "7\u00c9+w$ &7\u00c6*; ".\u0116""2\u01163\u0117*/ ".\u028d""2\u028d3\u028e*# "7\u00c9,A&7\u00c6*; ".\u0116""2\u01163\u0117*/ ".\u028d""2\u028d3\u028e*# "7\u00c9"+)%4"6\u0313""! %$"# ""# "9*" 3\u0312'),peg$decode('87\u00ca*# "7\u00cc9*" 3\u0314'),peg$decode('8!!.\u0316""2\u03163\u0317+7$7\u00cb+-%7\u00cb+#%\'#%$## "$"# ""# "+\' 4!6\u0318!! %9*" 3\u0315'),peg$decode('80\u02a3""1!3\u02a4*5 "0\u031a""1!3\u031b*) "0\u031c""1!3\u031d9*" 3\u0319'),
peg$decode('8!.\u02d2""2\u02d23\u02d3+\u0128$.\u0305""2\u03053\u0306*\u010d ".\u031f""2\u031f3\u0320*\u0101 ".\u0116""2\u01163\u0117*\u00f5 ".\u01d3""2\u01d33\u01d4*\u00e9 ".\u018e""2\u018e3\u018f*\u00dd ".\u0298""2\u02983\u0299*\u00d1 ".\u0321""2\u03213\u0322*\u00c5 ".\u02bd""2\u02bd3\u02be*\u00b9 ".E""2E3F*\u00ad ".K""2K3L*\u00a1 ".M""2M3N*\u0095 ".\u018b""2\u018b3\u018c*\u0089 ".\u0155""2\u01553\u0156*} ".\u00bb""2\u00bb3\u00bc*q ".\u028d""2\u028d3\u028e*e ".\u01b4""2\u01b43\u01b5*Y ".\u017f""2\u017f3\u0180*M ".\u0189""2\u01893\u018a*A ".\u02e2""2\u02e23\u02e3*5 ".\u029b""2\u029b3\u029c*) ".\u0316""2\u03163\u0317+(%4"6\u0323"! %$"# ""# "9*" 3\u031e')],
peg$currPos=0,peg$reportedPos=0,peg$cachedPos=0,peg$cachedPosDetails={line:1,column:1,seenCR:false},peg$maxFailPos=0,peg$maxFailExpected=[],peg$silentFails=0,peg$result;if("startRule"in options){if(!(options.startRule in peg$startRuleIndices))throw new Error("Can't start parsing from rule \""+options.startRule+'".');peg$startRuleIndex=peg$startRuleIndices[options.startRule]}function text(){return input.substring(peg$reportedPos,peg$currPos)}function offset(){return peg$reportedPos}function line(){return peg$computePosDetails(peg$reportedPos).line}
function column(){return peg$computePosDetails(peg$reportedPos).column}function expected(description){throw peg$buildException(null,[{type:"other",description:description}],peg$reportedPos);}function error(message){throw peg$buildException(message,null,peg$reportedPos);}function peg$computePosDetails(pos){function advance(details,startPos,endPos){var p,ch;for(p=startPos;p<endPos;p++){ch=input.charAt(p);if(ch==="\n"){if(!details.seenCR)details.line++;details.column=1;details.seenCR=false}else if(ch===
"\r"||ch==="\u2028"||ch==="\u2029"){details.line++;details.column=1;details.seenCR=true}else{details.column++;details.seenCR=false}}}if(peg$cachedPos!==pos){if(peg$cachedPos>pos){peg$cachedPos=0;peg$cachedPosDetails={line:1,column:1,seenCR:false}}advance(peg$cachedPosDetails,peg$cachedPos,pos);peg$cachedPos=pos}return peg$cachedPosDetails}function peg$fail(expected){if(peg$currPos<peg$maxFailPos)return;if(peg$currPos>peg$maxFailPos){peg$maxFailPos=peg$currPos;peg$maxFailExpected=[]}peg$maxFailExpected.push(expected)}
function peg$buildException(message,expected,pos){function cleanupExpected(expected){var i=1;expected.sort(function(a,b){if(a.description<b.description)return-1;else if(a.description>b.description)return 1;else return 0});while(i<expected.length)if(expected[i-1]===expected[i])expected.splice(i,1);else i++}function buildMessage(expected,found){function stringEscape(s){function hex(ch){return ch.charCodeAt(0).toString(16).toUpperCase()}return s.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,
"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(ch){return"\\x0"+hex(ch)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(ch){return"\\x"+hex(ch)}).replace(/[\u0180-\u0FFF]/g,function(ch){return"\\u0"+hex(ch)}).replace(/[\u1080-\uFFFF]/g,function(ch){return"\\u"+hex(ch)})}var expectedDescs=new Array(expected.length),expectedDesc,foundDesc,i;for(i=0;i<expected.length;i++)expectedDescs[i]=expected[i].description;expectedDesc=
expected.length>1?expectedDescs.slice(0,-1).join(", ")+" or "+expectedDescs[expected.length-1]:expectedDescs[0];foundDesc=found?'"'+stringEscape(found)+'"':"end of input";return"Expected "+expectedDesc+" but "+foundDesc+" found."}var posDetails=peg$computePosDetails(pos),found=pos<input.length?input.charAt(pos):null;if(expected!==null)cleanupExpected(expected);return new SyntaxError(message!==null?message:buildMessage(expected,found),expected,found,pos,posDetails.line,posDetails.column)}function peg$decode(s){var bc=
new Array(s.length),i;for(i=0;i<s.length;i++)bc[i]=s.charCodeAt(i)-32;return bc}function peg$parseRule(index){var bc=peg$bytecode[index],ip=0,ips=[],end=bc.length,ends=[],stack=[],params,i;function protect(object){return Object.prototype.toString.apply(object)==="[object Array]"?[]:object}while(true){while(ip<end)switch(bc[ip]){case 0:stack.push(protect(peg$consts[bc[ip+1]]));ip+=2;break;case 1:stack.push(peg$currPos);ip++;break;case 2:stack.pop();ip++;break;case 3:peg$currPos=stack.pop();ip++;break;
case 4:stack.length-=bc[ip+1];ip+=2;break;case 5:stack.splice(-2,1);ip++;break;case 6:stack[stack.length-2].push(stack.pop());ip++;break;case 7:stack.push(stack.splice(stack.length-bc[ip+1],bc[ip+1]));ip+=2;break;case 8:stack.pop();stack.push(input.substring(stack[stack.length-1],peg$currPos));ip++;break;case 9:ends.push(end);ips.push(ip+3+bc[ip+1]+bc[ip+2]);if(stack[stack.length-1]){end=ip+3+bc[ip+1];ip+=3}else{end=ip+3+bc[ip+1]+bc[ip+2];ip+=3+bc[ip+1]}break;case 10:ends.push(end);ips.push(ip+3+
bc[ip+1]+bc[ip+2]);if(stack[stack.length-1]===peg$FAILED){end=ip+3+bc[ip+1];ip+=3}else{end=ip+3+bc[ip+1]+bc[ip+2];ip+=3+bc[ip+1]}break;case 11:ends.push(end);ips.push(ip+3+bc[ip+1]+bc[ip+2]);if(stack[stack.length-1]!==peg$FAILED){end=ip+3+bc[ip+1];ip+=3}else{end=ip+3+bc[ip+1]+bc[ip+2];ip+=3+bc[ip+1]}break;case 12:if(stack[stack.length-1]!==peg$FAILED){ends.push(end);ips.push(ip);end=ip+2+bc[ip+1];ip+=2}else ip+=2+bc[ip+1];break;case 13:ends.push(end);ips.push(ip+3+bc[ip+1]+bc[ip+2]);if(input.length>
peg$currPos){end=ip+3+bc[ip+1];ip+=3}else{end=ip+3+bc[ip+1]+bc[ip+2];ip+=3+bc[ip+1]}break;case 14:ends.push(end);ips.push(ip+4+bc[ip+2]+bc[ip+3]);if(input.substr(peg$currPos,peg$consts[bc[ip+1]].length)===peg$consts[bc[ip+1]]){end=ip+4+bc[ip+2];ip+=4}else{end=ip+4+bc[ip+2]+bc[ip+3];ip+=4+bc[ip+2]}break;case 15:ends.push(end);ips.push(ip+4+bc[ip+2]+bc[ip+3]);if(input.substr(peg$currPos,peg$consts[bc[ip+1]].length).toLowerCase()===peg$consts[bc[ip+1]]){end=ip+4+bc[ip+2];ip+=4}else{end=ip+4+bc[ip+2]+
bc[ip+3];ip+=4+bc[ip+2]}break;case 16:ends.push(end);ips.push(ip+4+bc[ip+2]+bc[ip+3]);if(peg$consts[bc[ip+1]].test(input.charAt(peg$currPos))){end=ip+4+bc[ip+2];ip+=4}else{end=ip+4+bc[ip+2]+bc[ip+3];ip+=4+bc[ip+2]}break;case 17:stack.push(input.substr(peg$currPos,bc[ip+1]));peg$currPos+=bc[ip+1];ip+=2;break;case 18:stack.push(peg$consts[bc[ip+1]]);peg$currPos+=peg$consts[bc[ip+1]].length;ip+=2;break;case 19:stack.push(peg$FAILED);if(peg$silentFails===0)peg$fail(peg$consts[bc[ip+1]]);ip+=2;break;case 20:peg$reportedPos=
stack[stack.length-1-bc[ip+1]];ip+=2;break;case 21:peg$reportedPos=peg$currPos;ip++;break;case 22:params=bc.slice(ip+4,ip+4+bc[ip+3]);for(i=0;i<bc[ip+3];i++)params[i]=stack[stack.length-1-params[i]];stack.splice(stack.length-bc[ip+2],bc[ip+2],peg$consts[bc[ip+1]].apply(null,params));ip+=4+bc[ip+3];break;case 23:stack.push(peg$parseRule(bc[ip+1]));ip+=2;break;case 24:peg$silentFails++;ip++;break;case 25:peg$silentFails--;ip++;break;default:throw new Error("Invalid opcode: "+bc[ip]+".");}if(ends.length>
0){end=ends.pop();ip=ips.pop()}else break}return stack[0]}var flattenString=function(arrs){var acum="";for(var i=0;i<arrs.length;i++)if(typeof arrs[i]==="string")acum=acum+arrs[i];else acum=acum+arrs[i].join("");return acum};var GlobalBlankNodeCounter=0;var prefixes={};var registerPrefix=function(prefix,uri){prefixes[prefix]=uri};var registerDefaultPrefix=function(uri){prefixes[null]=uri};var arrayToString=function(array){var tmp="";if(array==null)return null;for(var i=0;i<array.length;i++)tmp=tmp+
array[i];return tmp.toUpperCase()};peg$result=peg$parseRule(peg$startRuleIndex);if(peg$result!==peg$FAILED&&peg$currPos===input.length)return peg$result;else{if(peg$result!==peg$FAILED&&peg$currPos<input.length)peg$fail({type:"end",description:"end of input"});throw peg$buildException(null,peg$maxFailExpected,peg$maxFailPos);}}return{SyntaxError:SyntaxError,parse:parse}}()},{}],45:[function(_dereq_,module,exports){var Tree=_dereq_("./btree").Tree;var utils=_dereq_("./utils");var async=utils;var InMemoryLexicon=
_dereq_("./lexicon").Lexicon;Lexicon=function(callback,dbName){var that=this;utils.registerIndexedDB(that);this.defaultGraphOid=0;this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph";this.defaultGraphUriTerm={"token":"uri","prefix":null,"suffix":null,"value":this.defaultGraphUri};this.oidCounter=1;that.dbName=dbName||"rdfstorejs";var request=that.indexedDB.open(this.dbName+"_lexicon",1);request.onerror=function(event){callback(null,new Error("Error opening IndexedDB: "+
event.target.errorCode))};request.onsuccess=function(event){that.db=event.target.result;callback(that)};request.onupgradeneeded=function(event){that.db=event.target.result;var graphStore=that.db.createObjectStore("knownGraphs",{keyPath:"oid"});graphStore.createIndex("uriToken","uriToken",{unique:true});var uriStore=that.db.createObjectStore("uris",{keyPath:"id",autoIncrement:true});uriStore.createIndex("uri","uri",{unique:true});var blankStore=that.db.createObjectStore("blanks",{keyPath:"id",autoIncrement:true});
blankStore.createIndex("label","label",{unique:true});var literalStore=that.db.createObjectStore("literals",{keyPath:"id",autoIncrement:true});literalStore.createIndex("literal","literal",{unique:true})}};Lexicon.prototype.registerGraph=function(oid,uriToken,callback){if(oid!=this.defaultGraphOid){var transaction=this.db.transaction(["knownGraphs"],"readwrite");transaction.onerror=function(event){callback(null,new Error(event.target.statusCode))};var objectStore=transaction.objectStore("knownGraphs");
var request=objectStore.add({oid:oid,uriToken:uriToken});request.onsuccess=function(event){callback(true)}}else callback()};Lexicon.prototype.registeredGraphs=function(returnUris,callback){var graphs=[];var objectStore=this.db.transaction(["knownGraphs"],"readwrite").objectStore("knownGraphs");var request=objectStore.openCursor();request.onsuccess=function(event){var cursor=event.target.result;if(cursor){if(returnUris===true)graphs.push(cursor.value.uriToken);else graphs.push(cursor.value.oid);cursor.continue()}else callback(graphs)};
request.onerror=function(event){callback(null,new Error("Error retrieving data from the cursor: "+event.target.errorCode))}};Lexicon.prototype.registerUri=function(uri,callback){var that=this;if(uri===this.defaultGraphUri)callback(this.defaultGraphOid);else{var objectStore=that.db.transaction(["uris"],"readwrite").objectStore("uris");var request=objectStore.index("uri").get(uri);request.onsuccess=function(event){var uriData=event.target.result;if(uriData){uriData.counter++;var oid=uriData.id;var requestUpdate=
objectStore.put(uriData);requestUpdate.onsuccess=function(event){callback(oid)};requestUpdate.onerror=function(event){callback(null,new Error("Error updating the URI data"+event.target.errorCode))}}else{var requestAdd=objectStore.add({uri:uri,counter:0});requestAdd.onsuccess=function(event){callback(event.target.result)};requestAdd.onerror=function(event){callback(null,new Error("Error inserting the URI data"+event.target.errorCode))}}};request.onerror=function(event){callback(null,new Error("Error retrieving the URI data"+
event.target.errorCode))}}};Lexicon.prototype.resolveUri=function(uri,callback){if(uri===this.defaultGraphUri)callback(this.defaultGraphOid);else{var objectStore=this.db.transaction(["uris"]).objectStore("uris");var request=objectStore.index("uri").get(uri);request.onsuccess=function(event){if(event.target.result!=null)callback(event.target.result.id);else callback(-1)};request.onerror=function(event){callback(null,new Error("Error retrieving uri data "+event.target.errorCode))}}};Lexicon.prototype.resolveUriCost=
function(uri,callback){if(uri===this.defaultGraphUri)callback(0);else{var objectStore=that.db.transaction(["uris"]).objectStore("uris");var request=objectStore.index("uri").get(uri);request.onsuccess=function(event){if(event.target.result!=null)callback(event.target.result.cost);else callback(-1)};request.onerror=function(event){callback(null,new Error("Error retrieving uri data "+event.target.errorCode))}}};Lexicon.prototype.registerBlank=function(callback){var oidStr=guid();var that=this;var objectStore=
that.db.transaction(["blanks"],"readwrite").objectStore("blanks");var requestAdd=objectStore.add({label:oidStr,counter:0});requestAdd.onsuccess=function(event){callback(event.target.result)};requestAdd.onerror=function(event){callback(null,new Error("Error inserting the URI data"+event.target.errorCode))}};Lexicon.prototype.resolveBlankCost=function(label,callback){callback(0)};Lexicon.prototype.registerLiteral=function(literal,callback){var that=this;var objectStore=that.db.transaction(["literals"],
"readwrite").objectStore("literals");var request=objectStore.index("literal").get(literal);request.onsuccess=function(event){var literalData=event.target.result;if(literalData){literalData.counter++;var oid=literalData.id;var requestUpdate=objectStore.put(literalData);requestUpdate.onsuccess=function(event){callback(oid)};requestUpdate.onerror=function(event){callback(null,new Error("Error updating the literal data"+event.target.errorCode))}}else{var requestAdd=objectStore.add({literal:literal,counter:0});
requestAdd.onsuccess=function(event){callback(event.target.result)};requestAdd.onerror=function(event){callback(null,new Error("Error inserting the literal data"+event.target.errorCode))}}};request.onerror=function(event){callback(null,new Error("Error retrieving the literal data"+event.target.errorCode))}};Lexicon.prototype.resolveLiteral=function(literal,callback){var objectStore=that.db.transaction(["literals"]).objectStore("literals");var request=objectStore.index("literal").get(literal);request.onsuccess=
function(event){if(event.target.result!=null)callback(event.target.result.id);else callback(-1)};request.onerror=function(event){callback(null,new Error("Error retrieving literal data "+event.target.errorCode))}};Lexicon.prototype.resolveLiteralCost=function(literal,callback){var objectStore=that.db.transaction(["literals"]).objectStore("literals");var request=objectStore.index("literal").get(literal);request.onsuccess=function(event){if(event.target.result!=null)callback(event.target.result.cost);
else callback(-1)};request.onerror=function(event){callback(null,new Error("Error retrieving literal data "+event.target.errorCode))}};Lexicon.prototype.parseLiteral=function(literalString){return InMemoryLexicon.prototype.parseLiteral(literalString)};Lexicon.prototype.parseUri=function(uriString){return InMemoryLexicon.prototype.parseUri(uriString)};Lexicon.prototype.retrieve=function(oid,callback){var that=this;if(oid===this.defaultGraphOid)callback({token:"uri",value:this.defaultGraphUri,prefix:null,
suffix:null,defaultGraph:true});else{var transaction=that.db.transaction(["uris","literals","blanks"]);async.seq(function(found,k){var request=transaction.objectStore("uris").get(oid);request.onsuccess=function(event){if(event.target.result!=null)k(null,that.parseUri(event.target.result.uri));else k(null,null)};request.onerror=function(event){k(new Error("Error searching in URIs data "+event.target.errorCode))}},function(found,k){if(found==null){var request=transaction.objectStore("literals").get(oid);
request.onsuccess=function(event){if(event.target.result!=null)k(null,that.parseLiteral(event.target.result.literal));else k(null,null)};request.onerror=function(event){k(new Error("Error searching in Literals data "+event.target.errorCode))}}else k(null,found)},function(found,k){if(found==null){var request=transaction.objectStore("blanks").get(oid);request.onsuccess=function(event){if(event.target.result!=null){var label="_:"+event.target.result.id;k(null,that.parseLiteral({token:"blank",value:label}))}else k(null,
null)};request.onerror=function(event){k(new Error("Error searching in blanks data "+event.target.errorCode))}}else k(null,found)})(null,function(err,found){if(err)callback(null,err);else callback(found)})}};Lexicon.prototype.clear=function(callback){var that=this;this.defaultGraphOid=0;this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph";this.defaultGraphUriTerm={"token":"uri","prefix":null,"suffix":null,"value":this.defaultGraphUri};var transaction=that.db.transaction(["uris",
"literals","blanks"],"readwrite"),request;async.seq(function(k){request=transaction.objectStore("uris").clear();request.onsuccess=function(){k()};request.onerror=function(){k()}},function(k){request=transaction.objectStore("literals").clear();request.onsuccess=function(){k()};request.onerror=function(){k()}},function(k){request=transaction.objectStore("blanks").clear();request.onsuccess=function(){k()};request.onerror=function(){k()}})(function(){if(callback!=null)callback()})};Lexicon.prototype.unregister=
function(quad,key,callback){var that=this;async.seq(function(k){that._unregisterTerm(quad.subject.token,key.subject,k)},function(k){that._unregisterTerm(quad.predicate.token,key.predicate,k)},function(k){that._unregisterTerm(quad.object.token,key.object,k)},function(k){if(quad.graph!=null)that._unregisterTerm(quad.graph.token,key.graph,k);else k()})(function(){callback(true)})};Lexicon.prototype._unregisterTerm=function(kind,oid,callback){var that=this;var transaction=that.db.transaction(["uris",
"literals","blanks","knownGraphs"],"readwrite"),request;if(kind==="uri")if(oid!=this.defaultGraphOid){var removeKnownGraphs=function(){var request=transaction.objectStore("knownGraphs").delete(oid);request.onsuccess=function(){callback()}};var request=transaction.objectStore("uris").delete(oid);request.onsuccess=removeKnownGraphs()}else callback();else if(kind==="literal"){var request=transaction.objectStore("literals").delete(oid);request.onsuccess=function(){callback()}}else if(kind==="blank"){var request=
transaction.objectStore("blanks").delete(oid);request.onsuccess=function(){callback()}}else callback()};module.exports={Lexicon:Lexicon}},{"./btree":38,"./lexicon":42,"./utils":55}],46:[function(_dereq_,module,exports){var utils=_dereq_("./utils");var _=utils;var async=utils;QuadBackend=function(configuration,callback){var that=this;if(arguments!==0){utils.registerIndexedDB(that);this.indexMap={};this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object",
"graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]};that.dbName=configuration["name"]||"rdfstorejs";var request=that.indexedDB.open(this.dbName+"_db",1);request.onerror=function(event){callback(null,new Error("Error opening IndexedDB: "+event.target.errorCode))};request.onsuccess=function(event){that.db=event.target.result;
callback(that)};request.onupgradeneeded=function(event){var db=event.target.result;var objectStore=db.createObjectStore(that.dbName,{keyPath:"SPOG"});_.each(that.indices,function(index){if(index!=="SPOG")objectStore.createIndex(index,index,{unique:false})})}}};QuadBackend.prototype.index=function(quad,callback){var that=this;_.each(this.indices,function(index){quad[index]=that._genMinIndexKey(quad,index)});var transaction=that.db.transaction([that.dbName],"readwrite");transaction.oncomplete=function(event){};
transaction.onerror=function(event){callback(null,new Error(event.target.statusCode))};var objectStore=transaction.objectStore(that.dbName);var request=objectStore.add(quad);request.onsuccess=function(event){callback(true)}};QuadBackend.prototype.range=function(pattern,callback){var that=this;var objectStore=that.db.transaction([that.dbName]).objectStore(that.dbName);var indexKey=this._indexForPattern(pattern);var minIndexKeyValue=this._genMinIndexKey(pattern,indexKey);var maxIndexKeyValue=this._genMaxIndexKey(pattern,
indexKey);var keyRange=that.IDBKeyRange.bound(minIndexKeyValue,maxIndexKeyValue,false,false);var quads=[];var cursorSource;if(indexKey==="SPOG")cursorSource=objectStore;else cursorSource=objectStore.index(indexKey);cursorSource.openCursor(keyRange).onsuccess=function(event){var cursor=event.target.result;if(cursor){quads.push(cursor.value);cursor.continue()}else callback(quads)}};QuadBackend.prototype.search=function(quad,callback){var that=this;var objectStore=that.db.transaction([that.dbName]).objectStore(that.dbName);
var indexKey=this._genMinIndexKey(quad,"SPOG");var request=objectStore.get(indexKey);request.onerror=function(event){callback(null,new Error(event.target.statusCode))};request.onsuccess=function(event){callback(event.target.result!=null)}};QuadBackend.prototype.delete=function(quad,callback){var that=this;var indexKey=that._genMinIndexKey(quad,"SPOG");var request=that.db.transaction([that.dbName],"readwrite").objectStore(that.dbName).delete(indexKey);request.onsuccess=function(){callback(true)};request.onerror=
function(event){callback(null,new Error(event.target.statusCode))}};QuadBackend.prototype._genMinIndexKey=function(quad,index){var indexComponents=this.componentOrders[index];return _.map(indexComponents,function(component){if(typeof quad[component]==="string"||quad[component]==null)return"-1";else return""+quad[component]}).join(".")};QuadBackend.prototype._genMaxIndexKey=function(quad,index){var indexComponents=this.componentOrders[index];var acum=[];var foundFirstMissing=false;for(var i=0;i<indexComponents.length;i++){var component=
indexComponents[i];var componentValue=quad[component];if(typeof componentValue==="string"){if(foundFirstMissing===false){foundFirstMissing=true;if(i-1>=0)acum[i-1]=acum[i-1]+1}acum[i]=-1}else acum[i]=componentValue}return _.map(acum,function(componentValue){return""+componentValue}).join(".")};QuadBackend.prototype._indexForPattern=function(pattern){var indexKey=pattern.indexKey;for(var i=0;i<this.indices.length;i++){var index=this.indices[i];var indexComponents=this.componentOrders[index];for(var j=
0;j<indexComponents.length;j++){if(_.include(indexKey,indexComponents[j])===false)break;if(j==indexKey.length-1)return index}}return"SPOG"};QuadBackend.prototype.clear=function(callback){var that=this;var transaction=that.db.transaction([that.dbName],"readwrite"),request;request=transaction.objectStore(that.dbName).clear();request.onsuccess=function(){callback()};request.onerror=function(){callback()}};module.exports.QuadBackend=QuadBackend},{"./utils":55}],47:[function(_dereq_,module,exports){var QuadIndex=
_dereq_("./quad_index").QuadIndex;var async=_dereq_("./utils");var _=_dereq_("./utils");QuadBackend=function(configuration,callback){if(arguments!==0){this.indexMap={};this.treeOrder=configuration["treeOrder"];this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],
OS:["object","subject","predicate","graph"]};var that=this;var i=0;async.eachSeries(this.indices,function(indexKey,k){new QuadIndex({order:that.treeOrder,componentOrder:that.componentOrders[indexKey]},function(tree){that.indexMap[indexKey]=tree;k()})},function(){callback(that)})}};QuadBackend.prototype._indexForPattern=function(pattern){var indexKey=pattern.indexKey;for(var i=0;i<this.indices.length;i++){var index=this.indices[i];var indexComponents=this.componentOrders[index];for(var j=0;j<indexComponents.length;j++){if(_.include(indexKey,
indexComponents[j])===false)break;if(j==indexKey.length-1)return index}}return"SPOG"};QuadBackend.prototype.index=function(quad,callback){var that=this;async.eachSeries(this.indices,function(indexKey,k){var index=that.indexMap[indexKey];index.insert(quad,function(){k()})},function(){callback(that)})};QuadBackend.prototype.range=function(pattern,callback){var indexKey=this._indexForPattern(pattern);var index=this.indexMap[indexKey];index.range(pattern,function(quads){callback(quads)})};QuadBackend.prototype.search=
function(quad,callback){var index=this.indexMap["SPOG"];index.search(quad,function(result){callback(result!=null)})};QuadBackend.prototype.delete=function(quad,callback){var that=this;async.eachSeries(this.indices,function(indexKey,k){var index=that.indexMap[indexKey];index.delete(quad,function(){k()})},function(){callback(that)})};QuadBackend.prototype.clear=function(callback){var that=this;async.eachSeries(this.indices,function(indexKey,k){new QuadIndex({order:that.treeOrder,componentOrder:that.componentOrders[indexKey]},
function(tree){that.indexMap[indexKey]=tree;k()})},function(){callback(that)})};module.exports.QuadBackend=QuadBackend},{"./quad_index":48,"./utils":55}],48:[function(_dereq_,module,exports){var BaseTree=_dereq_("./btree").Tree;var _=_dereq_("./utils");var async=_dereq_("./utils");NodeKey=function(components,order){this.subject=components.subject;this.predicate=components.predicate;this.object=components.object;this.graph=components.graph;this.order=order};NodeKey.prototype.comparator=function(keyPattern){for(var i=
0;i<this.order.length;i++){var component=this.order[i];if(keyPattern[component]==null)return 0;else if(this[component]<keyPattern[component])return-1;else if(this[component]>keyPattern[component])return 1}return 0};Pattern=function(components){this.subject=components.subject;this.predicate=components.predicate;this.object=components.object;this.graph=components.graph;this.indexKey=[];this.keyComponents={};var order=[];var indiferent=[];var that=this;_.forEach(["subject","predicate","object","graph"],
function(component){if(typeof that[component]==="string"){indiferent.push(component);that.keyComponents[component]=null}else{order.push(component);that.keyComponents[component]=that[component];that.indexKey.push(component)}});this.order=order.concat(indiferent);this.key=new NodeKey(this.keyComponents,this.order)};QuadIndex=function(params,callback){if(arguments!=0){this.componentOrder=params.componentOrder;BaseTree.call(this,params.order,function(tree){tree.comparator=function(a,b){for(var i=0;i<
tree.componentOrder.length;i++){var component=tree.componentOrder[i];var vala=a[component];var valb=b[component];if(vala<valb)return-1;else if(vala>valb)return 1}return 0};tree.rangeComparator=function(a,b){for(var i=0;i<tree.componentOrder.length;i++){var component=tree.componentOrder[i];if(b[component]==null||a[component]==null)return 0;else if(a[component]<b[component])return-1;else if(a[component]>b[component])return 1}return 0};callback(tree)})}};QuadIndex.prototype=_.create(BaseTree.prototype,
{"constructor":BaseTree});QuadIndex.prototype.insert=function(quad,callback){BaseTree.prototype.insert.call(this,quad,null,function(result){callback(result)})};QuadIndex.prototype.search=function(quad,callback){BaseTree.prototype.search.call(this,quad,function(result){callback(result)},true)};QuadIndex.prototype.range=function(pattern,callback){this._rangeTraverse(this,this.root,pattern,callback)};QuadIndex.prototype._rangeTraverse=function(tree,node,pattern,callback){var patternKey=pattern.key;var acum=
[];var pendingNodes=[node];async.whilst(function(){return pendingNodes.length>0},function(k){var node=pendingNodes.shift();var idxMin=0;while(idxMin<node.numberActives&&tree.rangeComparator(node.keys[idxMin].key,patternKey)===-1)idxMin++;if(node.isLeaf===true){var idxMax=idxMin;while(idxMax<node.numberActives&&tree.rangeComparator(node.keys[idxMax].key,patternKey)===0){acum.push(node.keys[idxMax].key);idxMax++}k()}else tree._diskRead(node.children[idxMin],function(childNode){pendingNodes.push(childNode);
var idxMax=idxMin;async.whilst(function(){return idxMax<node.numberActives&&tree.rangeComparator(node.keys[idxMax].key,patternKey)===0},function(kk){acum.push(node.keys[idxMax].key);idxMax++;tree._diskRead(node.children[idxMax],function(childNode){pendingNodes.push(childNode);kk()})},function(){k()})})},function(){callback(acum)})};module.exports={QuadIndex:QuadIndex,Pattern:Pattern,NodeKey:NodeKey}},{"./btree":38,"./utils":55}],49:[function(_dereq_,module,exports){var AbstractQueryTree=_dereq_("./abstract_query_tree").AbstractQueryTree;
var NonSupportedSparqlFeatureError=_dereq_("./abstract_query_tree").NonSupportedSparqlFeatureError;var Utils=_dereq_("./utils");var QuadIndex=_dereq_("./quad_index");var QueryPlan=_dereq_("./query_plan").QueryPlan;var QueryFilters=_dereq_("./query_filters").QueryFilters;var RDFModel=_dereq_("./rdf_model");var RDFLoader=_dereq_("./rdf_loader").RDFLoader;var Callbacks=_dereq_("./graph_callbacks").CallbacksBackend;var async=_dereq_("./utils");var _=_dereq_("./utils");QueryEngine=function(params){if(arguments.length!=
0){this.backend=params.backend;this.lexicon=params.lexicon;this.eventsOnBatchLoad=params.eventsOnBatchLoad||false;this.defaultPrefixes={};this.abstractQueryTree=new AbstractQueryTree;this.rdfLoader=new RDFLoader(params["communication"]);this.callbacksBackend=new Callbacks(this);this.customFns=params.customFns||{}}};QueryEngine.prototype.setCustomFunctions=function(customFns){this.customFns=customFns};QueryEngine.prototype.registerNsInEnvironment=function(prologue,env){var prefixes=[];if(prologue!=
null&&prologue.prefixes!=null)prefixes=prologue.prefixes;var toSave={};for(var p in this.defaultPrefixes)toSave[p]=this.defaultPrefixes[p];for(var i=0;i<prefixes.length;i++){var prefix=prefixes[i];if(prefix.token==="prefix")toSave[prefix.prefix]=prefix.local}env.namespaces=toSave;if(prologue!=null&&prologue.base&&typeof prologue.base==="object")env.base=prologue.base.value;else env.base=null};QueryEngine.prototype.applyModifier=function(modifier,projectedBindings){if(modifier=="DISTINCT"){var map=
{};var result=[];for(var i=0;i<projectedBindings.length;i++){var bindings=projectedBindings[i];var key="";for(var p in bindings){var obj=bindings[p];if(obj==null)key=key+p+"null";else if(obj.token=="literal"){if(obj.value!=null)key=key+obj.value;if(obj.lang!=null)key=key+obj.lang;if(obj.type!=null)key=key+obj.type}else if(obj.value)key=key+p+obj.value;else key=key+p+obj}if(map[key]==null){result.push(bindings);map[key]=true}}return result}else return projectedBindings};QueryEngine.prototype.applyLimitOffset=
function(offset,limit,bindings){if(limit==null&&offset==null)return bindings;if(offset==null)offset=0;if(limit==null)limit=bindings.length;else limit=offset+limit;return bindings.slice(offset,limit)};QueryEngine.prototype.applySingleOrderBy=function(orderFilters,modifiedBindings,dataset,outEnv,callback){var acum=[];var that=this;async.eachSeries(orderFilters,function(orderFilter,k){QueryFilters.collect(orderFilter.expression,[modifiedBindings],dataset,outEnv,that,function(results){acum.push(results[0].value);
k()})},function(){callback({binding:modifiedBindings,value:acum})})};QueryEngine.prototype.applyOrderBy=function(order,modifiedBindings,dataset,outEnv,callback){var that=this;var acum=[];if(order!=null&&order.length>0)async.eachSeries(modifiedBindings,function(bindings,k){that.applySingleOrderBy(order,bindings,dataset,outEnv,function(results){acum.push(results);k()})},function(){acum.sort(function(a,b){return that.compareFilteredBindings(a,b,order,outEnv)});var toReturn=[];for(var i=0;i<acum.length;i++)toReturn.push(acum[i].binding);
callback(toReturn)});else callback(modifiedBindings)};QueryEngine.prototype.compareFilteredBindings=function(a,b,order,env){var found=false;var i=0;while(!found){if(i==a.value.length)return 0;var direction=order[i].direction;var filterResult;if(a.value[i]==null&&b.value[i]==null){i++;continue}else if(a.value[i]==null)filterResult={value:false};else if(b.value[i]==null)filterResult={value:true};else if(a.value[i].token==="blank"&&b.value[i].token==="blank"){i++;continue}else if(a.value[i].token===
"blank")filterResult={value:false};else if(b.value[i].token==="blank")filterResult={value:true};else if(a.value[i].token==="uri"&&b.value[i].token==="uri")if(QueryFilters.runEqualityFunction(a.value[i],b.value[i],[],this,env).value==true){i++;continue}else filterResult=QueryFilters.runTotalGtFunction(a.value[i],b.value[i],[]);else if(a.value[i].token==="uri")filterResult={value:false};else if(b.value[i].token==="uri")filterResult={value:true};else if(a.value[i].token==="literal"&&b.value[i].token===
"literal"&&a.value[i].type==null&&b.value[i].type==null)if(QueryFilters.runEqualityFunction(a.value[i],b.value[i],[],this,env).value==true){i++;continue}else filterResult=QueryFilters.runTotalGtFunction(a.value[i],b.value[i],[]);else if(a.value[i].token==="literal"&&a.value[i].type==null)filterResult={value:false};else if(b.value[i].token==="literal"&&b.value[i].type==null)filterResult={value:true};else if(QueryFilters.runEqualityFunction(a.value[i],b.value[i],[],this,env).value==true){i++;continue}else filterResult=
QueryFilters.runTotalGtFunction(a.value[i],b.value[i],[]);if(filterResult.value==true)if(direction==="ASC")return 1;else return-1;else if(direction==="ASC")return-1;else return 1}};QueryEngine.prototype.removeDefaultGraphBindings=function(bindingsList,dataset){var onlyDefaultDatasets=[];var namedDatasetsMap={};for(var i=0;i<dataset.named.length;i++)namedDatasetsMap[dataset.named[i].oid]=true;for(i=0;i<dataset.implicit.length;i++)if(namedDatasetsMap[dataset.implicit[i].oid]==null)onlyDefaultDatasets.push(dataset.implicit[i].oid);
var acum=[];for(i=0;i<bindingsList.length;i++){var bindings=bindingsList[i];var foundDefaultGraph=false;for(var p in bindings){for(var j=0;j<namedDatasetsMap.length;j++)if(bindings[p]===namedDatasetsMap[j]){foundDefaultGraph=true;break}if(foundDefaultGraph)break}if(!foundDefaultGraph)acum.push(bindings)}return acum};QueryEngine.prototype.aggregateBindings=function(projection,bindingsGroup,dataset,env,callback){this.copyDenormalizedBindings(bindingsGroup,env.outCache,function(denormBindings){var aggregatedBindings=
{};for(var i=0;i<projection.length;i++){var aggregatedValue=QueryFilters.runAggregator(projection[i],denormBindings,this,dataset,env);if(projection[i].alias)aggregatedBindings[projection[i].alias.value]=aggregatedValue;else aggregatedBindings[projection[i].value.value]=aggregatedValue}callback(aggregatedBindings)})};QueryEngine.prototype.projectBindings=function(projection,results,dataset){if(projection[0].kind==="*")return results;else{var projectedResults=[];for(var i=0;i<results.length;i++){var currentResult=
results[i];var currentProjected={};var shouldAdd=true;for(var j=0;j<projection.length;j++)if(projection[j].token=="variable"&&projection[j].kind!="aliased")currentProjected[projection[j].value.value]=currentResult[projection[j].value.value];else if(projection[j].token=="variable"&&projection[j].kind=="aliased"){var ebv=QueryFilters.runFilter(projection[j].expression,currentResult,this,dataset,{blanks:{},outCache:{}});if(QueryFilters.isEbvError(ebv)){shouldAdd=false;break}else currentProjected[projection[j].alias.value]=
ebv}if(shouldAdd===true)projectedResults.push(currentProjected)}return projectedResults}};QueryEngine.prototype.resolveNsInEnvironment=function(prefix,env){var namespaces=env.namespaces;return namespaces[prefix]};QueryEngine.prototype.normalizeTerm=function(term,env,shouldIndex,callback){if(term.token==="uri"){var uri=Utils.lexicalFormBaseUri(term,env);if(uri==null)callback(null);else if(shouldIndex)this.lexicon.registerUri(uri,callback);else this.lexicon.resolveUri(uri,callback)}else if(term.token===
"literal"){var lexicalFormLiteral=Utils.lexicalFormLiteral(term,env);if(shouldIndex)this.lexicon.registerLiteral(lexicalFormLiteral,callback);else this.lexicon.resolveLiteral(lexicalFormLiteral,callback)}else if(term.token==="blank"){var label=term.value;var oid=env.blanks[label];if(oid!=null)callback(oid);else if(shouldIndex)this.lexicon.registerBlank(function(oid){env.blanks[label]=oid;callback(oid)});else this.lexicon.resolveBlank(function(oid){env.blanks[label]=oid;callback(oid)})}else if(term.token===
"var")callback(term.value);else callback(null)};QueryEngine.prototype.normalizeDatasets=function(datasets,outerEnv,callback){var that=this;async.eachSeries(datasets,function(dataset,k){if(dataset.value===that.lexicon.defaultGraphUri){dataset.oid=that.lexicon.defaultGraphOid;k()}else that.normalizeTerm(dataset,outerEnv,false,function(oid){if(oid!=null)dataset.oid=oid;k()})},function(){callback(true)})};QueryEngine.prototype.normalizeQuad=function(quad,queryEnv,shouldIndex,callback){var subject=null;
var predicate=null;var object=null;var graph=null;var that=this;var error=false;async.seq(function(k){if(quad.graph==null||quad.graph.value===that.lexicon.defaultGraphUri){graph=0;k()}else{var graphUriValue=Utils.lexicalFormBaseUri(quad.graph,queryEnv);that.normalizeTerm(quad.graph,queryEnv,shouldIndex,function(oid){if(oid!=null){graph=oid;if(shouldIndex===true&&quad.graph.token!="var")that.lexicon.registerGraph(oid,graphUriValue,function(){k()});else k()}else{error=true;k()}})}},function(k){if(error===
false)that.normalizeTerm(quad.subject,queryEnv,shouldIndex,function(oid){if(oid!=null){subject=oid;k()}else{error=true;k()}});else k()},function(k){if(error===false)that.normalizeTerm(quad.predicate,queryEnv,shouldIndex,function(oid){if(oid!=null){predicate=oid;k()}else{error=true;k()}});else k()},function(k){if(error===false)that.normalizeTerm(quad.object,queryEnv,shouldIndex,function(oid){if(oid!=null){object=oid;k()}else{error=true;k()}});else k()})(function(){if(error===true)callback(null);else callback({subject:subject,
predicate:predicate,object:object,graph:graph})})};QueryEngine.prototype.denormalizeBindingsList=function(bindingsList,env,callback){var that=this;var denormList=[];async.eachSeries(bindingsList,function(bindings,k){that.denormalizeBindings(bindings,env,function(denorm){denormList.push(denorm);k()})},function(){callback(denormList)})};QueryEngine.prototype.copyDenormalizedBindings=function(bindingsList,out,callback){var that=this;var denormList=[];async.eachSeries(bindingsList,function(bindings,k){var denorm=
{};var variables=_.keys(bindings);async.eachSeries(variables,function(variable,kk){var oid=bindings[variable];if(oid==null){denorm[variable]=null;kk()}else if(typeof oid==="object"){denorm[variable]=oid;kk()}else{var inOut=out[oid];if(inOut!=null){denorm[variable]=inOut;kk()}else that.lexicon.retrieve(oid,function(val){out[oid]=val;denorm[variable]=val;kk()})}},function(){denormList.push(denorm);k()})},function(){callback(denormList)})};QueryEngine.prototype.denormalizeBindings=function(bindings,
env,callback){var variables=_.keys(bindings);var envOut=env.outCache;var that=this;async.eachSeries(variables,function(variable,k){var oid=bindings[variable];if(oid==null){bindings[variable]=null;k()}else if(envOut[oid]!=null){bindings[variable]=envOut[oid];k()}else that.lexicon.retrieve(oid,function(val){bindings[variable]=val;if(val.token==="blank")env.blanks[val.value]=oid;k()})},function(){callback(bindings)})};QueryEngine.prototype.execute=function(queryString,callback,defaultDataset,namedDataset){queryString=
Utils.normalizeUnicodeLiterals(queryString);var syntaxTree=this.abstractQueryTree.parseQueryString(queryString);if(syntaxTree==null)callback(false,"Error parsing query string");else if(syntaxTree.token==="query"&&syntaxTree.kind=="update"){this.callbacksBackend.startGraphModification();var that=this;this.executeUpdate(syntaxTree,function(err,result){if(that.lexicon.updateAfterWrite)that.lexicon.updateAfterWrite();if(err){that.callbacksBackend.cancelGraphModification();callback(err,result)}else that.callbacksBackend.endGraphModification(function(){callback(err,
result)})})}else if(syntaxTree.token==="query"&&syntaxTree.kind=="query")this.executeQuery(syntaxTree,callback,defaultDataset,namedDataset)};QueryEngine.prototype.executeQuery=function(syntaxTree,callback,defaultDataset,namedDataset){var prologue=syntaxTree.prologue;var units=syntaxTree.units;var that=this;var queryEnv={blanks:{},outCache:{}};this.registerNsInEnvironment(prologue,queryEnv);var aqt=that.abstractQueryTree.parseExecutableUnit(units[0]);if(aqt.kind==="select")this.executeSelect(aqt,queryEnv,
defaultDataset,namedDataset,function(err,result){if(err==null)if(typeof result==="object"&&result.denorm===true)callback(null,result["bindings"]);else that.denormalizeBindingsList(result,queryEnv,function(result){callback(null,result)});else callback(err)});else if(aqt.kind==="ask"){aqt.projection=[{"token":"variable","kind":"*"}];this.executeSelect(aqt,queryEnv,defaultDataset,namedDataset,function(err,result){if(err==null)if(result.length>0)callback(null,true);else callback(null,false);else callback(err)})}else if(aqt.kind===
"construct"){aqt.projection=[{"token":"variable","kind":"*"}];that=this;this.executeSelect(aqt,queryEnv,defaultDataset,namedDataset,function(err,result){if(err==null)that.denormalizeBindingsList(result,queryEnv,function(result){if(result!=null){var graph=new RDFModel.Graph;if(aqt.template==null)aqt.template={triplesContext:aqt.pattern};var blankIdCounter=1;var toClear=[];for(var i=0;i<result.length;i++){var bindings=result[i];for(var j=0;j<toClear.length;j++)delete toClear[j].valuetmp;for(var j=0;j<
aqt.template.triplesContext.length;j++){var components=["subject","predicate","object"];var tripleTemplate=aqt.template.triplesContext[j];for(var p=0;p<components.length;p++){var component=components[p];if(tripleTemplate[component].token==="blank")if(tripleTemplate[component].valuetmp&&tripleTemplate[component].valuetmp!=null);else{var blankId="_:b"+blankIdCounter;blankIdCounter++;tripleTemplate[component].valuetmp=blankId;toClear.push(tripleTemplate[component])}}var s=RDFModel.buildRDFResource(tripleTemplate.subject,
bindings,that,queryEnv);var p=RDFModel.buildRDFResource(tripleTemplate.predicate,bindings,that,queryEnv);var o=RDFModel.buildRDFResource(tripleTemplate.object,bindings,that,queryEnv);if(s!=null&&p!=null&&o!=null){var triple=new RDFModel.Triple(s,p,o);graph.add(triple)}}}callback(null,graph)}else callback(new Error("Error denormalizing bindings."))});else callback(err)})}};QueryEngine.prototype.executeSelect=function(unit,env,defaultDataset,namedDataset,callback){if(unit.kind==="select"||unit.kind===
"ask"||unit.kind==="construct"||unit.kind==="modify"){var projection=unit.projection;var dataset=unit.dataset;var modifier=unit.modifier;var limit=unit.limit;var offset=unit.offset;var order=unit.order;var that=this;if(defaultDataset!=null||namedDataset!=null){dataset.implicit=defaultDataset||[];dataset.named=namedDataset||[]}if(dataset.implicit!=null&&dataset.implicit.length===0&&dataset.named!=null&&dataset.named.length===0)dataset.implicit.push(this.lexicon.defaultGraphUriTerm);that.normalizeDatasets(dataset.implicit.concat(dataset.named),
env,function(){try{that.executeSelectUnit(projection,dataset,unit.pattern,env,function(result){if(result!=null){if(unit.group!=null&&unit.group===""){var foundUniqueGroup=false;for(var i=0;i<unit.projection.length;i++)if(unit.projection[i].expression!=null&&unit.projection[i].expression.expressionType==="aggregate"){foundUniqueGroup=true;break}if(foundUniqueGroup===true)unit.group="singleGroup"}if(unit.group&&unit.group!="")if(that.checkGroupSemantics(unit.group,projection))that.groupSolution(result,
unit.group,dataset,env,function(groupedBindings){var aggregatedBindings=[];async.eachSeries(groupedBindings,function(groupedBindingsGroup,k){that.aggregateBindings(projection,groupedBindingsGroup,dataset,env,function(resultingBindings){aggregatedBindings.push(resultingBindings);k()})},function(){callback(null,{"bindings":aggregatedBindings,"denorm":true})})});else callback(new Error("Incompatible Group and Projection variables"));else that.applyOrderBy(order,result,dataset,env,function(orderedBindings){var projectedBindings=
that.projectBindings(projection,orderedBindings,dataset);var modifiedBindings=that.applyModifier(modifier,projectedBindings);var limitedBindings=that.applyLimitOffset(offset,limit,modifiedBindings);var filteredBindings=that.removeDefaultGraphBindings(limitedBindings,dataset);callback(null,filteredBindings)})}else callback(new Error("Error executing SELECT query."))})}catch(e){console.log(e);callback(e)}})}else callback(new Error("Cannot execute "+unit.kind+" query as a select query"))};QueryEngine.prototype.groupSolution=
function(bindings,group,dataset,queryEnv,callback){var order=[];var filteredBindings=[];var initialized=false;var that=this;if(group==="singleGroup")callback([bindings]);else async.eachSeries(bindings,function(currentBindings,k){var mustAddBindings=true;async.eachSeries(group,function(currentOrderClause,kk){var orderVariable=null;if(currentOrderClause.token==="var"){orderVariable=currentOrderClause.value;if(initialized==false)order.push(orderVariable);kk()}else if(currentOrderClause.token==="aliased_expression"){orderVariable=
currentOrderClause.alias.value;if(initialized==false)order.push(orderVariable);if(currentOrderClause.expression.primaryexpression==="var")currentBindings[currentOrderClause.alias.value]=currentBindings[currentOrderClause.expression.value.value];else{var denormBindings=that.copyDenormalizedBindings([currentBindings],queryEnv.outCache);var filterResultEbv=QueryFilters.runFilter(currentOrderClause.expression,denormBindings[0],that,dataset,queryEnv);if(!QueryFilters.isEbvError(filterResultEbv)){if(filterResultEbv.value!=
null)filterResultEbv.value=""+filterResultEbv.value;currentBindings[currentOrderClause.alias.value]=filterResultEbv}else mustAddBindings=false}kk()}else that.copyDenormalizedBindings([currentBindings],queryEnv.outCache,function(denormBindings){var filterResultEbv=QueryFilters.runFilter(currentOrderClause,denormBindings[0],that,queryEnv);if(!QueryFilters.isEbvError(filterResultEbv)){currentBindings["groupCondition"+env._i]=filterResultEbv;orderVariable="groupCondition"+env._i;if(initialized==false)order.push(orderVariable)}else mustAddBindings=
false;kk()})},function(){if(initialized==false)initialized=true;if(mustAddBindings===true)filteredBindings.push(currentBindings);k()})},function(){var dups={};var groupMap={};var groupCounter=0;for(var i=0;i<filteredBindings.length;i++){var currentTransformedBinding=filteredBindings[i];var key="";for(var j=0;j<order.length;j++){var maybeObject=currentTransformedBinding[order[j]];if(typeof maybeObject==="object")key=key+maybeObject.value;else key=key+maybeObject}if(dups[key]==null){groupMap[key]=groupCounter;
dups[key]=[currentTransformedBinding]}else dups[key].push(currentTransformedBinding)}var groups=[];for(var k in dups)groups.push(dups[k]);callback(groups)})};QueryEngine.prototype.executeSelectUnit=function(projection,dataset,pattern,env,callback){if(pattern.kind==="BGP")this.executeAndBGP(projection,dataset,pattern,env,callback);else if(pattern.kind==="UNION")this.executeUNION(projection,dataset,pattern.value,env,callback);else if(pattern.kind==="JOIN")this.executeJOIN(projection,dataset,pattern,
env,callback);else if(pattern.kind==="LEFT_JOIN")this.executeLEFT_JOIN(projection,dataset,pattern,env,callback);else if(pattern.kind==="FILTER"){var that=this;this.executeSelectUnit(projection,dataset,pattern.value,env,function(results){if(results!=null)QueryFilters.checkFilters(pattern,results,false,dataset,env,that,callback);else callback([])})}else if(pattern.kind==="EMPTY_PATTERN")callback([]);else throw new NonSupportedSparqlFeatureError(pattern.kind);};QueryEngine.prototype.executeUNION=function(projection,
dataset,patterns,env,callback){var setQuery1=patterns[0];var setQuery2=patterns[1];var error=null;var set1,set2;if(patterns.length!=2)throw"SPARQL algebra UNION with more than two components";var that=this;async.seq(function(k){try{that.executeSelectUnit(projection,dataset,setQuery1,env,function(result){set1=result;k()})}catch(e){error=e;k()}},function(k){if(error==null)try{that.executeSelectUnit(projection,dataset,setQuery2,env,function(result){set2=result;k()})}catch(e){error=e;k()}else k()})(function(){if(error!=
null)callback(error);else{var result=QueryPlan.unionBindings(set1,set2);QueryFilters.checkFilters(patterns,result,false,dataset,env,that,callback)}})};QueryEngine.prototype.executeAndBGP=function(projection,dataset,patterns,env,callback){var that=this;QueryPlan.executeAndBGPsDPSize(patterns.value,dataset,this,env,function(result){if(result!=null)QueryFilters.checkFilters(patterns,result,false,dataset,env,that,callback);else callback(null)})};QueryEngine.prototype.executeLEFT_JOIN=function(projection,
dataset,patterns,env,callback){var setQuery1=patterns.lvalue;var setQuery2=patterns.rvalue;var set1=null;var set2=null;var error=null;var that=this;var acum,duplicates;async.seq(function(k){try{that.executeSelectUnit(projection,dataset,setQuery1,env,function(result){set1=result;k()})}catch(e){error=e;k()}},function(k){if(error!=null)k();else try{that.executeSelectUnit(projection,dataset,setQuery2,env,function(result){set2=result;k()})}catch(e){error=e;k()}})(function(){if(error!=null)callback(error);
else{var result=QueryPlan.leftOuterJoinBindings(set1,set2);QueryFilters.checkFilters(patterns,result,true,dataset,env,that,function(bindings){if(set1.length>1&&set2.length>1){var vars=[];var vars1={};for(var p in set1[0])vars1[p]=true;for(p in set2[0])if(vars1[p]!=true)vars.push(p);acum=[];duplicates={};for(var i=0;i<bindings.length;i++)if(bindings[i]["__nullify__"]===true){for(var j=0;j<vars.length;j++)bindings[i]["bindings"][vars[j]]=null;var idx=[];var idxColl=[];for(var p in bindings[i]["bindings"])if(bindings[i]["bindings"][p]!=
null){idx.push(p+bindings[i]["bindings"][p]);idx.sort();idxColl.push(idx.join(""))}if(duplicates[idx.join("")]==null){for(j=0;j<idxColl.length;j++)duplicates[idxColl[j]]=true;acum.push(bindings[i]["bindings"])}}else{acum.push(bindings[i]);var idx=[];var idxColl=[];for(var p in bindings[i]){idx.push(p+bindings[i][p]);idx.sort();duplicates[idx.join("")]=true}}callback(acum)}else callback(bindings)})}})};QueryEngine.prototype.executeJOIN=function(projection,dataset,patterns,env,callback){var setQuery1=
patterns.lvalue;var setQuery2=patterns.rvalue;var set1=null;var set2=null;var error=null;var that=this;async.seq(function(k){try{that.executeSelectUnit(projection,dataset,setQuery1,env,function(result){set1=result;k()})}catch(e){error=e;k()}},function(k){if(error!=null)k();else try{that.executeSelectUnit(projection,dataset,setQuery2,env,function(result){set2=result;k()})}catch(e){error=e;k()}})(function(){var result=null;if(error!=null)callback(error);else if(set1.length===0||set2.length===0)callback([]);
else{var commonVarsTmp={};var commonVars=[];for(var p in set1[0])commonVarsTmp[p]=false;for(var p in set2[0])if(commonVarsTmp[p]===false)commonVars.push(p);if(commonVars.length==0)result=QueryPlan.joinBindings(set1,set2);else if(that.abstractQueryTree.treeWithUnion(setQuery1)||that.abstractQueryTree.treeWithUnion(setQuery2))result=QueryPlan.joinBindings(set1,set2);else result=QueryPlan.joinBindings2(commonVars,set1,set2);QueryFilters.checkFilters(patterns,result,false,dataset,env,that,callback)}})};
QueryEngine.prototype.rangeQuery=function(quad,queryEnv,callback){var that=this;that.normalizeQuad(quad,queryEnv,false,function(key){if(key!=null)that.backend.range(new QuadIndex.Pattern(key),function(quads){if(quads==null||quads.length==0)callback([]);else callback(quads)});else callback(null)})};QueryEngine.prototype.executeUpdate=function(syntaxTree,callback){var prologue=syntaxTree.prologue;var units=syntaxTree.units;var that=this;var queryEnv={blanks:{},outCache:{}};this.registerNsInEnvironment(prologue,
queryEnv);for(var i=0;i<units.length;i++){var aqt=that.abstractQueryTree.parseExecutableUnit(units[i]);if(aqt.kind==="insertdata"){var error=null;async.eachSeries(aqt.quads,function(quad,k){if(error===null)that._executeQuadInsert(quad,queryEnv,function(err){if(err!=null)error=err;k()});else k()},function(){if(error===null)callback(null,true);else callback(error)})}else if(aqt.kind==="deletedata"){var error=null;async.eachSeries(aqt.quads,function(quad,k){if(error===null)that._executeQuadDelete(quad,
queryEnv,function(err){if(err!=null)error=err;k()});else k()},function(){if(error===null)callback(null,true);else callback(error)})}else if(aqt.kind==="modify")this._executeModifyQuery(aqt,queryEnv,callback);else if(aqt.kind==="create")callback(true);else if(aqt.kind==="load"){var graph={"uri":Utils.lexicalFormBaseUri(aqt.sourceGraph,queryEnv)};if(aqt.destinyGraph!=null)graph={"uri":Utils.lexicalFormBaseUri(aqt.destinyGraph,queryEnv)};var that=this;this.rdfLoader.load(aqt.sourceGraph.value,graph,
function(err,result){if(err)callback(new Error("error batch loading quads"));else that.batchLoad(result,function(result){if(result!==null)callback(null,rsult);else callback(new Error("Error batch loading quads"))})})}else if(aqt.kind==="drop")this._executeClearGraph(aqt.destinyGraph,queryEnv,callback);else if(aqt.kind==="clear")this._executeClearGraph(aqt.destinyGraph,queryEnv,callback);else throw new Error("not supported execution unit");}};QueryEngine.prototype.batchLoad=function(quads,callback){var counter=
0;var blanks={};var that=this;if(this.eventsOnBatchLoad)this.callbacksBackend.startGraphModification();var registerComponent=function(quad,component,newQuad,k){var maybeBlankOid,oid,quad;if(quad[component]["uri"]||quad[component].token==="uri"){var uriValue=quad[component].uri||quad[component].value;that.lexicon.registerUri(uriValue,function(oid){var returnUriComponent=function(){if(quad[component].uri!=null){quad[component]={"token":"uri","value":quad[component].uri};delete quad[component]["uri"]}newQuad[component]=
oid;k()};if(component==="graph")that.lexicon.registerGraph(oid,uriValue,function(){returnUriComponent()});else returnUriComponent()})}else if(quad[component]["literal"]||quad[component].token==="literal")that.lexicon.registerLiteral(quad[component].literal||quad[component].value,function(oid){if(quad[component].literal!=null){quad[component]=that.lexicon.parseLiteral(quad[component].literal);delete quad[component]["literal"]}newQuad[component]=oid;k()});else{maybeBlankOid=blanks[quad[component].blank||
quad[component].value];if(maybeBlankOid==null)that.lexicon.registerBlank(function(maybeBlankOid){blanks[quad[component].blank||quad[component].value]=maybeBlankOid;if(quad[component].token==null){quad[component].token="blank";quad[component].value=quad[component].blank;delete quad[component]["blank"]}newQuad[component]=maybeBlankOid;k()});else{if(quad[component].token==null){quad[component].token="blank";quad[component].value=quad[component].blank;delete quad[component]["blank"]}newQuad[component]=
maybeBlankOid;k()}}};async.eachSeries(quads,function(quad,k){var newQuad={};async.eachSeries(["subject","predicate","object","graph"],function(component,kk){registerComponent(quad,component,newQuad,kk)},function(){var originalQuad=quad;quad=newQuad;var key=new QuadIndex.NodeKey(quad);that.backend.search(key,function(result){if(!result)that.backend.index(key,function(result){if(result){if(that.eventsOnBatchLoad)that.callbacksBackend.nextGraphModification(Callbacks.added,[originalQuad,quad]);counter=
counter+1}k()});else k()})})},function(){if(that.lexicon.updateAfterWrite!=null)that.lexicon.updateAfterWrite();var exitFn=function(){callback(counter)};if(that.eventsOnBatchLoad)that.callbacksBackend.endGraphModification(exitFn());else exitFn()})};QueryEngine.prototype._executeModifyQuery=function(aqt,queryEnv,callback){var that=this;var querySuccess=true;var error=new Error("Error executing modify query");var bindings=null;var components=["subject","predicate","object","graph"];aqt.insert=aqt.insert==
null?[]:aqt.insert;aqt.delete=aqt.delete==null?[]:aqt.delete;async.seq(function(k){var defaultGraph=[];var namedGraph=[];if(aqt.with!=null)defaultGraph.push(aqt.with);if(aqt.using!=null){namedGraph=[];for(var i=0;i<aqt.using.length;i++){var usingGraph=aqt.using[i];if(usingGraph.kind==="named")namedGraph.push(usingGraph.uri);else defaultGraph.push(usingGraph.uri)}}aqt.dataset={};aqt.projection=[{"token":"variable","kind":"*"}];that.executeSelect(aqt,queryEnv,defaultGraph,namedGraph,function(err,result){if(err){error=
err;querySuccess=false;return k()}else that.denormalizeBindingsList(result,queryEnv,function(result){if(result!=null)bindings=result;else{error=new Error("Error denormalizing bindings list");querySuccess=false}k()})})},function(k){var defaultGraph=aqt.with;if(querySuccess){var quads=[];for(var i=0;i<aqt.delete.length;i++){var src=aqt.delete[i];for(var j=0;j<bindings.length;j++){var quad={};var binding=bindings[j];for(var c=0;c<components.length;c++){var component=components[c];if(component=="graph"&&
src[component]==null)quad["graph"]=defaultGraph;else if(src[component].token==="var")quad[component]=binding[src[component].value];else quad[component]=src[component]}quads.push(quad)}}async.eachSeries(quads,function(quad,kk){that._executeQuadDelete(quad,queryEnv,function(){kk()})},function(){k()})}else k()},function(k){var defaultGraph=aqt.with;if(querySuccess){var quads=[];for(var i=0;i<aqt.insert.length;i++){var src=aqt.insert[i];for(var j=0;j<bindings.length;j++){var quad={};var binding=bindings[j];
for(var c=0;c<components.length;c++){var component=components[c];if(component=="graph"&&src[component]==null)quad["graph"]=defaultGraph;else if(src[component].token==="var")quad[component]=binding[src[component].value];else quad[component]=src[component]}quads.push(quad)}}async.eachSeries(quads,function(quad,kk){that._executeQuadInsert(quad,queryEnv,function(){kk()})},function(){k()})}else k()})(function(){if(querySuccess)callback(null);else callback(error)})};QueryEngine.prototype._executeQuadInsert=
function(quad,queryEnv,callback){var that=this;var normalized;var error=false;var errorMessage=null;async.seq(function(k){that.normalizeQuad(quad,queryEnv,true,function(result){if(result!=null)normalized=result;else{error=true;errorMessage="Error normalizing quad."}k()})},function(k){if(error===false){var key=new QuadIndex.NodeKey(normalized);that.backend.search(key,function(found){if(found===true)k();else that.backend.index(key,function(){that.callbacksBackend.nextGraphModification(Callbacks.added,
[quad,normalized]);k()})})}else k()})(function(){if(error)callback(new Error(errorMessage));else callback(null,true)})};QueryEngine.prototype._executeQuadDelete=function(quad,queryEnv,callback){var that=this;var normalized;var error=false;var errorMessage,key;async.seq(function(k){that.normalizeQuad(quad,queryEnv,true,function(result){if(result!=null)normalized=result;else{error=true;errorMessage="Error normalizing quad."}k()})},function(k){if(error===false){key=new QuadIndex.NodeKey(normalized);
that.backend.delete(key,function(){k()})}else k()},function(k){if(error===false)that.lexicon.unregister(quad,key,function(){that.callbacksBackend.nextGraphModification(Callbacks["deleted"],[quad,normalized]);k()});else k()})(function(){if(error)callback(new Error(errorMessage));else callback(null,true)})};QueryEngine.prototype._executeClearGraph=function(destinyGraph,queryEnv,callback){var that=this;if(destinyGraph==="default")this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",callback);else if(destinyGraph===
"named")that.lexicon.registeredGraphs(true,function(graphs){if(graphs!=null){var foundErrorDeleting=false;async.eachSeries(graphs,function(graph,k){if(!foundErrorDeleting)that.execute("DELETE { GRAPH <"+graph+"> { ?s ?p ?o } } WHERE { GRAPH <"+graph+"> { ?s ?p ?o } }",function(success,results){foundErrorDeleting=!success;k()});else k()},function(){callback(!foundErrorDeleting)})}else callback(false,"Error deleting named graphs")});else if(destinyGraph==="all"){var that=this;this.execute("CLEAR DEFAULT",
function(err,result){if(!err)that.execute("CLEAR NAMED",callback);else callback(false,result)})}else if(destinyGraph.token=="uri"){var graphUri=Utils.lexicalFormBaseUri(destinyGraph,queryEnv);if(graphUri!=null){this.callbacksBackend.ongoingModification=true;this.execute("DELETE { GRAPH <"+graphUri+"> { ?s ?p ?o } } WHERE { GRAPH <"+graphUri+"> { ?s ?p ?o } }",function(res){that.callbacksBackend.ongoingModification=false;callback(res)})}else callback(false,"wrong graph URI")}else callback(false,"wrong graph URI")};
QueryEngine.prototype.checkGroupSemantics=function(groupVars,projectionVars){if(groupVars==="singleGroup")return true;var projection={};for(var i=0;i<groupVars.length;i++){var groupVar=groupVars[i];if(groupVar.token==="var")projection[groupVar.value]=true;else if(groupVar.token==="aliased_expression")projection[groupVar.alias.value]=true}for(i=0;i<projectionVars.length;i++){var projectionVar=projectionVars[i];if(projectionVar.kind==="var"){if(projection[projectionVar.value.value]==null)return false}else if(projectionVar.kind===
"aliased"&&projectionVar.expression&&projectionVar.expression.primaryexpression==="var")if(projection[projectionVar.expression.value.value]==null)return false}return true};QueryEngine.prototype.computeCosts=function(quads,env,callback){for(var i=0;i<quads.length;i++)quads[i]["_cost"]=this.quadCost(quads[i],env);callback(quads)};QueryEngine.prototype.quadCost=function(quad,env){return 1};QueryEngine.prototype.registerDefaultNamespace=function(ns,prefix){this.defaultPrefixes[ns]=prefix};module.exports=
{QueryEngine:QueryEngine}},{"./abstract_query_tree":37,"./graph_callbacks":40,"./quad_index":48,"./query_filters":50,"./query_plan":51,"./rdf_loader":52,"./rdf_model":53,"./utils":55}],50:[function(_dereq_,module,exports){var Utils=_dereq_("./utils");var _=Utils;var async=_dereq_("./utils");QueryFilters={};var xmlSchema="http://www.w3.org/2001/XMLSchema#";QueryFilters.checkFilters=function(pattern,bindings,nullifyErrors,dataset,queryEnv,queryEngine,callback){var filters=[];if(pattern.filter&&typeof pattern.filter!==
"function")filters=pattern.filter;var nullified=[];if(filters==null||filters.length===0||pattern.length!=null)return callback(bindings);async.eachSeries(filters,function(filter,k){QueryFilters.run(filter.value,bindings,nullifyErrors,dataset,queryEnv,queryEngine,function(filteredBindings){var acum=[];async.eachSeries(filteredBindings,function(filteredBinding,kk){if(filteredBinding["__nullify__"]!=null)nullified.push(filteredBinding);else acum.push(filteredBinding);kk()},function(){bindings=acum;k()})})},
function(){callback(bindings.concat(nullified))})};QueryFilters.boundVars=function(filterExpr){if(filterExpr.expressionType!=null){var expressionType=filterExpr.expressionType;if(expressionType=="relationalexpression"){var op1=filterExpr.op1;var op2=filterExpr.op2;return QueryFilters.boundVars(op1)+QueryFilters.boundVars(op2)}else if(expressionType=="conditionalor"||expressionType=="conditionaland"){var vars=[];for(var i=0;i<filterExpr.operands;i++)vars=vars.concat(QueryFilters.boundVars(filterExpr.operands[i]));
return vars}else if(expressionType=="builtincall")if(filterExpr.args==null)return[];else{var acum=[];for(var i=0;i<filterExpr.args.length;i++)acum=acum.concat(QueryFilters.boundVars(filterExpr.args[i]));return acum}else if(expressionType=="multiplicativeexpression"){var acum=QueryFilters.boundVars(filterExpr.factor);for(var i=0;i<filterExpr.factors.length;i++)acum=acum.concat(QueryFilters.boundVars(filterExpr.factors[i].expression));return acum}else if(expressionType=="additiveexpression"){var acum=
QueryFilters.boundVars(filterExpr.summand);for(var i=0;i<filterExpr.summands.length;i++)acum=acum.concat(QueryFilters.boundVars(filterExpr.summands[i].expression));return acum}else if(expressionType=="regex"){var acum=QueryFilters.boundVars(filterExpr.expression1);return acum.concat(QueryFilters.boundVars(filterExpr.expression2))}else if(expressionType=="unaryexpression")return QueryFilters.boundVars(filterExpr.expression);else if(expressionType=="atomic")if(filterExpr.primaryexpression=="var")return[filterExpr.value];
else return[]}else{console.log("ERROR");console.log(filterExpr);throw"Cannot find bound expressions in a no expression token";}};QueryFilters.run=function(filterExpr,bindings,nullifyFilters,dataset,env,queryEngine,callback){queryEngine.copyDenormalizedBindings(bindings,env.outCache,function(denormBindings){var filteredBindings=[];for(var i=0;i<bindings.length;i++){var thisDenormBindings=denormBindings[i];var ebv=QueryFilters.runFilter(filterExpr,thisDenormBindings,queryEngine,dataset,env);var ebv=
QueryFilters.ebv(ebv);if(QueryFilters.isEbvError(ebv)){if(nullifyFilters){var thisBindings={"__nullify__":true,"bindings":bindings[i]};filteredBindings.push(thisBindings)}}else if(ebv===true)filteredBindings.push(bindings[i]);else if(nullifyFilters){var thisBindings={"__nullify__":true,"bindings":bindings[i]};filteredBindings.push(thisBindings)}}callback(filteredBindings)})};QueryFilters.collect=function(filterExpr,bindings,dataset,env,queryEngine,callback){queryEngine.copyDenormalizedBindings(bindings,
env.outCache,function(denormBindings){var filteredBindings=[];for(var i=0;i<denormBindings.length;i++){var thisDenormBindings=denormBindings[i];var ebv=QueryFilters.runFilter(filterExpr,thisDenormBindings,queryEngine,dataset,env);filteredBindings.push({binding:bindings[i],value:ebv})}return callback(filteredBindings)})};QueryFilters.runDistinct=function(projectedBindings,projectionVariables){};QueryFilters.runAggregator=function(aggregator,bindingsGroup,queryEngine,dataset,env){if(bindingsGroup==
null||bindingsGroup.length===0)return QueryFilters.ebvError();else if(aggregator.token==="variable"&&aggregator.kind=="var")return bindingsGroup[0][aggregator.value.value];else if(aggregator.token==="variable"&&aggregator.kind==="aliased")if(aggregator.expression.expressionType==="atomic"&&aggregator.expression.primaryexpression==="var")return bindingsGroup[0][aggregator.expression.value.value];else if(aggregator.expression.expressionType==="aggregate")if(aggregator.expression.aggregateType==="max"){var max=
null;for(var i=0;i<bindingsGroup.length;i++){var bindings=bindingsGroup[i];var ebv=QueryFilters.runFilter(aggregator.expression.expression,bindings,queryEngine,dataset,env);if(!QueryFilters.isEbvError(ebv))if(max===null)max=ebv;else if(QueryFilters.runLtFunction(max,ebv).value===true)max=ebv}if(max===null)return QueryFilters.ebvError();else return max}else if(aggregator.expression.aggregateType==="min"){var min=null;for(var i=0;i<bindingsGroup.length;i++){var bindings=bindingsGroup[i];var ebv=QueryFilters.runFilter(aggregator.expression.expression,
bindings,queryEngine,dataset,env);if(!QueryFilters.isEbvError(ebv))if(min===null)min=ebv;else if(QueryFilters.runGtFunction(min,ebv).value===true)min=ebv}if(min===null)return QueryFilters.ebvError();else return min}else if(aggregator.expression.aggregateType==="count"){var distinct={};var count=0;if(aggregator.expression.expression==="*")if(aggregator.expression.distinct!=null&&aggregator.expression.distinct!="")for(var i=0;i<bindingsGroup.length;i++){var bindings=bindingsGroup[i];var key=Utils.hashTerm(bindings);
if(distinct[key]==null){distinct[key]=true;count++}}else count=bindingsGroup.length;else for(var i=0;i<bindingsGroup.length;i++){var bindings=bindingsGroup[i];var ebv=QueryFilters.runFilter(aggregator.expression.expression,bindings,queryEngine,dataset,env);if(!QueryFilters.isEbvError(ebv))if(aggregator.expression.distinct!=null&&aggregator.expression.distinct!=""){var key=Utils.hashTerm(ebv);if(distinct[key]==null){distinct[key]=true;count++}}else count++}return{token:"literal",type:xmlSchema+"integer",
value:""+count}}else if(aggregator.expression.aggregateType==="avg"){var distinct={};var aggregated={token:"literal",type:xmlSchema+"integer",value:"0"};var count=0;for(var i=0;i<bindingsGroup.length;i++){var bindings=bindingsGroup[i];var ebv=QueryFilters.runFilter(aggregator.expression.expression,bindings,queryEngine,dataset,env);if(!QueryFilters.isEbvError(ebv))if(aggregator.expression.distinct!=null&&aggregator.expression.distinct!=""){var key=Utils.hashTerm(ebv);if(distinct[key]==null){distinct[key]=
true;if(QueryFilters.isNumeric(ebv)){aggregated=QueryFilters.runSumFunction(aggregated,ebv);count++}}}else if(QueryFilters.isNumeric(ebv)){aggregated=QueryFilters.runSumFunction(aggregated,ebv);count++}}var result=QueryFilters.runDivFunction(aggregated,{token:"literal",type:xmlSchema+"integer",value:""+count});result.value=""+result.value;return result}else if(aggregator.expression.aggregateType==="sum"){var distinct={};var aggregated={token:"literal",type:xmlSchema+"integer",value:"0"};for(var i=
0;i<bindingsGroup.length;i++){var bindings=bindingsGroup[i];var ebv=QueryFilters.runFilter(aggregator.expression.expression,bindings,queryEngine,dataset,env);if(!QueryFilters.isEbvError(ebv))if(aggregator.expression.distinct!=null&&aggregator.expression.distinct!=""){var key=Utils.hashTerm(ebv);if(distinct[key]==null){distinct[key]=true;if(QueryFilters.isNumeric(ebv))aggregated=QueryFilters.runSumFunction(aggregated,ebv)}}else if(QueryFilters.isNumeric(ebv))aggregated=QueryFilters.runSumFunction(aggregated,
ebv)}aggregated.value=""+aggregated.value;return aggregated}else{var ebv=QueryFilters.runFilter(aggregate.expression,bindingsGroup[0],dataset,{blanks:{},outCache:{}});return ebv}};QueryFilters.runFilter=function(filterExpr,bindings,queryEngine,dataset,env){if(filterExpr.expressionType!=null){var expressionType=filterExpr.expressionType;if(expressionType=="relationalexpression"){var op1=QueryFilters.runFilter(filterExpr.op1,bindings,queryEngine,dataset,env);var op2=QueryFilters.runFilter(filterExpr.op2,
bindings,queryEngine,dataset,env);return QueryFilters.runRelationalFilter(filterExpr,op1,op2,bindings,queryEngine,dataset,env)}else if(expressionType=="conditionalor")return QueryFilters.runOrFunction(filterExpr,bindings,queryEngine,dataset,env);else if(expressionType=="conditionaland")return QueryFilters.runAndFunction(filterExpr,bindings,queryEngine,dataset,env);else if(expressionType=="additiveexpression")return QueryFilters.runAddition(filterExpr.summand,filterExpr.summands,bindings,queryEngine,
dataset,env);else if(expressionType=="builtincall")return QueryFilters.runBuiltInCall(filterExpr.builtincall,filterExpr.args,bindings,queryEngine,dataset,env);else if(expressionType=="multiplicativeexpression")return QueryFilters.runMultiplication(filterExpr.factor,filterExpr.factors,bindings,queryEngine,dataset,env);else if(expressionType=="unaryexpression")return QueryFilters.runUnaryExpression(filterExpr.unaryexpression,filterExpr.expression,bindings,queryEngine,dataset,env);else if(expressionType==
"irireforfunction")return QueryFilters.runIriRefOrFunction(filterExpr.iriref,filterExpr.args,bindings,queryEngine,dataset,env);else if(expressionType=="regex")return QueryFilters.runRegex(filterExpr.text,filterExpr.pattern,filterExpr.flags,bindings,queryEngine,dataset,env);else if(expressionType=="custom")return QueryFilters.runBuiltInCall(filterExpr.name,filterExpr.args,bindings,queryEngine,dataset,env);else if(expressionType=="atomic")if(filterExpr.primaryexpression=="var")return bindings[filterExpr.value.value];
else if(typeof filterExpr.value!="object")return filterExpr.value;else if(filterExpr.value.type==null||typeof filterExpr.value.type!="object")return filterExpr.value;else{filterExpr.value.type=Utils.lexicalFormBaseUri(filterExpr.value.type,env);return filterExpr.value}else throw"Unknown filter expression type";}else throw"Cannot find bound expressions in a no expression token";};QueryFilters.isRDFTerm=function(val){if(val==null)return false;if(val.token&&val.token=="literal"||val.token&&val.token==
"uri"||val.token&&val.token=="blank")return true;else return false};QueryFilters.RDFTermEquality=function(v1,v2,queryEngine,env){if(v1.token==="literal"&&v2.token==="literal")if(v1.lang==v2.lang&&v1.type==v2.type&&v1.value==v2.value)return true;else if(v1.type!=null&&v2.type!=null)return QueryFilters.ebvError();else if(QueryFilters.isSimpleLiteral(v1)&&v2.type!=null)return QueryFilters.ebvError();else if(QueryFilters.isSimpleLiteral(v2)&&v1.type!=null)return QueryFilters.ebvError();else return false;
else if(v1.token==="uri"&&v2.token==="uri")return Utils.lexicalFormBaseUri(v1,env)==Utils.lexicalFormBaseUri(v2,env);else if(v1.token==="blank"&&v2.token==="blank")return v1.value==v2.value;else return false};QueryFilters.isInteger=function(val){if(val==null)return false;if(val.token==="literal")if(val.type==xmlSchema+"integer"||val.type==xmlSchema+"decimal"||val.type==xmlSchema+"double"||val.type==xmlSchema+"nonPositiveInteger"||val.type==xmlSchema+"negativeInteger"||val.type==xmlSchema+"long"||
val.type==xmlSchema+"int"||val.type==xmlSchema+"short"||val.type==xmlSchema+"byte"||val.type==xmlSchema+"nonNegativeInteger"||val.type==xmlSchema+"unsignedLong"||val.type==xmlSchema+"unsignedInt"||val.type==xmlSchema+"unsignedShort"||val.type==xmlSchema+"unsignedByte"||val.type==xmlSchema+"positiveInteger")return true;else return false;else return false};QueryFilters.isFloat=function(val){if(val==null)return false;if(val.token==="literal")if(val.type==xmlSchema+"float")return true;else return false;
else return false};QueryFilters.isDecimal=function(val){if(val==null)return false;if(val.token==="literal")if(val.type==xmlSchema+"decimal")return true;else return false;else return false};QueryFilters.isDouble=function(val){if(val==null)return false;if(val.token==="literal")if(val.type==xmlSchema+"double")return true;else return false;else return false};QueryFilters.isNumeric=function(val){if(val==null)return false;if(val.token==="literal")if(val.type==xmlSchema+"integer"||val.type==xmlSchema+"decimal"||
val.type==xmlSchema+"float"||val.type==xmlSchema+"double"||val.type==xmlSchema+"nonPositiveInteger"||val.type==xmlSchema+"negativeInteger"||val.type==xmlSchema+"long"||val.type==xmlSchema+"int"||val.type==xmlSchema+"short"||val.type==xmlSchema+"byte"||val.type==xmlSchema+"nonNegativeInteger"||val.type==xmlSchema+"unsignedLong"||val.type==xmlSchema+"unsignedInt"||val.type==xmlSchema+"unsignedShort"||val.type==xmlSchema+"unsignedByte"||val.type==xmlSchema+"positiveInteger")return true;else return false;
else return false};QueryFilters.isSimpleLiteral=function(val){if(val&&val.token=="literal")if(val.type==null&&val.lang==null)return true;else return false;else return false};QueryFilters.isXsdType=function(type,val){if(val&&val.token=="literal")return val.type==xmlSchema+""+type;else return false};QueryFilters.ebv=function(term){if(term==null||QueryFilters.isEbvError(term))return QueryFilters.ebvError();else if(term.token&&term.token==="literal")if(term.type==xmlSchema+"integer"||term.type==xmlSchema+
"decimal"||term.type==xmlSchema+"double"||term.type==xmlSchema+"nonPositiveInteger"||term.type==xmlSchema+"negativeInteger"||term.type==xmlSchema+"long"||term.type==xmlSchema+"int"||term.type==xmlSchema+"short"||term.type==xmlSchema+"byte"||term.type==xmlSchema+"nonNegativeInteger"||term.type==xmlSchema+"unsignedLong"||term.type==xmlSchema+"unsignedInt"||term.type==xmlSchema+"unsignedShort"||term.type==xmlSchema+"unsignedByte"||term.type==xmlSchema+"positiveInteger"){var tmp=parseFloat(term.value);
if(isNaN(tmp))return false;else return parseFloat(term.value)!=0}else if(term.type===xmlSchema+"boolean")return term.value==="true"||term.value===true||term.value==="True";else if(term.type===xmlSchema+"string")return term.value!="";else if(term.type===xmlSchema+"dateTime")return new Date(term.value)!=null;else if(QueryFilters.isEbvError(term))return term;else if(term.type==null)if(term.value!="")return true;else return false;else return QueryFilters.ebvError();else return term.value===true};QueryFilters.effectiveBooleanValue=
QueryFilters.ebv;QueryFilters.ebvTrue=function(){var val={token:"literal",type:xmlSchema+"boolean",value:true};return val};QueryFilters.ebvFalse=function(){var val={token:"literal",type:xmlSchema+"boolean",value:false};return val};QueryFilters.ebvError=function(){var val={token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null};return val};QueryFilters.isEbvError=function(term){if(typeof term=="object"&&term!=null)return term.type==="https://github.com/antoniogarrote/js-tools/types#error";
else return false};QueryFilters.ebvBoolean=function(bool){if(QueryFilters.isEbvError(bool))return bool;else if(bool===true)return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse()};QueryFilters.runRelationalFilter=function(filterExpr,op1,op2,bindings,queryEngine,dataset,env){var operator=filterExpr.operator;if(operator==="=")return QueryFilters.runEqualityFunction(op1,op2,bindings,queryEngine,dataset,env);else if(operator==="!="){var res=QueryFilters.runEqualityFunction(op1,op2,bindings,
queryEngine,dataset,env);if(QueryFilters.isEbvError(res))return res;else{res.value=!res.value;return res}}else if(operator==="<")return QueryFilters.runLtFunction(op1,op2,bindings);else if(operator===">")return QueryFilters.runGtFunction(op1,op2,bindings);else if(operator==="<=")return QueryFilters.runLtEqFunction(op1,op2,bindings);else if(operator===">=")return QueryFilters.runGtEqFunction(op1,op2,bindings);else throw"Error applying relational filter, unknown operator";};QueryFilters.effectiveTypeValue=
function(val){if(val.token=="literal")if(val.type==xmlSchema+"integer"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"decimal"){var tmp=parseFloat(val.value);return tmp}else if(val.type==xmlSchema+"float"){var tmp=parseFloat(val.value);return tmp}else if(val.type==xmlSchema+"double"){var tmp=parseFloat(val.value);return tmp}else if(val.type==xmlSchema+"nonPositiveInteger"){var tmp=parseFloat(val.value);return tmp}else if(val.type==xmlSchema+"negativeInteger"){var tmp=parseInt(val.value);
return tmp}else if(val.type==xmlSchema+"long"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"int"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"short"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"byte"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"nonNegativeInteger"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"unsignedLong"){var tmp=parseInt(val.value);return tmp}else if(val.type==
xmlSchema+"unsignedInt"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"unsignedShort"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"unsignedByte"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"positiveInteger"){var tmp=parseInt(val.value);return tmp}else if(val.type==xmlSchema+"date"||val.type==xmlSchema+"dateTime")try{var d=Utils.parseISO8601(val.value);return d}catch(e){return null}else if(val.type==xmlSchema+"boolean")return val.value===
true||val.value==="true"||val.value==="1"||val.value===1||val.value===true?true:val.value===false||val.value==="false"||val.value==="0"||val.value===0||val.value===false?false:undefined;else if(val.type==xmlSchema+"string")return val.value===null||val.value===undefined?undefined:""+val.value;else if(val.type==null)return val.value;else return val.value;else{console.log("not implemented yet");console.log(val);throw"value not supported in operations yet";}};QueryFilters.runOrFunction=function(filterExpr,
bindings,queryEngine,dataset,env){var acum=null;for(var i=0;i<filterExpr.operands.length;i++){var ebv=QueryFilters.runFilter(filterExpr.operands[i],bindings,queryEngine,dataset,env);if(QueryFilters.isEbvError(ebv)==false)ebv=QueryFilters.ebv(ebv);if(acum==null)acum=ebv;else if(QueryFilters.isEbvError(ebv))if(QueryFilters.isEbvError(acum))acum=QueryFilters.ebvError();else if(acum===true)acum=true;else acum=QueryFilters.ebvError();else if(ebv===true)acum=true;else if(QueryFilters.isEbvError(acum))acum=
QueryFilters.ebvError()}return QueryFilters.ebvBoolean(acum)};QueryFilters.runAndFunction=function(filterExpr,bindings,queryEngine,dataset,env){var acum=null;for(var i=0;i<filterExpr.operands.length;i++){var ebv=QueryFilters.runFilter(filterExpr.operands[i],bindings,queryEngine,dataset,env);if(QueryFilters.isEbvError(ebv)==false)ebv=QueryFilters.ebv(ebv);if(acum==null)acum=ebv;else if(QueryFilters.isEbvError(ebv))if(QueryFilters.isEbvError(acum))acum=QueryFilters.ebvError();else if(acum===true)acum=
QueryFilters.ebvError();else acum=false;else if(ebv===true){if(QueryFilters.isEbvError(acum))acum=QueryFilters.ebvError()}else acum=false}return QueryFilters.ebvBoolean(acum)};QueryFilters.runEqualityFunction=function(op1,op2,bindings,queryEngine,dataset,env){if(QueryFilters.isEbvError(op1)||QueryFilters.isEbvError(op2))return QueryFilters.ebvError();if(QueryFilters.isNumeric(op1)&&QueryFilters.isNumeric(op2)){var eop1=QueryFilters.effectiveTypeValue(op1);var eop2=QueryFilters.effectiveTypeValue(op2);
if(isNaN(eop1)||isNaN(eop2))return QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(op1,op2,queryEngine,env));else return QueryFilters.ebvBoolean(eop1==eop2)}else if((QueryFilters.isSimpleLiteral(op1)||QueryFilters.isXsdType("string",op1))&&(QueryFilters.isSimpleLiteral(op2)||QueryFilters.isXsdType("string",op2)))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)==QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isXsdType("boolean",op1)&&QueryFilters.isXsdType("boolean",
op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)==QueryFilters.effectiveTypeValue(op2));else if((QueryFilters.isXsdType("dateTime",op1)||QueryFilters.isXsdType("date",op1))&&(QueryFilters.isXsdType("dateTime",op2)||QueryFilters.isXsdType("date",op2))){if(QueryFilters.isXsdType("dateTime",op1)&&QueryFilters.isXsdType("date",op2))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",op1)&&QueryFilters.isXsdType("dateTime",op2))return QueryFilters.ebvFalse();var comp=
Utils.compareDateComponents(op1.value,op2.value);if(comp!=null)if(comp==0)return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse();else return QueryFilters.ebvError()}else if(QueryFilters.isRDFTerm(op1)&&QueryFilters.isRDFTerm(op2))return QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(op1,op2,queryEngine,env));else return QueryFilters.ebvFalse()};QueryFilters.runGtFunction=function(op1,op2,bindings){if(QueryFilters.isEbvError(op1)||QueryFilters.isEbvError(op2))return QueryFilters.ebvError();
if(QueryFilters.isNumeric(op1)&&QueryFilters.isNumeric(op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)>QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isSimpleLiteral(op1)&&QueryFilters.isSimpleLiteral(op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)>QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isXsdType("string",op1)&&QueryFilters.isXsdType("string",op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)>QueryFilters.effectiveTypeValue(op2));
else if(QueryFilters.isXsdType("boolean",op1)&&QueryFilters.isXsdType("boolean",op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)>QueryFilters.effectiveTypeValue(op2));else if((QueryFilters.isXsdType("dateTime",op1)||QueryFilters.isXsdType("date",op1))&&(QueryFilters.isXsdType("dateTime",op2)||QueryFilters.isXsdType("date",op2))){if(QueryFilters.isXsdType("dateTime",op1)&&QueryFilters.isXsdType("date",op2))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",op1)&&
QueryFilters.isXsdType("dateTime",op2))return QueryFilters.ebvFalse();var comp=Utils.compareDateComponents(op1.value,op2.value);if(comp!=null)if(comp==1)return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse();else return QueryFilters.ebvError()}else return QueryFilters.ebvFalse()};QueryFilters.runTotalGtFunction=function(op1,op2){if(QueryFilters.isEbvError(op1)||QueryFilters.isEbvError(op2))return QueryFilters.ebvError();if(QueryFilters.isNumeric(op1)&&QueryFilters.isNumeric(op2)||QueryFilters.isSimpleLiteral(op1)&&
QueryFilters.isSimpleLiteral(op2)||QueryFilters.isXsdType("string",op1)&&QueryFilters.isSimpleLiteral("string",op2)||QueryFilters.isXsdType("boolean",op1)&&QueryFilters.isSimpleLiteral("boolean",op2)||QueryFilters.isXsdType("dateTime",op1)&&QueryFilters.isSimpleLiteral("dateTime",op2))return QueryFilters.runGtFunction(op1,op2,[]);else if(op1.token&&op1.token==="uri"&&op2.token&&op2.token==="uri")return QueryFilters.ebvBoolean(op1.value>op2.value);else if(op1.token&&op1.token==="literal"&&op2.token&&
op2.token==="literal")return QueryFilters.ebvBoolean(""+op1.value+op1.type+op1.lang>""+op2.value+op2.type+op2.lang);else if(op1.token&&op1.token==="blank"&&op2.token&&op2.token==="blank")return QueryFilters.ebvBoolean(op1.value>op2.value);else if(op1.value&&op2.value)return QueryFilters.ebvBoolean(op1.value>op2.value);else return QueryFilters.ebvTrue()};QueryFilters.runLtFunction=function(op1,op2,bindings){if(QueryFilters.isEbvError(op1)||QueryFilters.isEbvError(op2))return QueryFilters.ebvError();
if(QueryFilters.isNumeric(op1)&&QueryFilters.isNumeric(op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)<QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isSimpleLiteral(op1)&&QueryFilters.isSimpleLiteral(op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)<QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isXsdType("string",op1)&&QueryFilters.isXsdType("string",op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)<QueryFilters.effectiveTypeValue(op2));
else if(QueryFilters.isXsdType("boolean",op1)&&QueryFilters.isXsdType("boolean",op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)<QueryFilters.effectiveTypeValue(op2));else if((QueryFilters.isXsdType("dateTime",op1)||QueryFilters.isXsdType("date",op1))&&(QueryFilters.isXsdType("dateTime",op2)||QueryFilters.isXsdType("date",op2))){if(QueryFilters.isXsdType("dateTime",op1)&&QueryFilters.isXsdType("date",op2))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",op1)&&
QueryFilters.isXsdType("dateTime",op2))return QueryFilters.ebvFalse();var comp=Utils.compareDateComponents(op1.value,op2.value);if(comp!=null)if(comp==-1)return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse();else return QueryFilters.ebvError()}else return QueryFilters.ebvFalse()};QueryFilters.runGtEqFunction=function(op1,op2,bindings){if(QueryFilters.isEbvError(op1)||QueryFilters.isEbvError(op2))return QueryFilters.ebvError();if(QueryFilters.isNumeric(op1)&&QueryFilters.isNumeric(op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)>=
QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isSimpleLiteral(op1)&&QueryFilters.isSimpleLiteral(op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)>=QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isXsdType("string",op1)&&QueryFilters.isXsdType("string",op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)>=QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isXsdType("boolean",op1)&&QueryFilters.isXsdType("boolean",op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)>=
QueryFilters.effectiveTypeValue(op2));else if((QueryFilters.isXsdType("dateTime",op1)||QueryFilters.isXsdType("date",op1))&&(QueryFilters.isXsdType("dateTime",op2)||QueryFilters.isXsdType("date",op2))){if(QueryFilters.isXsdType("dateTime",op1)&&QueryFilters.isXsdType("date",op2))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",op1)&&QueryFilters.isXsdType("dateTime",op2))return QueryFilters.ebvFalse();var comp=Utils.compareDateComponents(op1.value,op2.value);if(comp!=null)if(comp!=
-1)return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse();else return QueryFilters.ebvError()}else return QueryFilters.ebvFalse()};QueryFilters.runLtEqFunction=function(op1,op2,bindings){if(QueryFilters.isEbvError(op1)||QueryFilters.isEbvError(op2))return QueryFilters.ebvError();if(QueryFilters.isNumeric(op1)&&QueryFilters.isNumeric(op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)<=QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isSimpleLiteral(op1)&&
QueryFilters.isSimpleLiteral(op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)<=QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isXsdType("string",op1)&&QueryFilters.isXsdType("string",op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)<=QueryFilters.effectiveTypeValue(op2));else if(QueryFilters.isXsdType("boolean",op1)&&QueryFilters.isXsdType("boolean",op2))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(op1)<=QueryFilters.effectiveTypeValue(op2));
else if((QueryFilters.isXsdType("dateTime",op1)||QueryFilters.isXsdType("date",op1))&&(QueryFilters.isXsdType("dateTime",op2)||QueryFilters.isXsdType("date",op2))){if(QueryFilters.isXsdType("dateTime",op1)&&QueryFilters.isXsdType("date",op2))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",op1)&&QueryFilters.isXsdType("dateTime",op2))return QueryFilters.ebvFalse();var comp=Utils.compareDateComponents(op1.value,op2.value);if(comp!=null)if(comp!=1)return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse();
else return QueryFilters.ebvError()}else return QueryFilters.ebvFalse()};QueryFilters.runAddition=function(summand,summands,bindings,queryEngine,dataset,env){var summandOp=QueryFilters.runFilter(summand,bindings,queryEngine,dataset,env);if(QueryFilters.isEbvError(summandOp))return QueryFilters.ebvError();var acum=summandOp;if(QueryFilters.isNumeric(summandOp)){for(var i=0;i<summands.length;i++){var nextSummandOp=QueryFilters.runFilter(summands[i].expression,bindings,queryEngine,dataset,env);if(QueryFilters.isNumeric(nextSummandOp))if(summands[i].operator===
"+")acum=QueryFilters.runSumFunction(acum,nextSummandOp);else{if(summands[i].operator==="-")acum=QueryFilters.runSubFunction(acum,nextSummandOp)}else return QueryFilters.ebvFalse()}return acum}else return QueryFilters.ebvFalse()};QueryFilters.runSumFunction=function(suma,sumb){if(QueryFilters.isEbvError(suma)||QueryFilters.isEbvError(sumb))return QueryFilters.ebvError();var val=QueryFilters.effectiveTypeValue(suma)+QueryFilters.effectiveTypeValue(sumb);if(QueryFilters.isDouble(suma)||QueryFilters.isDouble(sumb))return{token:"literal",
type:xmlSchema+"double",value:val};else if(QueryFilters.isFloat(suma)||QueryFilters.isFloat(sumb))return{token:"literal",type:xmlSchema+"float",value:val};else if(QueryFilters.isDecimal(suma)||QueryFilters.isDecimal(sumb))return{token:"literal",type:xmlSchema+"decimal",value:val};else return{token:"literal",type:xmlSchema+"integer",value:val}};QueryFilters.runSubFunction=function(suma,sumb){if(QueryFilters.isEbvError(suma)||QueryFilters.isEbvError(sumb))return QueryFilters.ebvError();var val=QueryFilters.effectiveTypeValue(suma)-
QueryFilters.effectiveTypeValue(sumb);if(QueryFilters.isDouble(suma)||QueryFilters.isDouble(sumb))return{token:"literal",type:xmlSchema+"double",value:val};else if(QueryFilters.isFloat(suma)||QueryFilters.isFloat(sumb))return{token:"literal",type:xmlSchema+"float",value:val};else if(QueryFilters.isDecimal(suma)||QueryFilters.isDecimal(sumb))return{token:"literal",type:xmlSchema+"decimal",value:val};else return{token:"literal",type:xmlSchema+"integer",value:val}};QueryFilters.runMultiplication=function(factor,
factors,bindings,queryEngine,dataset,env){var factorOp=QueryFilters.runFilter(factor,bindings,queryEngine,dataset,env);if(QueryFilters.isEbvError(factorOp))return factorOp;var acum=factorOp;if(QueryFilters.isNumeric(factorOp)){for(var i=0;i<factors.length;i++){var nextFactorOp=QueryFilters.runFilter(factors[i].expression,bindings,queryEngine,dataset,env);if(QueryFilters.isEbvError(nextFactorOp))return factorOp;if(QueryFilters.isNumeric(nextFactorOp))if(factors[i].operator==="*")acum=QueryFilters.runMulFunction(acum,
nextFactorOp);else{if(factors[i].operator==="/")acum=QueryFilters.runDivFunction(acum,nextFactorOp)}else return QueryFilters.ebvFalse()}return acum}else return QueryFilters.ebvFalse()};QueryFilters.runMulFunction=function(faca,facb){if(QueryFilters.isEbvError(faca)||QueryFilters.isEbvError(facb))return QueryFilters.ebvError();var val=QueryFilters.effectiveTypeValue(faca)*QueryFilters.effectiveTypeValue(facb);if(QueryFilters.isDouble(faca)||QueryFilters.isDouble(facb))return{token:"literal",type:xmlSchema+
"double",value:val};else if(QueryFilters.isFloat(faca)||QueryFilters.isFloat(facb))return{token:"literal",type:xmlSchema+"float",value:val};else if(QueryFilters.isDecimal(faca)||QueryFilters.isDecimal(facb))return{token:"literal",type:xmlSchema+"decimal",value:val};else return{token:"literal",type:xmlSchema+"integer",value:val}};QueryFilters.runDivFunction=function(faca,facb){if(QueryFilters.isEbvError(faca)||QueryFilters.isEbvError(facb))return QueryFilters.ebvError();var val=QueryFilters.effectiveTypeValue(faca)/
QueryFilters.effectiveTypeValue(facb);if(QueryFilters.isDouble(faca)||QueryFilters.isDouble(facb))return{token:"literal",type:xmlSchema+"double",value:val};else if(QueryFilters.isFloat(faca)||QueryFilters.isFloat(facb))return{token:"literal",type:xmlSchema+"float",value:val};else if(QueryFilters.isDecimal(faca)||QueryFilters.isDecimal(facb))return{token:"literal",type:xmlSchema+"decimal",value:val};else return{token:"literal",type:xmlSchema+"integer",value:val}};QueryFilters.runBuiltInCall=function(builtincall,
args,bindings,queryEngine,dataset,env){if(builtincall==="notexists"||builtincall==="exists"){var cloned=_.clone(args[0],true);var ast=queryEngine.abstractQueryTree.parseSelect({pattern:cloned},bindings);ast=queryEngine.abstractQueryTree.bind(ast.pattern,bindings);var result=queryEngine.executeSelectUnit([{kind:"*"}],dataset,ast,env);if(builtincall==="exists")return QueryFilters.ebvBoolean(result.length!==0);else return QueryFilters.ebvBoolean(result.length===0)}else{var ops=[];for(var i=0;i<args.length;i++)if(args[i].token===
"var")ops.push(args[i]);else{var op=QueryFilters.runFilter(args[i],bindings,queryEngine,dataset,env);if(QueryFilters.isEbvError(op))return op;ops.push(op)}if(builtincall==="str")if(ops[0].token==="literal")return{token:"literal",type:null,value:""+ops[0].value};else if(ops[0].token==="uri")return{token:"literal",type:null,value:ops[0].value};else return QueryFilters.ebvFalse();else if(builtincall==="lang")if(ops[0].token==="literal")if(ops[0].lang!=null)return{token:"literal",value:""+ops[0].lang};
else return{token:"literal",value:""};else return QueryFilters.ebvError();else if(builtincall==="datatype")if(ops[0].token==="literal"){var lit=ops[0];if(lit.type!=null)if(typeof lit.type==="string")return{token:"uri",value:lit.type,prefix:null,suffix:null};else return lit.type;else if(lit.lang==null)return{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null};else return QueryFilters.ebvError()}else return QueryFilters.ebvError();else if(builtincall==="isliteral")if(ops[0].token===
"literal")return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse();else if(builtincall==="isblank")if(ops[0].token==="blank")return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse();else if(builtincall==="isuri"||builtincall==="isiri")if(ops[0].token==="uri")return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse();else if(builtincall==="sameterm"){var op1=ops[0];var op2=ops[1];var res=QueryFilters.RDFTermEquality(op1,op2,queryEngine,env);if(QueryFilters.isEbvError(res))res=
false;return QueryFilters.ebvBoolean(res)}else if(builtincall==="langmatches"){var lang=ops[0];var langRange=ops[1];if(lang.token==="literal"&&langRange.token==="literal")if(langRange.value==="*"&&lang.value!="")return QueryFilters.ebvTrue();else return QueryFilters.ebvBoolean(lang.value.toLowerCase().indexOf(langRange.value.toLowerCase())===0);else return QueryFilters.ebvError()}else if(builtincall==="bound"){var boundVar=ops[0].value;var acum=[];if(boundVar==null)return QueryFilters.ebvError();
else if(bindings[boundVar]!=null)return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse()}else if(queryEngine.customFns[builtincall]!=null)return queryEngine.customFns[builtincall](QueryFilters,ops);else throw"Builtin call "+builtincall+" not implemented yet";}};QueryFilters.runUnaryExpression=function(unaryexpression,expression,bindings,queryEngine,dataset,env){var op=QueryFilters.runFilter(expression,bindings,queryEngine,dataset,env);if(QueryFilters.isEbvError(op))return op;if(unaryexpression===
"!"){var res=QueryFilters.ebv(op);if(QueryFilters.isEbvError(res))return QueryFilters.ebvFalse();else{res=!res;return QueryFilters.ebvBoolean(res)}}else if(unaryexpression==="+")if(QueryFilters.isNumeric(op))return op;else return QueryFilters.ebvError();else if(unaryexpression==="-")if(QueryFilters.isNumeric(op)){var clone={};for(var p in op)clone[p]=op[p];clone.value=-clone.value;return clone}else return QueryFilters.ebvError()};QueryFilters.runRegex=function(text,pattern,flags,bindings,queryEngine,
dataset,env){if(text!=null)text=QueryFilters.runFilter(text,bindings,queryEngine,dataset,env);else return QueryFilters.ebvError();if(pattern!=null)pattern=QueryFilters.runFilter(pattern,bindings,queryEngine,dataset,env);else return QueryFilters.ebvError();if(flags!=null)flags=QueryFilters.runFilter(flags,bindings,queryEngine,dataset,env);if(pattern!=null&&pattern.token==="literal"&&(flags==null||flags.token==="literal")){pattern=pattern.value;flags=flags==null?null:flags.value}else return QueryFilters.ebvError();
if(text!=null&&text.token=="var")if(bindings[text.value]!=null)text=bindings[text.value];else return QueryFilters.ebvError();else if(text!=null&&text.token==="literal")if(text.type==null||QueryFilters.isXsdType("string",text))text=text.value;else return QueryFilters.ebvError();else return QueryFilters.ebvError();var regex;if(flags==null)regex=new RegExp(pattern);else regex=new RegExp(pattern,flags.toLowerCase());if(regex.exec(text))return QueryFilters.ebvTrue();else return QueryFilters.ebvFalse()};
QueryFilters.normalizeLiteralDatatype=function(literal,queryEngine,env){if(literal.value.type==null||typeof literal.value.type!="object")return literal;else{literal.value.type=Utils.lexicalFormBaseUri(literal.value.type,env);return literal}};QueryFilters.runIriRefOrFunction=function(iriref,args,bindings,queryEngine,dataset,env){if(args==null)return iriref;else{var ops=[];for(var i=0;i<args.length;i++)ops.push(QueryFilters.runFilter(args[i],bindings,queryEngine,dataset,env));var fun=Utils.lexicalFormBaseUri(iriref,
env);if(fun==xmlSchema+"integer"||fun==xmlSchema+"decimal"||fun==xmlSchema+"double"||fun==xmlSchema+"nonPositiveInteger"||fun==xmlSchema+"negativeInteger"||fun==xmlSchema+"long"||fun==xmlSchema+"int"||fun==xmlSchema+"short"||fun==xmlSchema+"byte"||fun==xmlSchema+"nonNegativeInteger"||fun==xmlSchema+"unsignedLong"||fun==xmlSchema+"unsignedInt"||fun==xmlSchema+"unsignedShort"||fun==xmlSchema+"unsignedByte"||fun==xmlSchema+"positiveInteger"){var from=ops[0];if(from.token==="literal"){from=QueryFilters.normalizeLiteralDatatype(from,
queryEngine,env);if(from.type==xmlSchema+"integer"||from.type==xmlSchema+"decimal"||from.type==xmlSchema+"double"||from.type==xmlSchema+"nonPositiveInteger"||from.type==xmlSchema+"negativeInteger"||from.type==xmlSchema+"long"||from.type==xmlSchema+"int"||from.type==xmlSchema+"short"||from.type==xmlSchema+"byte"||from.type==xmlSchema+"nonNegativeInteger"||from.type==xmlSchema+"unsignedLong"||from.type==xmlSchema+"unsignedInt"||from.type==xmlSchema+"unsignedShort"||from.type==xmlSchema+"unsignedByte"||
from.type==xmlSchema+"positiveInteger"){from.type=fun;return from}else if(from.type=="http://www.w3.org/2001/XMLSchema#boolean"){if(QueryFilters.ebv(from)==true){from.type=fun;from.value=1}else{from.type=fun;from.value=0}return from}else if(from.type=="http://www.w3.org/2001/XMLSchema#float"||from.type=="http://www.w3.org/2001/XMLSchema#double"){from.type=fun;from.value=parseInt(from.value);return from}else if(from.type=="http://www.w3.org/2001/XMLSchema#string"||from.type==null){if(from.value.split(".").length>
2)return QueryFilters.ebvError();else if(from.value.split("-").length>2)return QueryFilters.ebvError();else if(from.value.split("/").length>2)return QueryFilters.ebvError();else if(from.value.split("+").length>2)return QueryFilters.ebvError();if(fun==xmlSchema+"decimal")if(from.value.indexOf("e")!=-1||from.value.indexOf("E")!=-1)return QueryFilters.ebvError();if(fun==xmlSchema+"int"||fun==xmlSchema+"integer")if(from.value.indexOf("e")!=-1||from.value.indexOf("E")!=-1||from.value.indexOf(".")!=-1)return QueryFilters.ebvError();
try{from.value=parseInt(parseFloat(from.value));if(isNaN(from.value))return QueryFilters.ebvError();else{from.type=fun;return from}}catch(e){return QueryFilters.ebvError()}}else return QueryFilters.ebvError()}else return QueryFilters.ebvError()}else if(fun==xmlSchema+"boolean"){var from=ops[0];if(from.token==="literal"&&from.type==null)if(from.value==="true"||from.value==="1")return QueryFilters.ebvTrue();else if(from.value==="false"||from.value==="0")return QueryFilters.ebvFalse();else return QueryFilters.ebvError();
else if(from.token==="literal")if(QueryFilters.isEbvError(from))return from;else return QueryFilters.ebvBoolean(from);else return QueryFilters.ebvError()}else if(fun==xmlSchema+"string"){var from=ops[0];if(from.token==="literal"){from=QueryFilters.normalizeLiteralDatatype(from,queryEngine,env);if(from.type==xmlSchema+"integer"||from.type==xmlSchema+"decimal"||from.type==xmlSchema+"double"||from.type==xmlSchema+"nonPositiveInteger"||from.type==xmlSchema+"negativeInteger"||from.type==xmlSchema+"long"||
from.type==xmlSchema+"int"||from.type==xmlSchema+"short"||from.type==xmlSchema+"byte"||from.type==xmlSchema+"nonNegativeInteger"||from.type==xmlSchema+"unsignedLong"||from.type==xmlSchema+"unsignedInt"||from.type==xmlSchema+"unsignedShort"||from.type==xmlSchema+"unsignedByte"||from.type==xmlSchema+"positiveInteger"||from.type==xmlSchema+"float"){from.type=fun;from.value=""+from.value;return from}else if(from.type==xmlSchema+"string")return from;else if(from.type==xmlSchema+"boolean"){if(QueryFilters.ebv(from)){from.type=
fun;from.value="true"}else{from.type=fun;from.value="false"}return from}else if(from.type==xmlSchema+"dateTime"||from.type==xmlSchema+"date"){from.type=fun;if(typeof from.value!="string")from.value=Utils.iso8601(from.value);return from}else if(from.type==null){from.value=""+from.value;from.type=fun;return from}else return QueryFilters.ebvError()}else if(from.token==="uri")return{token:"literal",value:Utils.lexicalFormBaseUri(from,env),type:fun,lang:null};else return QueryFilters.ebvError()}else if(fun==
xmlSchema+"dateTime"||fun==xmlSchema+"date"){from=ops[0];if(from.type==xmlSchema+"dateTime"||from.type==xmlSchema+"date")return from;else if(from.type==xmlSchema+"string"||from.type==null)try{from.value=Utils.iso8601(Utils.parseISO8601(from.value));from.type=fun;return from}catch(e){return QueryFilters.ebvError()}else return QueryFilters.ebvError()}else if(fun==xmlSchema+"float"){var from=ops[0];if(from.token==="literal"){from=QueryFilters.normalizeLiteralDatatype(from,queryEngine,env);if(from.type==
"http://www.w3.org/2001/XMLSchema#decimal"||from.type=="http://www.w3.org/2001/XMLSchema#int"){from.type=fun;from.value=parseFloat(from.value);return from}else if(from.type=="http://www.w3.org/2001/XMLSchema#boolean"){if(QueryFilters.ebv(from)==true){from.type=fun;from.value=1}else{from.type=fun;from.value=0}return from}else if(from.type=="http://www.w3.org/2001/XMLSchema#float"||from.type=="http://www.w3.org/2001/XMLSchema#double"){from.type=fun;from.value=parseFloat(from.value);return from}else if(from.type==
"http://www.w3.org/2001/XMLSchema#string")try{from.value=parseFloat(from.value);if(isNaN(from.value))return QueryFilters.ebvError();else{from.type=fun;return from}}catch(e){return QueryFilters.ebvError()}else if(from.type==null){if(from.value.split(".").length>2)return QueryFilters.ebvError();else if(from.value.split("-").length>2)return QueryFilters.ebvError();else if(from.value.split("/").length>2)return QueryFilters.ebvError();else if(from.value.split("+").length>2)return QueryFilters.ebvError();
try{from.value=parseFloat(from.value);if(isNaN(from.value))return QueryFilters.ebvError();else{from.type=fun;return from}}catch(e){return QueryFilters.ebvError()}}else return QueryFilters.ebvError()}else return QueryFilters.ebvError()}else return QueryFilters.ebvError()}};module.exports={QueryFilters:QueryFilters}},{"./utils":55}],51:[function(_dereq_,module,exports){var _=_dereq_("./utils");var async=_dereq_("./utils");var QueryPlan=function(left,right,cost,identifier,allVars,joinVars){this.left=
left;this.right=right;this.cost=cost;this.i=identifier;this.vars=allVars;this.join=joinVars};var QueryPlanDPSize={};QueryPlanDPSize.variablesInBGP=function(bgp){var variables=bgp.variables;if(variables)return variables;var components=bgp.value||bgp;variables=[];for(var comp in components)if(components[comp]&&components[comp].token==="var")variables.push(components[comp].value);else if(components[comp]&&components[comp].token==="blank")variables.push("blank:"+components[comp].value);bgp.variables=
variables;return variables};QueryPlanDPSize.connected=function(leftPlan,rightPlan){var varsLeft="/"+leftPlan.vars.join("/")+"/";for(var i=0;i<rightPlan.vars.length;i++)if(varsLeft.indexOf("/"+rightPlan.vars[i]+"/")!=-1)return true;return false};var intersection=function(arr1,arr2){var acc={};for(var i=0;i<arr1.lenght;i++)acc[arr1[i]]=1;for(i=0;i<arr2.length;i++){var val=acc[arr2[i]]||0;val++;acc[arr2[i]]=val}var intersect=[];for(var p in acc)if(acc[p]==2)intersect.push(acc[p]);return intersect};QueryPlanDPSize.variablesIntersectionBGP=
function(bgpa,bgpb){return intersection(QueryPlanDPSize.variablesInBGP(bgpa),QueryPlanDPSize.variablesInBGP(bgpb))};QueryPlanDPSize.executeAndBGPsGroups=function(bgps){var groups={};var groupVars={};var groupId=0;var detectVarsInGroup=function(vars,groupVars){for(var j=0;j<vars.length;j++){var thisVar="/"+vars[j]+"/";if(groupVars.indexOf(thisVar)!=-1)return true}return false};var mergeGroups=function(bgp,toJoin,newGroups,newGroupVars){var acumGroups=[];var acumId="";var acumVars="";for(var gid in toJoin){acumId=
acumId+gid;acumGroups=acumGroups.concat(groups[gid]);acumVars=acumVars+groupVars[gid]}acumVars=acumVars+vars.join("/")+"/";acumGroups.push(bgp);newGroups[acumId]=acumGroups;newGroupVars[acumId]=acumVars};for(var i=0;i<bgps.length;i++){var bgp=bgps[i];var newGroups={};var newGroupVars={};var vars=QueryPlanDPSize.variablesInBGP(bgp);var toJoin={};for(var nextGroupId in groupVars)if(detectVarsInGroup(vars,groupVars[nextGroupId]))toJoin[nextGroupId]=true;else{newGroups[nextGroupId]=groups[nextGroupId];
newGroupVars[nextGroupId]=groupVars[nextGroupId]}if(_.size(toJoin)===0){newGroups["g"+groupId]=[bgp];newGroupVars["g"+groupId]="/"+vars.join("/")+"/";groupId++}else mergeGroups(bgp,toJoin,newGroups,newGroupVars);groups=newGroups;groupVars=newGroupVars}return _.values(groups)};QueryPlanDPSize.intersectionSize=function(leftPlan,rightPlan){var idsRight=rightPlan.i.split("_");for(var i=0;i<idsRight.length;i++){if(idsRight[i]=="")continue;if(leftPlan.i.indexOf("_"+idsRight[i]+"_")!=-1)return 1}return 0};
QueryPlanDPSize.createJoinTree=function(leftPlan,rightPlan){var varsLeft="/"+leftPlan.vars.join("/")+"/";var accumVars=leftPlan.vars.concat([]);var join=[];for(var i=0;i<rightPlan.vars.length;i++)if(varsLeft.indexOf("/"+rightPlan.vars[i]+"/")!=-1)if(rightPlan.vars[i].indexOf("_:")==0)join.push("blank:"+rightPlan.vars[i]);else join.push(rightPlan.vars[i]);else accumVars.push(rightPlan.vars[i]);var rightIds=rightPlan.i.split("_");var leftIds=leftPlan.i.split("_");var distinct={};for(var i=0;i<rightIds.length;i++)if(rightIds[i]!=
"")distinct[rightIds[i]]=true;for(var i=0;i<leftIds.length;i++)if(leftIds[i]!="")distinct[leftIds[i]]=true;var ids=_.keys(distinct);return{left:leftPlan,right:rightPlan,cost:leftPlan.cost+rightPlan.cost,i:"_"+ids.sort().join("_")+"_",vars:accumVars,join:join}};QueryPlanDPSize.executeBushyTree=function(queryPlan,dataset,queryEngine,env,callback){if(queryPlan.left==null)QueryPlanDPSize.executeEmptyJoinBGP(queryPlan.right,dataset,queryEngine,env,callback);else if(queryPlan.right==null)QueryPlanDPSize.executeEmptyJoinBGP(queryPlan.left,
dataset,queryEngine,env,callback);else QueryPlanDPSize.executeBushyTree(queryPlan.left,dataset,queryEngine,env,function(resultsLeft){if(resultsLeft!=null)QueryPlanDPSize.executeBushyTree(queryPlan.right,dataset,queryEngine,env,function(resultsRight){if(resultsRight!=null)callback(QueryPlanDPSize.joinBindings2(queryPlan.join,resultsLeft,resultsRight));else callback(null)});else callback(null)})};QueryPlanDPSize.executeAndBGPsDPSize=function(allBgps,dataset,queryEngine,env,callback){var groups=QueryPlanDPSize.executeAndBGPsGroups(allBgps);
var groupResults=[];async.eachSeries(groups,function(bgps,k){var costFactor=1;queryEngine.computeCosts(bgps,env,function(bgps){var bestPlans={};var plans={};var sizes={};var maxSize=1;var maxPlan=null;var cache={};sizes["1"]=[];for(var i=0;i<bgps.length;i++){var vars=[];delete bgps[i]["variables"];for(var comp in bgps[i])if(comp!="_cost")if(bgps[i][comp].token==="var")vars.push(bgps[i][comp].value);else if(bgps[i][comp].token==="blank")vars.push(bgps[i][comp].value);plans["_"+i+"_"]={left:bgps[i],
right:null,cost:bgps[i]._cost,i:"_"+i+"_",vars:vars};var plan={left:bgps[i],right:null,cost:bgps[i]._cost,i:"_"+i+"_",vars:vars};bestPlans["_"+i+"_"]=plan;delete bgps[i]["_cost"];cache["_"+i+"_"]=true;sizes["1"].push("_"+i+"_");if(maxPlan==null||maxPlan.cost>plan.cost)maxPlan=plan}for(var s=2;s<=bgps.length;s++)for(var sl=1;sl<s;sl++){var sr=s-sl;var leftPlans=sizes[""+sl]||[];var rightPlans=sizes[""+sr]||[];for(var i=0;i<leftPlans.length;i++)for(var j=0;j<rightPlans.length;j++){if(leftPlans[i]===
rightPlans[j])continue;var leftPlan=plans[leftPlans[i]];var rightPlan=plans[rightPlans[j]];if(QueryPlanDPSize.intersectionSize(leftPlan,rightPlan)==0)if(QueryPlanDPSize.connected(leftPlan,rightPlan)){maxSize=s;var p1=bestPlans[leftPlan.i];var p2=bestPlans[rightPlan.i];var currPlan=QueryPlanDPSize.createJoinTree(p1,p2);if(!cache[currPlan.i]){cache[currPlan.i]=true;var costUnion=currPlan.cost+1;if(bestPlans[currPlan.i]!=null)costUnion=bestPlans[currPlan.i].cost;var acum=sizes[s]||[];acum.push(currPlan.i);
plans[currPlan.i]=currPlan;sizes[s]=acum;if(costUnion>currPlan.cost){if(maxSize===s)maxPlan=currPlan;bestPlans[currPlan.i]=currPlan}}}}}groupResults.push(maxPlan);k()})},function(){var acum=null;async.eachSeries(groupResults,function(tree,k){QueryPlanDPSize.executeBushyTree(tree,dataset,queryEngine,env,function(result){if(result)if(acum==null){acum=result;k()}else{acum=QueryPlanDPSize.crossProductBindings(acum,result);k()}else k("Error executing bushy tree")})},function(err){if(err)callback(null,
err);else callback(acum)})})};QueryPlanDPSize.executeEmptyJoinBGP=function(bgp,dataset,queryEngine,queryEnv,callback){return QueryPlanDPSize.executeBGPDatasets(bgp,dataset,queryEngine,queryEnv,callback)};QueryPlanDPSize.executeBGPDatasets=function(bgp,dataset,queryEngine,queryEnv,callback){var duplicates={};if(bgp.graph==null){var acum=[];async.eachSeries(dataset.implicit,function(implicitGraph,k){if(duplicates[implicitGraph.oid]==null){duplicates[implicitGraph.oid]=true;bgp.graph=implicitGraph;queryEngine.rangeQuery(bgp,
queryEnv,function(results){results=QueryPlanDPSize.buildBindingsFromRange(results,bgp);acum.push(results);k()})}else k()},function(){var acumBindings=QueryPlanDPSize.unionManyBindings(acum);callback(acumBindings)})}else if(bgp.graph.token==="var"){var graphVar=bgp.graph.value;var acum=[];async.eachSeries(dataset.named,function(graph,k){if(duplicates[graph.oid]==null){duplicates[graph.oid]=true;bgp.graph=graph;if(acum!=null)queryEngine.rangeQuery(bgp,queryEnv,function(results){if(results!=null){results=
QueryPlanDPSize.buildBindingsFromRange(results,bgp);for(var j=0;j<results.length;j++)results[j][graphVar]=graph.oid;acum.push(results)}else acum=null;k()});else k()}},function(){if(acum==null)callback(null);else{var acumBindings=QueryPlanDPSize.unionManyBindings(acum);callback(acumBindings)}})}else queryEngine.rangeQuery(bgp,queryEnv,function(results){if(results!=null){results=QueryPlanDPSize.buildBindingsFromRange(results,bgp);callback(results)}else callback(null)})};QueryPlanDPSize.buildBindingsFromRange=
function(results,bgp){QueryPlanDPSize.variablesInBGP(bgp);var components=bgp.value||bgp;var bindings={};for(comp in components)if(components[comp]&&components[comp].token==="var")bindings[comp]=components[comp].value;else if(components[comp]&&components[comp].token==="blank")bindings[comp]="blank:"+components[comp].value;var resultsBindings=[];if(results!=null)for(var i=0;i<results.length;i++){var binding={};var result=results[i];var duplicated=false;for(var comp in bindings){var value=result[comp];
if(binding[bindings[comp]]==null||binding[bindings[comp]]===value)binding[bindings[comp]]=value;else{duplicated=true;break}}if(!duplicated)resultsBindings.push(binding)}return resultsBindings};QueryPlanDPSize.areCompatibleBindings=function(bindingsa,bindingsb){for(var variable in bindingsa)if(bindingsb[variable]!=null&&bindingsb[variable]!=bindingsa[variable])return false;return true};QueryPlanDPSize.mergeBindings=function(bindingsa,bindingsb){var merged={};for(var variable in bindingsa)merged[variable]=
bindingsa[variable];for(var variable in bindingsb)merged[variable]=bindingsb[variable];return merged};QueryPlanDPSize.joinBindings2=function(bindingVars,bindingsa,bindingsb){var acum={};var bindings,variable,variableValue,values,tmp;var joined=[];for(var i=0;i<bindingsa.length;i++){bindings=bindingsa[i];tmp=acum;for(var j=0;j<bindingVars.length;j++){variable=bindingVars[j];variableValue=bindings[variable];if(j==bindingVars.length-1){values=tmp[variableValue]||[];values.push(bindings);tmp[variableValue]=
values}else{values=tmp[variableValue]||{};tmp[variableValue]=values;tmp=values}}}for(var i=0;i<bindingsb.length;i++){bindings=bindingsb[i];tmp=acum;for(var j=0;j<bindingVars.length;j++){variable=bindingVars[j];variableValue=bindings[variable];if(tmp[variableValue]!=null)if(j==bindingVars.length-1)for(var k=0;k<tmp[variableValue].length;k++)joined.push(QueryPlanDPSize.mergeBindings(tmp[variableValue][k],bindings));else tmp=tmp[variableValue]}}return joined};QueryPlanDPSize.joinBindings=function(bindingsa,
bindingsb){var result=[];for(var i=0;i<bindingsa.length;i++){var bindinga=bindingsa[i];for(var j=0;j<bindingsb.length;j++){var bindingb=bindingsb[j];if(QueryPlanDPSize.areCompatibleBindings(bindinga,bindingb))result.push(QueryPlanDPSize.mergeBindings(bindinga,bindingb))}}return result};QueryPlanDPSize.augmentMissingBindings=function(bindinga,bindingb){for(var pb in bindingb)if(bindinga[pb]==null)bindinga[pb]=null;return bindinga};QueryPlanDPSize.leftOuterJoinBindings=function(bindingsa,bindingsb){var result=
[];for(var i=0;i<bindingsa.length;i++){var bindinga=bindingsa[i];var matched=false;for(var j=0;j<bindingsb.length;j++){var bindingb=bindingsb[j];if(QueryPlanDPSize.areCompatibleBindings(bindinga,bindingb)){matched=true;result.push(QueryPlanDPSize.mergeBindings(bindinga,bindingb))}}if(matched===false){QueryPlanDPSize.augmentMissingBindings(bindinga,bindingb);result.push(bindinga)}}return result};QueryPlanDPSize.crossProductBindings=function(bindingsa,bindingsb){var result=[];for(var i=0;i<bindingsa.length;i++){var bindinga=
bindingsa[i];for(var j=0;j<bindingsb.length;j++){var bindingb=bindingsb[j];result.push(QueryPlanDPSize.mergeBindings(bindinga,bindingb))}}return result};QueryPlanDPSize.unionBindings=function(bindingsa,bindingsb){return bindingsa.concat(bindingsb)};QueryPlanDPSize.unionManyBindings=function(bindingLists){var acum=[];for(var i=0;i<bindingLists.length;i++){var bindings=bindingLists[i];acum=QueryPlanDPSize.unionBindings(acum,bindings)}return acum};module.exports={QueryPlan:QueryPlanDPSize}},{"./utils":55}],
52:[function(_dereq_,module,exports){var NetworkTransport=_dereq_("./network_transport").NetworkTransport;var RVN3Parser=_dereq_("./rvn3_parser").RVN3Parser;var JSONLDParser=_dereq_("./jsonld_parser").JSONLDParser;var Utils=_dereq_("./utils");var RDFLoader=function(params){this.precedences=["text/turtle","text/n3","application/ld+json","application/json"];this.parsers={"text/turtle":RVN3Parser.parser,"text/n3":RVN3Parser.parser,"application/ld+json":JSONLDParser.parser,"application/json":JSONLDParser.parser};
if(typeof RDFXMLParser!=="undefined"){this.precedences.push("application/rdf+xml");this.parsers["application/rdf+xml"]=RDFXMLParser.parser}if(params!=null)for(var mime in params["parsers"])this.parsers[mime]=params["parsers"][mime];if(params&&params["precedences"]!=null){this.precedences=params["precedences"];for(var mime in params["parsers"])if(!Utils.include(this.precedences,mime))this.precedences.push(mime)}this.acceptHeaderValue="";for(var i=0;i<this.precedences.length;i++)if(i!=0)this.acceptHeaderValue=
this.acceptHeaderValue+","+this.precedences[i];else this.acceptHeaderValue=this.acceptHeaderValue+this.precedences[i]};RDFLoader.prototype.registerParser=function(mediaType,parser){this.parsers[mediaType]=parser;this.precedences.push(mediaType)};RDFLoader.prototype.unregisterParser=function(mediaType){delete this.parsers[mediaType];var mediaTypes=[];for(var i=0;i<this.precedences.length;i++)if(this.precedences[i]!=mediaType)mediaTypes.push(this.precedences[i]);this.precedences=mediaTypes};RDFLoader.prototype.setAcceptHeaderPrecedence=
function(mediaTypes){this.precedences=mediaTypes};RDFLoader.prototype.load=function(uri,graph,callback){var that=this;NetworkTransport.load(uri,this.acceptHeaderValue,function(err,results){if(err)callback(err);else{var mime=results["headers"]["Content-Type"]||results["headers"]["content-type"];var data=results["data"];if(mime!=null){mime=mime.split(";")[0];for(var m in that.parsers)if(m.indexOf("/")!=-1){var mimeParts=m.split("/");if(mimeParts[1]==="*"){if(mime.indexOf(mimeParts[0])!=-1)return that.tryToParse(that.parsers[m],
graph,data,{documentURI:uri},callback)}else if(mime.indexOf(m)!=-1)return that.tryToParse(that.parsers[m],graph,data,{documentURI:uri},callback);else if(mime.indexOf(mimeParts[1])!=-1)return that.tryToParse(that.parsers[m],graph,data,{documentURI:uri},callback)}else if(mime.indexOf(m)!=-1)return that.tryToParse(that.parsers[m],graph,data,{documentURI:uri},callback);callback(new Error("Unknown media type : "+mime))}else callback(new Error("Uknown media type"))}})};RDFLoader.prototype.loadFromFile=
function(parser,graph,uri,callback){try{var that=this;var fs=_dereq_("fs");fs.readFile(uri.split("file:/")[1],function(err,data){if(err)callback(err);else{var data=data.toString("utf8");that.tryToParse(parser,graph,data,{documentURI:uri},callback)}})}catch(e){callback(e)}};RDFLoader.prototype.tryToParse=function(parser,graph,input,options,callback){try{if(typeof input==="string")input=Utils.normalizeUnicodeLiterals(input);parser.parse(input,graph,options,callback)}catch(e){console.log(e.message);
console.log(e.stack);callback(e)}};module.exports={RDFLoader:RDFLoader}},{"./jsonld_parser":41,"./network_transport":43,"./rvn3_parser":54,"./utils":55,"fs":1}],53:[function(_dereq_,module,exports){var _=_dereq_("./utils");var QueryFilters=_dereq_("./query_filters").QueryFilters;RDFModel={};RDFModel.defaultContext={"rdf":"http://www.w3.org/1999/02/22-rdf-syntax-ns#","rdfs":"http://www.w3.org/2000/01/rdf-schema#","owl":"http://www.w3.org/2002/07/owl#","xsd":"http://www.w3.org/2001/XMLSchema#","dcterms":"http://purl.org/dc/terms/",
"foaf":"http://xmlns.com/foaf/0.1/","cal":"http://www.w3.org/2002/12/cal/ical#","vcard":"http://www.w3.org/2006/vcard/ns# ","geo":"http://www.w3.org/2003/01/geo/wgs84_pos#","cc":"http://creativecommons.org/ns#","sioc":"http://rdfs.org/sioc/ns#","doap":"http://usefulinc.com/ns/doap#","com":"http://purl.org/commerce#","ps":"http://purl.org/payswarm#","gr":"http://purl.org/goodrelations/v1#","sig":"http://purl.org/signature#","ccard":"http://purl.org/commerce/creditcard#"};RDFModel.UrisMap=function(){this.defaultNs=
"";this.interfaceProperties=["get","remove","set","setDefault","addAll","resolve","shrink"]};RDFModel.UrisMap.prototype.values=function(){var collected={};for(var p in this)if(!_.include(this.interfaceProperties,p)&&typeof this[p]!=="function"&&p!=="defaultNs"&&p!=="interfaceProperties")collected[p]=this[p];return collected};RDFModel.UrisMap.prototype.get=function(prefix){if(prefix.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";return this[prefix]};RDFModel.UrisMap.prototype.remove=
function(prefix){if(prefix.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";delete this[prefix];return null};RDFModel.UrisMap.prototype.set=function(prefix,iri){if(prefix.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";this[prefix]=iri};RDFModel.UrisMap.prototype.setDefault=function(iri){this.defaultNs=iri};RDFModel.UrisMap.prototype.addAll=function(prefixMap,override){for(var prefix in prefixMap)if(!_.include(this.interfaceProperties,prefix))if(this[prefix]!=null){if(override===
true)this[prefix]=prefixMap[prefix]}else this[prefix]=prefixMap[prefix];return this};RDFModel.UrisMap.prototype.resolve=function(curie){var parts=curie.split(":");var ns=parts[0];var suffix=parts[1];if(ns==="")if(this.defaultNs==null)return null;else return this.defaultNs+suffix;else if(this[ns]!=null)return this[ns]+suffix;else return null};RDFModel.UrisMap.prototype.shrink=function(iri){for(var ns in this){var prefix=this[ns];if(iri.indexOf(prefix)===0)if(prefix!==""&&ns!="defaultNs"){var suffix=
iri.split(prefix)[1];return ns+":"+suffix}}return iri};RDFModel.Profile=function(){this.prefixes=new RDFModel.UrisMap;this.terms=new RDFModel.UrisMap};RDFModel.Profile.prototype.importProfile=function(profile,override){this.prefixes.addAll(profile.prefixes,override);this.terms.addAll(profile.terms,override)};RDFModel.Profile.prototype.resolve=function(toResolve){if(toResolve.indexOf(":")!=-1)return this.prefixes.resolve(toResolve);else if(this.terms[toResolve]!=null)return this.terms.resolve(toResolve);
else return null};RDFModel.Profile.prototype.setDefaultPrefix=function(iri){this.prefixes.setDefault(iri)};RDFModel.Profile.prototype.setDefaultVocabulary=function(iri){this.terms.setDefault(iri)};RDFModel.Profile.prototype.setPrefix=function(prefix,iri){this.prefixes.set(prefix,iri)};RDFModel.Profile.prototype.setTerm=function(term,iri){this.terms.set(term,iri)};RDFModel.RDFEnvironment=function(){RDFModel.Profile.call(this);this.blankNodeCounter=0;var that=this;this.filters={s:function(s){return function(t){return t.subject.equals(s)}},
p:function(p){return function(t){return t.predicate.equals(p)}},o:function(o){return function(t){return t.object.equals(o)}},sp:function(s,p){return function(t){return t.subject.equals(s)&&t.predicate.equals(p)}},so:function(s,o){return function(t){return t.subject.equals(s)&&t.object.equals(o)}},po:function(p,o){return function(t){return t.predicate.equals(p)&&t.object.equals(o)}},spo:function(s,p,o){return function(t){return t.subject.equals(s)&&t.predicate.equals(p)&&t.object.equals(o)}},describes:function(v){return function(t){return t.subject.equals(v)||
t.object.equals(v)}},type:function(o){var type=that.resolve("rdf:type");return function(t){return t.predicate.equals(type)&&t.object.equals(o)}}};for(var p in RDFModel.defaultContext)this.prefixes.set(p,RDFModel.defaultContext[p])};RDFModel.RDFEnvironment.prototype=_.create(RDFModel.Profile.prototype,{"constructor":RDFModel.RDFEnvironment});RDFModel.RDFEnvironment.prototype.createBlankNode=function(){var bnode=new RDFModel.BlankNode(this.blankNodeCounter);this.blankNodeCounter++;return bnode};RDFModel.RDFEnvironment.prototype.createNamedNode=
function(value){var resolvedValue=this.resolve(value);if(resolvedValue!=null)return new RDFModel.NamedNode(resolvedValue);else return new RDFModel.NamedNode(value)};RDFModel.RDFEnvironment.prototype.createLiteral=function(value,language,datatype){if(datatype!=null)return new RDFModel.Literal(value,language,datatype.toString());else return new RDFModel.Literal(value,language,datatype)};RDFModel.RDFEnvironment.prototype.createTriple=function(subject,predicate,object){return new RDFModel.Triple(subject,
predicate,object)};RDFModel.RDFEnvironment.prototype.createGraph=function(triples){var graph=new RDFModel.Graph;if(triples!=null)for(var i=0;i<triples.length;i++)graph.add(triples[i]);return graph};RDFModel.RDFEnvironment.prototype.createAction=function(test,action){return function(triple){if(test(triple))return action(triple);else return triple}};RDFModel.RDFEnvironment.prototype.createProfile=function(empty){if(empty===true)return new RDFModel.RDFEnvironment.Profile;else{var profile=new RDFModel.RDFEnvironment.Profile;
profile.importProfile(this);return profile}};RDFModel.RDFEnvironment.prototype.createTermMap=function(empty){if(empty===true)return new RDFModel.UrisMap;else{var cloned=this.terms.values();var termMap=new RDFModel.UrisMap;for(var p in cloned)termMap[p]=cloned[p];return termMap}};RDFModel.RDFEnvironment.prototype.createPrefixMap=function(empty){if(empty===true)return new RDFModel.UrisMap;else{var cloned=this.prefixes.values();var prefixMap=new RDFModel.UrisMap;for(var p in cloned)prefixMap[p]=cloned[p];
return prefixMap}};RDFModel.RDFNode=function(interfaceName){this.interfaceName=interfaceName;this.attributes=["interfaceName","nominalValue"]};RDFModel.RDFNode.prototype.equals=function(otherNode){if(otherNode.interfaceName==null)return this.valueOf()==otherNode;else{for(var i in this.attributes){var attribute=this.attributes[i];if(this[attribute]!=otherNode[attribute])return false}return true}};RDFModel.BlankNode=function(bnodeId){RDFModel.RDFNode.call(this,"BlankNode");this.nominalValue="_:"+bnodeId;
this.bnodeId=bnodeId};RDFModel.BlankNode.prototype=_.create(RDFModel.RDFNode.prototype,{"constructor":RDFModel.BlankNode});RDFModel.BlankNode.prototype.toString=function(){return this.nominalValue};RDFModel.BlankNode.prototype.toNT=function(){return this.nominalValue};RDFModel.BlankNode.prototype.valueOf=function(){return this.nominalValue};RDFModel.Literal=function(value,language,datatype){RDFModel.RDFNode.call(this,"Literal");this.nominalValue=value;if(language!=null)this.language=language;else if(datatype!=
null)this.datatype=datatype};RDFModel.Literal.prototype=_.create(RDFModel.RDFNode.prototype,{"constructor":RDFModel.Literal});RDFModel.Literal.prototype.toString=function(){var tmp='"'+this.nominalValue+'"';if(this.language!=null)tmp=tmp+"@"+this.language;else if(this.datatype!=null||this.type)tmp=tmp+"^^<"+(this.datatype||this.type)+">";return tmp};RDFModel.Literal.prototype.toNT=function(){return this.toString()};RDFModel.Literal.prototype.valueOf=function(){return QueryFilters.effectiveTypeValue({token:"literal",
type:this.type||this.datatype,value:this.nominalValue,language:this.language})};RDFModel.NamedNode=function(val){RDFModel.RDFNode.call(this,"NamedNode");if(val.value!=null)this.nominalValue=val.value;else this.nominalValue=val};RDFModel.NamedNode.prototype=_.create(RDFModel.RDFNode.prototype,{"constructor":RDFModel.NamedNode});RDFModel.NamedNode.prototype.toString=function(){return this.nominalValue};RDFModel.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"};RDFModel.NamedNode.prototype.valueOf=
function(){return this.nominalValue};RDFModel.Triple=function(subject,predicate,object){this.subject=subject;this.predicate=predicate;this.object=object};RDFModel.Triple.prototype.equals=function(otherTriple){return this.subject.equals(otherTriple.subject)&&this.predicate.equals(otherTriple.predicate)&&this.object.equals(otherTriple.object)};RDFModel.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"};RDFModel.Graph=function(){this.triples=
[];this.duplicates={};this.actions=[];this.length=0};RDFModel.Graph.prototype.add=function(triple){for(var i=0;i<this.actions.length;i++)triple=this.actions[i](triple);var id=triple.subject.toString()+triple.predicate.toString()+triple.object.toString();if(!this.duplicates[id]){this.duplicates[id]=true;this.triples.push(triple)}this.length=this.triples.length;return this};RDFModel.Graph.prototype.addAction=function(tripleAction,run){this.actions.push(tripleAction);if(run==true)for(var i=0;i<this.triples.length;i++)this.triples[i]=
tripleAction(this.triples[i]);return this};RDFModel.Graph.prototype.addAll=function(graph){var newTriples=graph.toArray();for(var i=0;i<newTriples.length;i++)this.add(newTriples[i]);this.length=this.triples.length;return this};RDFModel.Graph.prototype.remove=function(triple){var toRemove=null;for(var i=0;i<this.triples.length;i++)if(this.triples[i].equals(triple)){var id=triple.subject.toString()+triple.predicate.toString()+triple.object.toString();delete this.duplicates[id];toRemove=i;break}if(toRemove!=
null)this.triples.splice(toRemove,1);this.length=this.triples.length;return this};RDFModel.Graph.prototype.toArray=function(){return this.triples};RDFModel.Graph.prototype.some=function(p){for(var i=0;i<this.triples.length;i++)if(p(this.triples[i],this)===true)return true;return false};RDFModel.Graph.prototype.every=function(p){for(var i=0;i<this.triples.length;i++)if(p(this.triples[i],this)===false)return false;return true};RDFModel.Graph.prototype.filter=function(f){var tmp=new RDFModel.Graph;for(var i=
0;i<this.triples.length;i++)if(f(this.triples[i],this)===true)tmp.add(this.triples[i]);return tmp};RDFModel.Graph.prototype.forEach=function(f){for(var i=0;i<this.triples.length;i++)f(this.triples[i],this)};RDFModel.Graph.prototype.merge=function(g){var newGraph=new RDFModel.Graph;for(var i=0;i<this.triples.length;i++)newGraph.add(this.triples[i]);return newGraph};RDFModel.Graph.prototype.match=function(subject,predicate,object,limit){var graph=new RDFModel.Graph;var matched=0;for(var i=0;i<this.triples.length;i++){var triple=
this.triples[i];if(subject==null||triple.subject.equals(subject))if(predicate==null||triple.predicate.equals(predicate))if(object==null||triple.object.equals(object))if(limit==null||matched<limit){matched++;graph.add(triple)}else return graph}return graph};RDFModel.Graph.prototype.removeMatches=function(subject,predicate,object){var toRemove=[];for(var i=0;i<this.triples.length;i++){var triple=this.triples[i];if(subject==null||triple.subject.equals(subject))if(predicate==null||triple.predicate.equals(predicate))if(object==
null||triple.object.equals(object))toRemove.push(triple)}for(var i=0;i<toRemove.length;i++)this.remove(toRemove[i]);return this};RDFModel.Graph.prototype.toNT=function(){var n3="";this.forEach(function(triple){n3=n3+triple.toString()});return n3};RDFModel.buildRDFResource=function(value,bindings,engine,env){if(value.token==="blank")return RDFModel.buildBlankNode(value,bindings,engine,env);else if(value.token==="literal")return RDFModel.buildLiteral(value,bindings,engine,env);else if(value.token===
"uri")return RDFModel.buildNamedNode(value,bindings,engine,env);else if(value.token==="var"){var result=bindings[value.value];if(result!=null)return RDFModel.buildRDFResource(result,bindings,engine,env);else return null}else return null};RDFModel.buildBlankNode=function(value,bindings,engine,env){if(value.valuetmp!=null)value.value=value.valuetmp;if(value.value.indexOf("_:")===0)value.value=value.value.split("_:")[1];return new RDFModel.BlankNode(value.value)};RDFModel.buildLiteral=function(value,
bindings,engine,env){return new RDFModel.Literal(value.value,value.lang,value.type)};RDFModel.buildNamedNode=function(value,bindings,engine,env){if(value.value!=null)return new RDFModel.NamedNode(value);else if(value.prefix!=null){var prefix=engine.resolveNsInEnvironment(value.prefix,env);value.value=prefix+value.suffix;return new RDFModel.NamedNode(value)}else return new RDFModel.NamedNode(value)};RDFModel.rdf=new RDFModel.RDFEnvironment;module.exports=RDFModel},{"./query_filters":50,"./utils":55}],
54:[function(_dereq_,module,exports){var N3Parser=_dereq_("../node_modules/n3/lib/N3Parser");var RVN3Parser={};RVN3Parser.parser={async:true,parse:function(data,graph,options,callback){if(!callback){callback=options;options=graph;graph=null}if(graph&&typeof graph==="string")graph={token:"uri",value:graph,prefix:null,suffix:null};if(options&&options.baseURI)options.documentIRI=options.baseURI;var triples=[];(new N3Parser(options)).parse(data,function(error,triple){if(error)callback(error);else if(!triple)callback(false,
triples);else triples.push({subject:convertEntity(triple.subject),predicate:convertEntity(triple.predicate),object:convertEntity(triple.object),graph:graph})})},resetBlankNodeIds:function(){N3Parser._resetBlankNodeIds()}};function convertEntity(entity){switch(entity[0]){case '"':if(entity.indexOf("^^")>0){var parts=entity.split("^^");return{literal:parts[0]+"^^<"+parts[1]+">"}}else return{literal:entity};case "_":return{blank:entity.replace("b","")};default:return{token:"uri",value:entity,prefix:null,
suffix:null}}}module.exports={RVN3Parser:RVN3Parser}},{"../node_modules/n3/lib/N3Parser":36}],55:[function(_dereq_,module,exports){(function(process){var nextTick=function(){var global=null;if(typeof window!=="undefined")global=window;else if(typeof process!=="undefined")global=process;var canSetImmediate=typeof global!=="undefined"&&global.setImmediate;var canPost=typeof global!=="undefined"&&global.postMessage&&global.addEventListener;if(canSetImmediate)return function(f){return global.setImmediate(f)};
if(global!=="undefined"&&global.nextTick&&typeof _dereq_==="function")if(_dereq_("timers")&&_dereq_("timers").setImmediate)return _dereq_("timers").setImmediate;else return global.nextTick;if(canPost){var queue=[];global.addEventListener("message",function(ev){var source=ev.source;if((source===global||source===null)&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);global.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,
0)}}();var hashTerm=function(term){try{if(term==null)return"";if(term.token==="uri")return"u"+term.value;else if(term.token==="blank")return"b"+term.value;else if(term.token==="literal"){var l="l"+term.value;l=l+(term.type||"");l=l+(term.lang||"");return l}}catch(e){if(typeof term==="object"){var key="";for(p in term)key=key+p+term[p];return key}return term}};var lexicalFormBaseUri=function(term,env){var uri=null;env=env||{};if(term.value==null){var prefix=term.prefix;var suffix=term.suffix;var resolvedPrefix=
env.namespaces[prefix];if(resolvedPrefix!=null)uri=resolvedPrefix+suffix;else uri=prefix+":"+suffix}else uri=term.value;if(uri===null)return null;else if(uri.indexOf(":")==-1)uri=(env.base||"")+uri;return uri};parseISO8601=function(str){return Date.parse(str)};if(!Date.prototype.toISOString)(function(){function pad(number){if(number<10)return"0"+number;return number}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+pad(this.getUTCMonth()+1)+"-"+pad(this.getUTCDate())+"T"+pad(this.getUTCHours())+
":"+pad(this.getUTCMinutes())+":"+pad(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1E3).toFixed(3).slice(2,5)+"Z"}})();iso8601=function(date){return date.toISOString()};compareDateComponents=function(stra,strb){var dateA=parseISO8601(stra);var dateB=parseISO8601(strb);if(dateA==dateB)return 0;else if(dateA<dateB)return-1;else return 1};lexicalFormLiteral=function(term,env){var value=term.value;var lang=term.lang;var type=term.type;var indexedValue=null;if(value!=null&&type!=null&&typeof type!=
"string"){var typeValue=type.value;if(typeValue==null){var typePrefix=type.prefix;var typeSuffix=type.suffix;var resolvedPrefix=env.namespaces[typePrefix];term.type=resolvedPrefix+typeSuffix;typeValue=resolvedPrefix+typeSuffix}if(typeValue.indexOf("hexBinary")!=-1)indexedValue='"'+term.value.toLowerCase()+'"^^<'+typeValue+">";else indexedValue='"'+term.value+'"^^<'+typeValue+">"}else if(lang==null&&type==null)indexedValue='"'+value+'"';else if(type==null)indexedValue='"'+value+'"'+"@"+lang;else if(type.indexOf("hexBinary")!=
-1)indexedValue='"'+term.value.toLowerCase()+'"^^<'+type+">";else indexedValue='"'+term.value+'"^^<'+type+">";return indexedValue};normalizeUnicodeLiterals=function(string){var escapedUnicode=string.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[];var dups={};for(var i=0;i<escapedUnicode.length;i++)if(dups[escapedUnicode[i]]==null){dups[escapedUnicode[i]]=true;string=string.replace(new RegExp("\\"+escapedUnicode[i],"g"),eval("'"+escapedUnicode[i]+"'"))}return string};registerIndexedDB=function(that){if(typeof window===
"undefined"){var sqlite3=_dereq_("sqlite3");var indexeddbjs=_dereq_("indexeddb-js");var engine=new sqlite3.Database(":memory:");var scope=indexeddbjs.makeScope("sqlite3",engine);that.indexedDB=scope.indexedDB;that.IDBKeyRange=scope.IDBKeyRange}else{window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;if(!window.indexedDB)callback(null,new Error("The browser does not support IndexDB."));
else{that.indexedDB=window.indexedDB;that.IDBKeyRange=window.IDBKeyRange}}};function guid(){function s4(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}hashTerm=function(term){try{if(term==null)return"";if(term.token==="uri")return"u"+term.value;else if(term.token==="blank")return"b"+term.value;else if(term.token==="literal"){var l="l"+term.value;l=l+(term.type||"");l=l+(term.lang||"");return l}}catch(e){if(typeof term===
"object"){var key="";for(p in term)key=key+p+term[p];return key}return term}};var reject=function(xs,p){var acc=[];for(var i=0;i<xs.length;i++)if(p(xs[i]))acc.push(xs[i]);return acc};var include=function(xs,p){for(var i=0;i<xs.length;i++)if(xs[i]===p)return true;return false};var each=function(xs,f){if(xs.forEach)xs.forEach(f);else for(var i=0;i<xs.length;i++)f(xs[i])};var map=function(xs,f){if(xs.map)return xs.map(f);else{var acc=[];for(var i=0;i<xs.length;i++)acc[i]=f(xs[i]);return acc}};var keys=
function(xs){var acc=[];for(var p in xs)acc.push(p);return acc};var values=function(xs){var acc=[];for(var p in xs)acc.push(xs[p]);return acc};var size=function(xs){if(xs.length)return xs.length;else{var acc=0;for(var p in xs)acc++;return acc}};clone=function(value){return JSON.parse(JSON.stringify(value))};var isObject=function(value){var type=typeof value;return type=="function"||value&&type=="object"||false};var create=function(){function Object(){}return function(prototype){if(isObject(prototype)){Object.prototype=
prototype;var result=new Object;Object.prototype=null}return result||Object()}}();var whilst=function(test,iterator,callback){if(test())iterator(function(err){if(err)return callback(err);whilst(test,iterator,callback)});else callback()};var eachSeries=function(arr,iterator,callback){callback=callback||function(){};if(!arr.length)return callback();var completed=0;var iterate=function(){iterator(arr[completed],function(err){if(err){callback(err);callback=function(){}}else{completed+=1;if(completed>=
arr.length)callback();else iterate()}})};iterate()};var reduce=function(arr,memo,iterator,callback){eachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v;callback(err)})},function(err){callback(err,memo)})};var seq=function(){var fns=arguments;return function(){var that=this;var args=Array.prototype.slice.call(arguments);var callback=args.pop();reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([function(){var err=arguments[0];var nextargs=Array.prototype.slice.call(arguments,
1);cb(err,nextargs)}]))},function(err,results){callback.apply(that,[err].concat(results))})}};module.exports={nextTick:nextTick,hasTerm:hashTerm,lexicalFormBaseUri:lexicalFormBaseUri,parseISO8601:parseISO8601,compareDateComponents:compareDateComponents,iso8601:iso8601,normalizeUnicodeLiterals:normalizeUnicodeLiterals,lexicalFormLiteral:lexicalFormLiteral,registerIndexedDB:registerIndexedDB,guid:guid,hashTerm:hashTerm,keys:keys,values:values,size:size,map:map,each:each,forEach:each,include:include,
reject:reject,remove:reject,clone:clone,create:create,whilst:whilst,eachSeries:eachSeries,seq:seq}}).call(this,_dereq_("VCmEsw"))},{"VCmEsw":13,"timers":26}]},{},[39])(39)});